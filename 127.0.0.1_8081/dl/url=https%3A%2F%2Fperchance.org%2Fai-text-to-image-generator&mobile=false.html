<!DOCTYPE html><html class="no-js" lang=""><head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">

        <!-- prevent caching -->
        <!--<meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />-->

        <title>AI Image Generator (free, no sign-up, unlimited)</title>
        <meta name="description" content="AI text to image generator. Generate AI art from text, completely free, online, no login or sign-up, no daily credit limits/restrictions/gimmicks, and it's fast. Other AI art generators often have annoying daily credit limits and require sign-up, or are slow - this one doesn't. Use this AI to generate high quality art, photos, cartoons, drawings, anime, thumbnails, pfps, and more. Create OCs, anime characters, AI villains, fanfic artwork, and pretty much anything else. It's an AI-based image generator that uses the Stable Diffusion text-to-image model. No watermark, no signup/login, unlimited images. Type words, make pics.">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="apple-touch-icon" href="../../perchance.org/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="../../perchance.org/favicon-32x32-white-bg.png" sizes="32x32">
        <link rel="icon" type="image/png" href="../../perchance.org/favicon-16x16-white-bg.png" sizes="16x16">
        
        
        <meta property="og:type" content="website">
        <!-- <meta property="og:url" content="https://perchance.org/..." />  -->
        <meta property="og:image" content="../../user-uploads.perchance.org/file/4763f095ac55e4ac66ead5e8f4bbb016.jpeg">
        <!-- <meta property="og:description" content="..." /> -->

        <link rel="preconnect" href="https://cd282495464c4f81bf84e2ef3974e6f6.perchance.org">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
        <link rel="preconnect" href="https://fonts.googleapis.com">

        <script>
          if(!Array.prototype.at) {
            window.addEventListener("error", function(message, url, linenumber) {
              console.warn(`JavaScript error: ${message} on line ${linenumber} for ${url}`);
            });
          }
        </script>

        <script>
          window.name = window.location.pathname; // for Notification.onclick to not open a new window if that generator is open already
        </script>

        <script>
          window.kv = null; // so `if(kv)...` doesn't throw error.
          window.initKv = async function() {
            if(window.kv) return;
            let idbKeyval = await import("https://cdn.jsdelivr.net/npm/idb-keyval@6/+esm");
            window.kv = new Proxy(idbKeyval, { // so api is like: kv.myStoreName.get(...)
              get(target, prop, receiver) {
                const store = idbKeyval.createStore(`${prop}-db`, `${prop}-store`);
                return {
                  get: (key) => idbKeyval.get(key, store),
                  set: (key, value) => idbKeyval.set(key, value, store),
                  delete: (key) => idbKeyval.del(key, store),
                  entries: () => idbKeyval.entries(store),
                };
              },
            });
          }
        </script>

    </head>  
    <body style="overscroll-behavior:none;"> <!-- due to overscroll iframe bug in chrome -->
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
        <script>window.mdded4sfef4dsedddse1d34344 = `Error: Ad blocker preventing proper page load?`;</script>
        <script>
          document.addEventListener("DOMContentLoaded", async (event) => {
            let sadf5456 = `r i  o t`['replace'](/ /g, "");
            let lkjsfh83 = `s et Ti m e o ut`['replace'](/ /g, "");
            let sdf435i3hkf = "document";
            let a = window[sdf435i3hkf].body;
            while(! window[sadf5456]) await new Promise(r =>  window[lkjsfh83](r,1000));
            await new Promise(r =>  window[lkjsfh83](r,5000));
            if( !window .da_Zz3qe33sEsZ1 || !window.hu_8urej4) {
              a. innerHTML = window. mdded4sfef4dsedddse1d34344;
              window[`successfulPag${""}Load`] = false;
            }
          });
          window.js0nparse = JSON.parse;
        </script>

        <script>
        // COMPATABILITY TESTING:
        window.canExecuteModernJavascript = true;
        try {

          var str = "";
          str += "\n(async () => { await new Promise(resolve => setTimeout(resolve, 500)); console.log('async/await is supported'); })();";
          str += "\nlet arr = [1,2,3]; for(let a of arr) { arr[0]+=a; }; console.log('let a of arr supported');";
          str += "\nvar m = [1,2,3].map(n => n+1);";
          str += "\nvar k = [...[1,2,3]];";
          str += "\nvar a = (function(a=3) { return a+1; })();";

          window.eval(str);

        } catch(e) {
          window.canExecuteModernJavascript = false;
          // var message = "<div style='overflow:hidden;height:0px;'><h1>Create a Random Generator</h1><p>Perhance is a platform that allows you to create your own custom random generators. You could use it to create your own random text generator for a tabletop RPG, or to make your own random name generator, or to simply create a generator which selects a random item from your list with different weights. You can also save your generator so it has a permalink that you can share with your friends.</p><p>Perchance is based around creating lists which reference other lists. You can adjust the odds of items in each list so that when you randomly select an item from that list, they all have the likelihoods that you've specified. If you'd like to learn how to make a random text generator with Perchance, you should check out the tutorial. It explains all the basic features of the Perchance engine and should get you up and running in only 10 or 20 minutes. Perchance has many powerful features that you don't need to learn from the start, but can learn later if you want to create particularly complex generators.</p><p>I created Perchance because most people are still creating random generators in excel. Those work all right, but excel and other spreadsheets aren't really made for that purpose, so there's a lot to be desired in terms of functionality and ease of use. Whatever you're using it for, I hope you find Perchance useful! You might like to check out our <a href='http://reddit.com/r/perchance'>community forum</a> where you can ask questions and share your random generator creations.</p></div>(」ﾟﾛﾟ)｣ Sorry! Perchance uses cutting edge browser features that are only available in the latest versions of Chrome and Firefox. All modern browsers will eventually be supported, but for now you'll need to use one of those two. Sorry again for the inconvenience!";
          // //window.alert(message);
          // document.body.innerHTML = message;
        }
        </script>


        <div id="generator-description" style="height:20px; width:20px; z-index:-10; overflow:hidden; position:fixed; bottom:-100px;"><!-- will be filled with description after iframe execution --></div>

        <style>
          .cm-syntax-style1 { color: #f18c16; }
          .cm-syntax-style2 { color: #2795EE; }
          .cm-syntax-style3-comment { color: #A0A1A7; }
        </style>

        <!-- PRELOADED DATA -->
        <script id="preloaded-generator-data" type="notjs">%7B%22name%22:%22ai-text-to-image-generator%22,%22modelText%22:%22generateInterfaceHTML%20=%20%7Bimport:t2i-framework-plugin-v2%7D%20%20//%20%3C--%20This%20is%20a%20'framework'%20plugin%20that%20itself%20imports%20the%20text-to-image%20plugin%20and%20generates%20the%20user%20interface%20using%20the%20settings%20below.%5Cn%20%5Cn%20%5Cn//%20Feel%20free%20to%20edit%20the%20settings%20below%20and%20then%20save%20your%20own%20copy%20of%20this%20generator!%5Cn//%20It%20looks%20more%20intimidating%20than%20it%20actually%20is%20-%20you%20can%20ignore%20almost%20everything%20here.%5Cn//%20You'll%20probably%20just%20want%20to%20scroll%20down%20to%20the%20'artStyle'%20list%20and%20edit%20those%20-%20it's%20pretty%20self-explanatory,%20just%20follow%20the%20format.%5Cn%5Cn%5Cn$meta%20//%20This%20is%20used%20for%20browser%20tab%20title,%20social%20media%20sharing%20'card',%20search%20engines,%20community%20generator%20listing,%20etc.%5Cn%20%20title%20=%20AI%20Image%20Generator%20(free,%20no%20sign-up,%20unlimited)%5Cn%20%20description%20=%20AI%20text%20to%20image%20generator.%20Generate%20AI%20art%20from%20text,%20completely%20free,%20online,%20no%20login%20or%20sign-up,%20no%20daily%20credit%20limits/restrictions/gimmicks,%20and%20it's%20fast.%20Other%20AI%20art%20generators%20often%20have%20annoying%20daily%20credit%20limits%20and%20require%20sign-up,%20or%20are%20slow%20-%20this%20one%20doesn't.%20Use%20this%20AI%20to%20generate%20high%20quality%20art,%20photos,%20cartoons,%20drawings,%20anime,%20thumbnails,%20pfps,%20and%20more.%20Create%20OCs,%20anime%20characters,%20AI%20villains,%20fanfic%20artwork,%20and%20pretty%20much%20anything%20else.%20It's%20an%20AI-based%20image%20generator%20that%20uses%20the%20Stable%20Diffusion%20text-to-image%20model.%20No%20watermark,%20no%20signup/login,%20unlimited%20images.%20Type%20words,%20make%20pics.%5Cn%20%20image%20=%20https://user-uploads.perchance.org/file/4763f095ac55e4ac66ead5e8f4bbb016.jpeg%5Cn%5Cn%5Cn%5Cnsettings%20//%20This%20is%20the%20main%20settings%20list%20that%20is%20passed%20to%20%60t2i-framework-plugin-v2%60%20to%20generate%20the%20interface.%5Cn%20%20pageTitle%20=%20%F0%9F%8C%8C%20AI%20Image%20Generator%20%F0%9F%AA%84%5Cn%20%20introMessage%20=%20Add%20a%20description,%20then%20click%20%3Cb%3Egenerate%3C/b%3E.%3Cbr%3E%3Cbr%3E%3Cspan%20style=%5C%22font-size:80%25;%20color:grey;%20max-width:370px;%20display:inline-block;%5C%22%3EThis%20generator%20was%20made%20using%20the%20%3Ca%20href=%5C%22https://perchance.org/text-to-image-plugin%5C%22%20target=%5C%22_blank%5C%22%20style=%5C%22white-space:pre;%5C%22%3Etext-to-image-plugin%3C/a%3E.%3Cbr%3EThe%20brain%20button%20feature%20uses%20the%20%3Ca%20href=%5C%22https://perchance.org/ai-text-plugin%5C%22%20target=%5C%22_blank%5C%22%20style=%5C%22white-space:pre;%5C%22%3Eai-text-plugin%3C/a%3E.%3C/span%3E%5Cn%20%20underImagesMessage%20=%20%3Cdiv%20style=%5C%22max-width:700px;%20margin:0%20auto;%20padding:0%201rem;%20font-size:85%25;%20opacity:0.7;%5C%22%3E%3Cdiv%20style=%5C%22margin-top:0.5rem;%5C%22%3EAlso%20check%20out%20%3Ca%20href=%5C%22https://perchance.org/ai-character-chat%5C%22%20target=%5C%22_blank%5C%22%3EAI%20Character%20Chat%3C/a%3E%20and%20%3Ca%20href=%5C%22https://perchance.org/ai-story-generator%5C%22%20target=%5C%22_blank%5C%22%3EAI%20Story%20Generator%3C/a%3E.%3C/div%3E%3C/div%3E%5Cn%20%20numImages%20=%20%5Binput.numImages%5D%20//%20This%20determines%20how%20many%20images%20get%20output%20when%20'generate'%20is%20clicked.%20We%20let%20the%20user%20select%20that%20number%20-%20see%20'numImages'%20under%20'userInputs',%20below.%5Cn%20%20socialFeatures%20=%20button%20after%204%20clicks%20//%20or%20'button'%20or%20'enabled'%20or%20'disabled'%5Cn%20%20%5Cn%20%20//%20Note:%20the%20t2i-framework-plugin%20makes%20all%20user%20inputs%20from%20the%20%60userInputs%60%20list%20accessible%20by%20name%20as%20%5Binput.theNameOfTheInput%5D,%20as%20shown%20here:%5Cn%20%20imageOptions%20//%20%3C--%20Options%20for%20the%20text-to-image%20plugin%20that%20generates%20the%20images.%20See%20all%20available%20options%20here:%20%20%20https://perchance.org/text-to-image-plugin%5Cn%20%20%20%20saveTitle%20=%20(%5Binput.artStyle.getName%5D)%20%5Binput.description%5D%20//%20.getName%20is%20a%20built-in%20Perchance%20property%20that%20gets%20the%20name%20of%20a%20given%20list/sublist/node%5Cn%20%20%20%20prompt%20=%20%5Binput.artStyle.prompt%5D%5Cn%20%20%20%20negativePrompt%20=%20%5Binput.artStyle.negative%5D%5Cn%20%20%20%20resolution%20=%20%5Binput.shape%5D%5Cn%20%20%5Cn%20%20userInputs%20//%20you%20can%20add%20more%20user%20inputs%20to%20this%20list,%20and%20then%20use%20them%20like%20%5Binput.nameOfInput%5D%20in%20the%20%60prompt%60,%20%60negativePrompt%60,%20%60artStyle.prompt%60,%20etc.%5Cn%5Cn%20%20%20%20scratchpad%20//%20Note:%20the%20'remember'%20option%20storage%20is%20'based%20on'%20this%20'scratchpad'%20name,%20so%20if%20you%20change%20that%20name%20to%20something%20else%20like%20'notepad',%20people%20will%20lose%20all%20their%20saved%20scratchpad%20text.%20But%20it's%20safe%20to%20change%20the%20'label',%20below.%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%97%92%EF%B8%8F%20Scratchpad%5Cn%20%20%20%20%20%20tip%20=%20%5Bt2i.defaultText.scratchpadTip%5D%20//%20this%20loads%20the%20default%20text,%20but%20you%20can%20replace%20%5C%22%5Bt2i.defaultText.scratchpadTip%5D%5C%22%20with%20your%20own%20tip.%20Just%20change%20this%20line%20to%20%5C%22tip%20=%20You%20own%20cool%20tips.%5C%22%5Cn%20%20%20%20%20%20type%20=%20paragraph%20//%20%3C--%20large%20text%20box%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20text%20that%20the%20user%20inputs%20will%20be%20remembered%20so%20it's%20still%20there%20even%20if%20they%20close/refresh%20the%20page%5Cn%20%20%20%20%20%20parseVariables%20=%20true%20//%20%3C--%20allows%20people%20to%20write%20stuff%20like%20%5C%22ANIMAL%20=%20%7Bdog%7Ccat%7Cfrog%7D%5C%22%20in%20the%20scratchpad,%20and%20then%20use%20%5C%22%5BANIMAL%5D%5C%22%20in%20their%20prompt%20to%20get%20a%20random%20one%20of%20those%20animals.%20Combined%20with%20the%20settings-sharing-link%20feature,%20this%20basically%20allows%20people%20to%20create%20their%20own%20shareable%20image%20generator.%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%20//%20%3C--%20the%20minimum%5Cn%20%20%20%20%20%20height%20=%2040vh%20%20//%20%3C--%2040vh%20means%2040%25%20of%20the%20%5C%22view%20height%5C%22%20(i.e.%20page%20height)%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20foldToggleState%20=%20hidden%20//%20or%20'shown'%20if%20you%20want%20it%20to%20start%20shown,%20or%20delete%20this%20line%20if%20you%20don't%20want%20it%20to%20be%20show-able/hide-able%5Cn%20%20%20%20%20%20visible()%20=%3E%5Cn%20%20%20%20%20%20%20%20return%20Number(localStorage.generateClickCount)%20%3E%201;%20//%20so%20the%20scratchpad%20only%20shows%20up%20after%20they've%20clicked%20generate%20a%20couple%20of%20times%20(to%20reduce%20confusion/clutter%20for%20newbies)%5Cn%20%20%20%20%20%20examples%5Cn%20%20%20%20%20%20%20%20%5Bt2i.defaultText.scratchpadPlaceholder%5D%5Cn%5Cn%20%20%20%20description%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%93%9D%20Description%20%5Cn%20%20%20%20%20%20tip%20=%20%5Bt2i.defaultText.promptTip%5D%5Cn%20%20%20%20%20%20type%20=%20paragraph%20//%20%3C--%20large%20text%20box%5Cn%20%20%20%20%20%20width%20=%20min(750px,%20100%25)%5Cn%20%20%20%20%20%20takesUpFullRow%20=%20true%5Cn%20%20%20%20%20%20useVariables%20=%20true%20//%20See%20comment%20on%20the%20%60parseVariables%20=%20true%60%20line%20on%20the%20%60scratchpad%60%20user%20input,%20above.%20This%20line%20makes%20it%20so%20those%20variables%20can%20be%20used%20in%20this%20text%20box.%5Cn%20%20%20%20%20%20modifiers%20=%20%5Binput.artStyle?.modifiers%20%7C%7C%20null%5D%5Cn%20%20%20%20%20%20modifierUpdates%20=%20event:description.input,%20event:artStyle.change%5Cn%20%20%20%20%20%20enterKeyTriggersGeneration%20=%20true%20//%20%3C--%20can%20still%20use%20shift+enter%20to%20create%20a%20new%20line%5Cn%20%20%20%20%20%20//%20we%20use%20artstyle-specific%20random%20prompts%20if%20available,%20otherwise%20fall%20back%20to%20randomDescriptions%20list:%5Cn%20%20%20%20%20%20examples%20=%20%5Binput.artStyle?.randomPrompt%20%7C%7C%20randomDescription%5D%20//%20%3C--%20the%20placeholder%20examples%20that%20rotate%20in%20the%20text%20box%5Cn%20%20%20%20%20%20random%20=%20%5Binput.artStyle?.randomPrompt%20%7C%7C%20randomDescription%5D%20//%20%3C--%20added%20to%20the%20text%20box%20when%20the%20'random'%20button%20gets%20clicked%5Cn%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%9A%AB%20Anti-Description%20(optional)%5Cn%20%20%20%20%20%20tip%20=%20%5Bt2i.defaultText.negativePromptTip%5D%5Cn%20%20%20%20%20%20type%20=%20text%20//%20%3C--%20single-line%20text%20box%5Cn%20%20%20%20%20%20useVariables%20=%20true%20//%20See%20comment%20on%20%60useVariables%60%20line%20on%20the%20%60description%60%20user%20input,%20above.%5Cn%20%20%20%20%20%20examples%20=%20things%20you%20%F0%9D%97%B1%F0%9D%97%BC%F0%9D%97%BB'%F0%9D%98%81%20want%20in%20the%20image%20//%20'examples'%20are%20shown%20as%20the%20placeholder%20text,%20so%20we%20hackily%20use%20that%20here%20to%20explain%20what%20'anti-description'%20means%5Cn%5Cn%20%20%20%20artStyle%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%8E%A8%20Art%20Style%5Cn%20%20%20%20%20%20type%20=%20select%20//%20%3C--%20drop-down%20select%20menu%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20makes%20it%20so%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20meta:import%5Cn%20%20%20%20%20%20%20%20%20%20from%20=%20%7Bimport:t2i-styles%7D%20//%20%3C--%20imports%20a%20bunch%20of%20'default'%20styles.%20You%20can%20delete%20this%20line%20and%20the%20above%20line,%20or%20put%20these%20two%20lines%20at%20the%20end,%20below%20'No%20style'%20if%20you%20want.%20You%20can%20also%20visit%20%20https://perchance.org/t2i-styles#edit%20%20in%20your%20browser,%20and%20then%20edit%20the%20styles%20to%20your%20liking,%20then%20save%20it,%20then%20swap%20%20%7Bimport:t2i-styles%7D%20%20at%20the%20start%20of%20the%20line%20you're%20reading%20right%20now%20with%20%20%7Bimport:the-name-at-the-end-of-your-page-url%7D%20%20-%20note%20that%20the%20%5C%22the-name-at-the-end-of-your-page-url%5C%22%20will%20be%20randomly%20generated%20letters%20numbers%20when%20you%20save%20it,%20but%20you%20can%20change%20that%20in%20settings%20menu%20if%20you%20want.%5Cn%20%20%20%20%20%20%20%20%20%20//tagWeights%20=%20pokemon:10,%20pixelArt:3%20%20%20%20//%20Note:%20tagWeights%20are%20not%20used%20in%20this%20generator,%20but%20you%20can%20remove%20the%20%5C%22//%5C%22%20at%20the%20very%20beginning%20of%20this%20line%20(so%20it%20just%20starts%20with%20%5C%22tagWeights%20=%20%5C%22)%20and%20then%20specify%20some%20tags%20and%20their%20importance%20values%20-%20open%20this%20link%20in%20a%20new%20tab%20to%20see%20tags:%20%20%20https://perchance.org/t2i-styles#edit%20%20%20-%20look%20at%20the%20names%20on%20the%20%5C%22meta:tags%5C%22%20lines.%5Cn%20%20%20%20%20%20%20%20MTG%20Card%20//%20%3C--%20example%20of%20a%20custom%20%5C%22Magic%20The%20Gathering%5C%22%20card%20style%20-%20just%20follow%20this%20format%20and%20add%20as%20many%20of%20them%20as%20you%20want%20to%20this%20'options'%20list.%20Make%20sure%20to%20keep%20the%20indentation%20correctly%20aligned%20as%20you%20see%20here.%20Notice%20that%20you%20can%20use%20the%20other%20inputs%20within%20the%20prompt%20like%20%5Binput.description%5D.%20You%20can%20create%20more%20inputs,%20and%20use%20them%20in%20the%20prompt%20too.%20Look%20at%20the%20%60shape%60%20input%20below%20for%20an%20example%20of%20a%20drop-down%20input%20(i.e.%20type=select).%20That%20one%20can%20be%20referenced%20via%20%5Binput.shape%5D%20-%20not%20that%20you'd%20want%20to%20put%20that%20in%20the%20prompt,%20but%20you%20can%20copy%20that%20%60shape%60%20list%20and%20name%20it%20something%20else,%20and%20then%20reference%20it%20via%20%5Binput.somethingElse%5D%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20magic%20the%20gathering%20card,%20%5Binput.description%5D,%20incredible%20magic%20the%20gathering%20artwork%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20blurry,%20bad%20art%5Cn%20%20%20%20%20%20%20%20%F0%9D%97%A1%F0%9D%97%BC%20%F0%9D%98%80%F0%9D%98%81%F0%9D%98%86%F0%9D%97%B9%F0%9D%97%B2%5Cn%20%20%20%20%20%20%20%20%20%20prompt%20=%20%5Binput.description%5D%20//%20for%20%5C%22No%20style%5C%22%20we%20just%20use%20their%20prompt%20directly%20-%20i.e.%20we%20don't%20add%20any%20other%20text%20around%20it.%5Cn%20%20%20%20%20%20%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20%20%20%20%20%20%20meta:position%20=%205%20//%20%3C--%20this%20means%20the%20%5C%22No%20style%5C%22%20option%20will%20be%20exactly%205th%20in%20the%20list,%20regardless%20of%20tagWeights%5Cn%5Cn%20%20%20%20shape%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%96%BC%EF%B8%8F%20Shape%5Cn%20%20%20%20%20%20type%20=%20select%20//%20%3C--%20drop-down%20select%20menu%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%20Portrait%20=%20512x768%5Cn%20%20%20%20%20%20%20%20Square%20=%20512x512%5Cn%20%20%20%20%20%20%20%20Landscape%20=%20768x512%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20numImages%5Cn%20%20%20%20%20%20label%20=%20%F0%9F%94%A2%20How%20many?%5Cn%20%20%20%20%20%20type%20=%20select%20//%20%3C--%20drop-down%20select%20menu%5Cn%20%20%20%20%20%20remember%20=%20true%20//%20%3C--%20the%20selected%20option%20will%20be%20remembered%20even%20if%20the%20user%20refreshes/closes%20the%20page%5Cn%20%20%20%20%20%20options%5Cn%20%20%20%20%20%20%20%206%20=%206%5Cn%20%20%20%20%20%20%20%209%20=%209%5Cn%20%20%20%20%20%20%20%2012%20=%2012%5Cn%20%20%20%20%20%20%20%2015%20=%2015%5Cn%20%20%20%20%20%20%20%203%20=%203%5Cn%20%20%20%20%20%20visible()%20=%3E%5Cn%20%20%20%20%20%20%20%20return%20Number(localStorage.generateClickCount)%20%3E%201;%20//%20so%20this%20input%20only%20shows%20up%20after%20they've%20clicked%20generate%20a%20couple%20of%20times%20(to%20reduce%20confusion/clutter%20for%20newbies)%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20defaultCommentOptions%20//%20for%20comments%20plugin:%20https://perchance.org/comments-plugin%5Cn%20%20%20%20width%20=%20100%25%5Cn%20%20%20%20height%20=%20400%5Cn%20%20%20%20commentPlaceholderText%20=%20Type%20a%20friendly%20comment...%5Cn%20%20%20%20submitButtonText%20=%20submit%20comment%5Cn%20%20%20%20customEmojis%20=%20%7Bimport:huge-emoji-list%7D%5Cn%20%20%20%20bannedUsers%20=%20%5BbannedUsersList%5D%5Cn%20%20%20%20%5Cn%20%20commentChannels%5Cn%20%20%20%20allowCustomChannels%20=%20true%20//%20adds%20a%20%5C%22+%5C%22%20button%20so%20people%20can%20add%20more%20channels%20(others%20won't%20see%20the%20channel%20unless%20they%20also%20add%20it)%5Cn%20%20%20%20general%5Cn%20%20%20%20%20%20label%20=%20General%5Cn%20%20%20%20chat1%5Cn%20%20%20%20%20%20label%20=%20Room%201%5Cn%20%20%20%20chat2%5Cn%20%20%20%20%20%20label%20=%20Room%202%5Cn%20%20%20%20chat3%5Cn%20%20%20%20%20%20label%20=%20Room%203%5Cn%20%20%20%20prompts%5Cn%20%20%20%20%20%20label%20=%20Prompts%5Cn%20%20%20%20%20%20commentPlaceholderText%20=%20Share%20a%20cool%20prompt/style.%20If%20it's%20good,%20it%20may%20get%20added%20to%20the%20Art%20Style%20selector.%5Cn%20%20%20%20%20%20submitButtonText%20=%20share%20prompt%5Cn%20%20%5Cn%20%20galleryOptions%5Cn%20%20%20%20gallery%20=%20true%5Cn%20%20%20%20sort%20=%20trending%5Cn%20%20%20%20hideIfScoreIsBelow%20=%20-1%5Cn%20%20%20%20adaptiveHeight%20=%20true%20//%20%3C--%20expand%20gallery%20height%20so%20it%20never%20has%20its%20own%20scrollbar%5Cn%20%20%20%20contentFilter%20=%20pg13%20//%20%3C--%20or%20'none'%20for%20no%20default%20filter%5Cn%20%20%5Cn%20%20showFeedback%20=%20false%20//%20you%20can%20temporarily%20change%20this%20to%20'true'%20and%20then%20click%20the%20feedback%20button%20to%20view%20feedback%5Cn%5Cn%5Cn//%20This%20list%20is%20used%20in%20the%20'randomDescription'%20list,%20below.%5Cnroyalty%5Cn%20%20queen%5Cn%20%20king%5Cn%20%20prince%5Cn%20%20princess%5Cn%20%20emperor%5Cn%20%20%20%20%20%20%20%20%5Cn//%20This%20'randomDescription'%20list%20is%20used%20for%20the%20'random'%20button%20(see%20the%20%60random%60%20property%20of%20the%20%60description%60%20item%20in%20the%20%60userInputs%60%20list,%20above).%20You%20can%20change%20the%20items%20below%20to%20whatever%20you%20want,%20and%20you%20can%20use%20any%20Perchance%20syntax,%20of%20course.%20%20%20%5CnrandomDescription%5Cn%20%20%7Benigmatic%7Cmysterious%7D%20%7Bdemon%7Cangel%7Cghost%7D%20%5Broyalty%5D%20%7Bsitting%20on%7Cstanding%20beside%7D%20%7Btheir%20throne%7Ca%20cosmic%20altar%7D,%20%7Ba%20horde%20of%20minions%7Can%20array%20of%20celestial%20servants%7Ca%20legion%20of%20spectral%20beings%7D%20%7Bbehind%7Cin%20front%20of%7D%20then,%20%7Bclose-up%20%7Ccharacter%20%7C%7Dportrait%5Cn%20%20portrait%20of%20%7Ba%7D%20%7Bimport:animal%7D-%7Bman%7Cwoman%7D,%20%7Bservant%7Cgod%7Cpriest%7Cwarrior%7Cgardener%7Ckeeper%7D%20of%20%7Bthe%20underworld%7Cthe%20seven%20worlds%7Clight%7Cdarkness%7Cjungle%20world%7Ccybercrystal%7Cblue%20fire%7Celectrical%20storms%7Cthe%20deep%20heart%7Cthe%20overworld%7Cluxury%7Cdragonkind%7D%5Cn%20%20%7Ba%7D%20%7Bcute%20%7C%5E3%7D%7Bimport:animal%7D%20x%20%7Bimport:animal%7D%20hybrid,%20pokemon-like%20creature%5Cn%20%20%7Bcyborg%7Csteampunk%7Cmagical%7D%20%7Bmermaid%7Cmerman%7Cdolphin%7D%20exploring%20%7Ba%20coral%20reef%7Can%20underwater%20city%7Cunderwater%20dunes%7D%5Cn%20%20%7Bsteampunk%7Cfuturistic%7Cancient%7D%20explorer%20with%20%7Ban%20airship%7Ca%20hoverbike%7Ca%20time-traveling%20artifact%7D%5Cn%20%20%7Bgraceful%7Cagile%7Cmysterious%7D%20%7Balien%7Chuman%7Crobotic%7D%20dancer%20performing%20%7Bon%20stage%7Cin%20a%20street%7Cin%20moonlight%7D%5Cn%20%20%7Bneon%7Csunset%7Cmoonlit%7D%20cityscape%20during%20%7Ba%20rainstorm%7Ca%20snowfall%7Ca%20meteor%20shower%7D%5Cn%20%20%7Bmagical%7Cenchanted%7Ccursed%7D%20forest%20guarded%20by%20%7Bgiant%20mushrooms%7Csentient%20trees%7Cwhimsical%20spirits%7D%5Cn%20%20%7Blonely%7Cbrave%7Ccurious%7D%20lighthouse%20keeper%20with%20%7Ba%20ghostly%7Can%20animal%7Ca%20supernatural%7D%20companion%5Cn%20%20%7Bhaunted%7Cabandoned%7Cancient%7D%20mansion%20inhabited%20by%20%7Bquirky%7Ccreepy%7Ckind%7D%20spirits%5Cn%20%20%7Bfuturistic%7Cold-fashioned%7Cmagical%7D%20train%20racing%20through%20%7Ba%20desert%7Ca%20tundra%7Ca%20jungle%7D%20landscape%5Cn%20%20%7Bunderwater%7Csky%7Cspace%7D%20pirate%20captain%20with%20%7Ba%20submarine%7Can%20airship%7Ca%20spaceship%7D%20ship%5Cn%20%20%7Btime-traveling%7Cinterdimensional%7Csupernatural%7D%20detective%20with%20%7Ba%20pet%20dinosaur%7Ca%20ghostly%20sidekick%7Ca%20shape-shifting%20familiar%7D%5Cn%20%20%7Brobotic%7Cmedieval%7Cfantasy%7D%20knight%20jousting%20on%20%7Ba%20mechanical%7Ca%20fire-breathing%7Ca%20spectral%7D%20horse%5Cn%20%20%7Bethereal%7Cancient%7Ccosmic%7D%20space%20goddess%20floating%20among%20%7Bstars%7Cnebulae%7Cgalaxies%7D%5Cn%20%20%7Bwise%7Cancient%7Cintelligent%7D%20%7Btree%7Crock%7Ccloud%7D%20spirit%20with%20%7Ba%20magical%20staff%7Ca%20crystal%20orb%7Can%20enchanted%20flute%7D%5Cn%20%20%7Bsuperhero%7Cvillain%7Cantihero%7D%20with%20the%20ability%20to%20control%20%7Bplants%7Cweather%7Cfire%7D%5Cn%20%20%7Bflying%7Chovering%7Csubmersible%7D%20car%20chase%20through%20%7Ba%20futuristic%7Can%20underwater%7Ca%20post-apocalyptic%7D%20city%5Cn%20%20%7Bunderwater%7Cfloating%7Chidden%7D%20cityscape%20lit%20by%20%7Bbioluminescent%20plants%7Cancient%20crystals%7Cmagical%20torches%7D%5Cn%20%20%7Bmystical%7Ccursed%7Cprehistoric%7D%20cave%20with%20%7Bglowing%20crystal%7Cshimmering%20ice%7Cluminescent%20fungus%7D%20formations%5Cn%20%20%7Bpost-apocalyptic%7Cfuturistic%7Cancient%7D%20wanderer%20with%20%7Ba%20pet%20robot%7Ca%20loyal%20animal%20companion%7Ca%20supernatural%20guide%7D%5Cn%20%20%7Bmasked%7Carmored%7Cstealthy%7D%20vigilante%20perched%20%7Bon%20a%20skyscraper%7Cin%20a%20tree%7Catop%20a%20cliff%7D%5Cn%20%20%7Bsorceress%7Cwitch%7Calchemist%7D%20brewing%20%7Ba%20potion%7Ca%20spell%7Ca%20concoction%7D%20in%20%7Bher%20hidden%20lair%7Ca%20secret%20cave%7Can%20enchanted%20laboratory%7D%5Cn%20%20%7Bsteampunk%7Ccyberpunk%7Cfantasy%7D%20inventor%20with%20%7Ba%20mechanical%7Ca%20magical%7Ca%20sentient%7D%20companion%5Cn%20%20%7Bcyberpunk%7Cinterstellar%7Cparanormal%7D%20hacker%20in%20%7Ba%20digital%20world%7Ca%20secret%20network%7Can%20alternate%20reality%7D%5Cn%20%20%7Benchanted%7Cfairy-tale%7Csecret%7D%20garden%20filled%20with%20%7Bmythical%7Cunusual%7Cmagical%7D%20creatures%5Cn%20%20%7Bcute%7Cfierce%7Cfriendly%7D%20monster%20family%20%7Bgoing%20on%20a%20picnic%7Cexploring%20a%20forest%7Cvisiting%20a%20village%7D%5Cn%20%20%7Bastronaut%7Calien%7Ctime-traveler%7D%20discovering%20%7Ban%20alien%20oasis%7Ca%20hidden%20planet%7Ca%20realm%20beyond%20time%7D%5Cn%20%20%7Bold-fashioned%7Cmodern%7Cmagical%7D%20%7Bice%20cream%7Ccandy%7Cdessert%7D%20parlour%20with%20%7Bmagical%7Cunusual%7Cdangerous%7D%20flavors%5Cn%20%20%7Babandoned%7Chaunted%7Cenchanted%7D%20amusement%20park%20%7Breclaimed%20by%20nature%7Cinhabited%20by%20spirits%7Cguarded%20by%20creatures%7D%5Cn%20%20%7Bwarrior%7Csorceress%7Cqueen%7D%20riding%20%7Ba%20mythical%7Ca%20giant%7Can%20elemental%7D%20beast%5Cn%20%20%7Bvintage%7Cmodern%7Cotherworldly%7D%20circus%20with%20%7Bsupernatural%7Cmagical%7Cdangerous%7D%20performers%5Cn%20%20%7Botherworldly%7Cmajestic%7Cmysterious%7D%20library%20filled%20with%20%7Bancient%7Cenchanted%7Cforbidden%7D%20tomes%5Cn%20%20%7Bintrepid%7Cfearless%7Cdaring%7D%20explorer%20navigating%20%7Ba%20perilous%7Ca%20mysterious%7Can%20enchanted%7D%20jungle%5Cn%20%20%7Bcozy%7Cremote%7Cenchanted%7D%20cottage%20in%20%7Bthe%20mountains%7Ca%20forest%7Ca%20magical%20realm%7D%20with%20%7Bmagical%7Csupernatural%7Cancient%7D%20neighbors%5Cn%20%20%7Bstreet%7Cstage%7Ctelevised%7D%20magician%20performing%20%7Ba%20jaw-dropping%7Ca%20dangerous%7Can%20enchanting%7D%20illusion%5Cn%20%20%7Bmighty%7Cancient%7Cwinged%7D%20dragon%20%7Bslumbering%7Cguarding%7Chiding%7D%20atop%20%7Ba%20hoard%20of%20treasure%7Cenchanted%20crystals%7Ccursed%20artifacts%7D%5Cn%20%20%7Bchibi-style%7Ccartoon%7Crealistic%7D%20superheroes%20%7Bsaving%20the%20day%7Cbattling%20villains%7Cprotecting%20a%20city%7D%5Cn%20%20%7Bwhimsical%7Cindustrial%7Csupernatural%7D%20factory%20where%20%7Bdreams%7Cnightmares%7Cwishes%7D%20are%20manufactured%5Cn%20%20%7Bspace%7Cintergalactic%7Ctime-traveling%7D%20cowboy%20hunting%20%7Bintergalactic%20outlaws%7Cancient%20threats%7Csupernatural%20foes%7D%5Cn%20%20%7Bnecromancer%7Csummoner%7Cwitch%7D%20raising%20%7Ban%20army%20of%20the%20undead%7Celemental%20creatures%7Cmagical%20beings%7D%5Cn%20%20%7Bbrave%7Ccursed%7Clegendary%7D%20warrior%20with%20%7Ba%20haunted%7Can%20enchanted%7Ca%20sentient%7D%20weapon%5Cn%20%20%7Binterdimensional%7Ccosmic%7Cparanormal%7D%20%7Bcoffee%7Ctea%7Cdessert%7D%20shop%20frequented%20by%20%7Bodd%7Cmagical%7Calien%7D%20patrons%5Cn%20%20%7Benchanted%7Cbewitched%7Csacred%7D%20forest%20populated%20by%20%7Bsentient%7Cmagical%7Ccursed%7D%20trees%5Cn%20%20%7Bcybernetic%7Csupernatural%7Cmystical%7D%20musician%20creating%20%7Botherworldly%7Chaunting%7Chypnotic%7D%20tunes%5Cn%20%20%7Balien%7Clost%7Cancient%7D%20civilization%20thriving%20on%20%7Ba%20floating%20island%7Ca%20hidden%20continent%7Can%20undiscovered%20planet%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%5Cn//%20Banned%20from%20comments%20section%20(tap%20user%20tag%20to%20get%20full%20ID):%5CnbannedUsersList%5Cn%20%20bc1fcaee323bb814a90b%5Cn%20%20465b9234479607b40f66%5Cn%20%20224ce382e80983fdd5f0%5Cn%20%208366eebe591939239c5e%5Cn%20%20a67b60e2a97aef42584a%5Cn%20%20d0be072bf68e8ccde3ef%5Cn%20%2008102ccd25373b373a05%5Cn%20%20fd7c09e9f6afd038ab25%5Cn%20%20034fa4072177e4a16624%5Cn%20%20436fd3dad1d2f690682d%5Cn%20%20824a10d41014455bfcde%5Cn%20%204ed5c79d72af33da6606%5Cn%20%20ff4e338ab405b78d0882%5Cn%20%20dada105214441a883e91%5Cn%20%20ba1e03de6390f34d2ae0%5Cn%20%20d0fa20d240b6a36b795f%5Cn%20%2018576abec56cf04bbb47%5Cn%20%20225af84547f6b8cecd32%5Cn%20%20498dedc2f2d9f51d83a6%5Cn%20%20f87716c6bba6ae6b9e03%5Cn%20%20b7d91eeffa46845925b1%5Cn%20%2025f41fbdca8174293343%5Cn%20%2067382e6b36a2ac7bdef3%5Cn%20%20c2c2f158b8031b507b2f%5Cn%20%2010e7aefa20bbf6fe7f1a%5Cn%20%205d967bcb5c1b0dab2b44%5Cn%20%206c8b50927a15b34b4c5b%5Cn%20%207dec0c175ff0bf1af243%5Cn%20%20fa984ea74cbcd4fd59ec%5Cn%20%20cf9bb0c51663d6d6f567%5Cn%20%2091ebdee1ca60d2837544%5Cn%20%208eaaa282bcc2ba121fa2%5Cn%20%20aa27fdf92bd1cd41fd15%5Cn%20%20f1a1c0f2bd704e67baaf%5Cn%20%2004af815eef0e5638b514%5Cn%20%20099ebc92d5f61488c88a%5Cn%20%202737a96e836eee89f9dc%5Cn%20%20081792d41ef26e68a134%5Cn%20%20bb26f42d55dcdfe1241d%5Cn%20%20ec7ff7a84b0f7c296f64%5Cn%20%20c36d43b9a9b01652900d%5Cn%20%20836e2803b38ac7439db9%5Cn%20%20dea3b240900b6b1853fc%5Cn%20%208783f17c2f258e67c25d%5Cn%20%200fd8aca20f91c464926a%5Cn%20%20127c0571733e6c6fe9b6%5Cn%20%204fc5eb761deb5516bfc4%5Cn%20%2066678bd8747a788401f2%5Cn%20%20df26ffadf6e2fb387144%5Cn%20%20c607b35d65cc7402c21f%5Cn%20%201624bfee153d7a6fc0d2%5Cn%20%2012348b59bccc33cc629d%5Cn%20%20c607914a136a1129f9f4%5Cn%20%207e328c2e0de3d2e26e4d%5Cn%20%201134cacff6986d7f789c%5Cn%20%205cc96f3c8c9fea8c928a%5Cn%20%208f5dec6f9f96e56dc775%5Cn%20%200fec8aba0d659aac6419%5Cn%20%209fd2ba897af9260873b3%5Cn%20%2088b800c3ddc308313236%5Cn%20%2069378603a9238023a99c%5Cn%20%2009b989be6b40b957aea1%5Cn%20%201fa95ec8c1752a02d23c%5Cn%20%20c6755e6e238d158af379%5Cn%20%209c099b4dcc8c104cdf40%5Cn%20%20b0b73068df05ab210b6c%5Cn%20%201fa95ec8c1752a02d23c%5Cn%20%20b07258ed51ffcac0d243%5Cn%20%2022a2edab7d4943f2626a%5Cn%20%203f3228de2aa47a92e93e%5Cn%5Cn%5Cn%5Cn%5Cn%20%20%20%20%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%22,%22outputTemplate%22:%22%3C!--%5Cn%20%20Note:%20This%20area%20would%20normally%20have%20HTML/CSS%20in%20it,%20but%20all%20the%20HTML%5Cn%20%20is%20generated%20by%20the%20t2i-framework-plugin-v2%20which%20is%20imported%20at%5Cn%20%20the%20top%20of%20the%20other%20editor%20panel,%20and%20uses%20the%20specified%20settings%5Cn%20%20to%20construct%20the%20interface%20you%20see%20above.%5Cn%20%20%5Cn%20%20Here's%20a%20more%20'normal'%20Perchance%20generator,%20for%20comparison:%5Cn%20%20%20%20https://perchance.org/minimal%5Cn--%3E%5Cn%5BgenerateInterfaceHTML(settings)%5D%22,%22imports%22:%5B%22animal%22,%22huge-emoji-list%22,%22t2i-framework-plugin-v2%22,%22t2i-styles%22%5D,%22canLink%22:true,%22isPrivate%22:true%7D</script>
        <script id="imported-generators" type="notjs">%5B%7B%22name%22:%22animal%22,%22modelText%22:%22title%20=%20Random%20Animal%20Generator%5Cnsubtitle%20=%20A%20simple%20generator%20that%20gives%20you%20a%20random%20animal%20name.%5CnfontSize%20=%20230%5CnfontColor%20=%20black%5CnbuttonText%20=%20randomize%20%5CnnumberOfItems%20=%201%5CnitemSeperator%20=%20%3Cbr/%3E%5Cndescription%5Cn%5Ct%7Bimport:simple-gen-footer%7D%5Cn%5Ct$output%20=%20%3Cp%3E%5Bthis.joinItems(%5C%22%3C/p%3E%3Cp%3E%5C%22)%5D%3C/p%3E%20//%20%3C--%20don't%20remove%20this%20last%20line,%20it%20uses%20the%20special%20%5C%22$output%5C%22%20property%20to%20join%20and%20format%20your%20description%20as%20HTML%20paragraphs%20:)%5Cn%5Cn%5Cn$output%20=%20%5Banimal%5D%5Cn%5Cn//%20Credit%20goes%20to:%20https://github.com/dariusk/corpora%5Cnanimal%5Cn%5Ctaardvark%5Cn%5Ctalligator%5Cn%5Ctalpaca%5Cn%5Ctantelope%5Cn%5Ctape%5Cn%5Ctarmadillo%5Cn%5Ctbaboon%5Cn%5Ctbadger%5Cn%5Ctbat%5Cn%5Ctbear%5Cn%5Ctbeaver%5Cn%5Ctbison%5Cn%5Ctboar%5Cn%5Ctbuffalo%5Cn%5Ctbull%5Cn%5Ctcamel%5Cn%5Ctcanary%5Cn%5Ctcapybara%5Cn%5Ctcat%5Cn%5Ctchameleon%5Cn%5Ctcheetah%5Cn%5Ctchimpanzee%5Cn%5Ctchinchilla%5Cn%5Ctchipmunk%5Cn%5Ctcougar%5Cn%5Ctcow%5Cn%5Ctcoyote%5Cn%5Ctcrocodile%5Cn%5Ctcrow%5Cn%5Ctdeer%5Cn%5Ctdingo%5Cn%5Ctdog%5Cn%5Ctdonkey%5Cn%5Ctdromedary%5Cn%5Ctelephant%5Cn%5Ctelk%5Cn%5Ctewe%5Cn%5Ctferret%5Cn%5Ctfinch%5Cn%5Ctfish%5Cn%5Ctfox%5Cn%5Ctfrog%5Cn%5Ctgazelle%5Cn%5Ctgila%20monster%5Cn%5Ctgiraffe%5Cn%5Ctgnu%5Cn%5Ctgoat%5Cn%5Ctgopher%5Cn%5Ctgorilla%5Cn%5Ctgrizzly%20bear%5Cn%5Ctground%20hog%5Cn%5Ctguinea%20pig%5Cn%5Cthamster%5Cn%5Cthedgehog%5Cn%5Cthippopotamus%5Cn%5Cthog%5Cn%5Cthorse%5Cn%5Cthyena%5Cn%5Ctibex%5Cn%5Ctiguana%5Cn%5Ctimpala%5Cn%5Ctjackal%5Cn%5Ctjaguar%5Cn%5Ctkangaroo%5Cn%5Ctkoala%5Cn%5Ctlamb%5Cn%5Ctlemur%5Cn%5Ctleopard%5Cn%5Ctlion%5Cn%5Ctlizard%5Cn%5Ctllama%5Cn%5Ctlynx%5Cn%5Ctmandrill%5Cn%5Ctmarmoset%5Cn%5Ctmink%5Cn%5Ctmole%5Cn%5Ctmongoose%5Cn%5Ctmonkey%5Cn%5Ctmoose%5Cn%5Ctmountain%20goat%5Cn%5Ctmouse%5Cn%5Ctmule%5Cn%5Ctmuskrat%5Cn%5Ctmustang%5Cn%5Ctmynah%20bird%5Cn%5Ctnewt%5Cn%5Ctocelot%5Cn%5Ctopossum%5Cn%5Ctorangutan%5Cn%5Ctoryx%5Cn%5Ctotter%5Cn%5Ctox%5Cn%5Ctpanda%5Cn%5Ctpanther%5Cn%5Ctparakeet%5Cn%5Ctparrot%5Cn%5Ctpig%5Cn%5Ctplatypus%5Cn%5Ctpolar%20bear%5Cn%5Ctporcupine%5Cn%5Ctporpoise%5Cn%5Ctprairie%20dog%5Cn%5Ctpuma%5Cn%5Ctrabbit%5Cn%5Ctraccoon%5Cn%5Ctram%5Cn%5Ctrat%5Cn%5Ctreindeer%5Cn%5Ctreptile%5Cn%5Ctrhinoceros%5Cn%5Ctsalamander%5Cn%5Ctseal%5Cn%5Ctsheep%5Cn%5Ctshrew%5Cn%5Ctsilver%20fox%5Cn%5Ctskunk%5Cn%5Ctsloth%5Cn%5Ctsnake%5Cn%5Ctsquirrel%5Cn%5Cttapir%5Cn%5Cttiger%5Cn%5Cttoad%5Cn%5Ctturtle%5Cn%5Ctwalrus%5Cn%5Ctwarthog%5Cn%5Ctweasel%5Cn%5Ctwhale%5Cn%5Ctwildcat%5Cn%5Ctwolf%5Cn%5Ctwolverine%5Cn%5Ctwombat%5Cn%5Ctwoodchuck%5Cn%5Ctyak%5Cn%5Ctzebra%5Cn%20%20anaconda%5Cn%20%20anteater%5Cn%20%20bobcat%5Cn%20%20buzzard%5Cn%20%20catfish%5Cn%20%20chicken%5Cn%20%20cobra%5Cn%20%20crab%5Cn%20%20cuckoo%5Cn%20%20dinosaur%5Cn%20%20dolphin%5Cn%20%20dove%5Cn%20%20duck%5Cn%20%20eagle%5Cn%20%20eel%5Cn%20%20emu%5Cn%20%20falcon%5Cn%20%20flamingo%5Cn%20%20goose%5Cn%20%20hare%5Cn%20%20hawk%5Cn%20%20hummingbird%5Cn%20%20lobster%5Cn%20%20meerkat%5Cn%20%20octopus%5Cn%20%20ostrich%5Cn%20%20owl%5Cn%20%20oyster%5Cn%20%20peacock%5Cn%20%20pelican%5Cn%20%20penguin%5Cn%20%20pheasant%5Cn%20%20pigeon%5Cn%20%20pony%5Cn%20%20quail%5Cn%20%20rattlesnake%5Cn%20%20rooster%5Cn%20%20shark%5Cn%20%20sparrow%22,%22imports%22:%5B%22simple-gen-footer%22%5D,%22lastEditTime%22:1651820676465,%22found%22:true%7D,%7B%22name%22:%22huge-emoji-list%22,%22modelText%22:%22$output%20=%20https://user-uploads.perchance.org/file/cc83f79bbc692f75f9b81212d06d5050.txt%5Cn%5Cn//%20The%20reason%20I%20put%20this%20simple%20URL%20into%20its%20own%20generator%20is%20so%20that%20I%20can%20update%20the%20URL%5Cn//%20here%20(e.g.%20when%20I%20add/remove%20emojis)%20and%20the%20update%20automatically%20propagates%20to%20all%20my%20generators.%5Cn%5Cn//%20You%20can%20import%20this%20into%20your%20own%20generator%20by%20putting%20this%20line%20in%20your%20comments%20options:%5Cn//%20%20%20%20customEmojis%20=%20%7Bimport:huge-emoji-list%7D%5Cn//%20But%20do%20note%20that%20I%20may%20add/remove%20emojis%20to%20improve%20the%20list,%20remove%20some%20NSFW%20that%20I%20missed,%20etc.%22,%22imports%22:%5B%5D,%22lastEditTime%22:1715004171686,%22found%22:true%7D,%7B%22name%22:%22t2i-framework-plugin-v2%22,%22modelText%22:%22//%20overall,%20this%20version%20(v2)%20moves%20toward%20the%20approach%20of%20constructing%20prompts%20within%20the%20artStyle%20list,%20such%20that%20you%20can%20e.g.%20place%20user%20inputs%20within%20a%20prompt%20multiple%20times,%20and%20have%20prompt%20construction%20completely%20depend%20on%20the%20art%20style%5Cn%5Cn//%20NOTE:%20the%20notes%20below%20are%20old/outdated.%20lots%20of%20other%20changes%20that%20aren't%20listed%20here.%5Cn%5Cn//%20changes%20(note%20that%20some%20of%20the%20non-breaking%20ones%20were%20back-ported%20to%20v1):%5Cn//%20%20-%20%5Bbreaking%5D%20all%20userInputs%20are%20now%20under%20a%20single%20%60input%60%20global%20variable%20-%20so%20%5Binput.description%5D%20instead%20of%20polluting%20global%20namespace%20with%20%5Bdescription%5D%5Cn//%20%20-%20%5Bbreaking%5D%20no%20more%20_optionName%20for%20%3Cselect%3E%20inputs%20-%20use%20%5Binput.artStyle.getName%5D%20instead%20of%20%5BartStyle_optionName%5D%5Cn//%20%20-%20%5Bbreaking%5D%20no%20more%20'append'/'prepend'%20options%20-%20not%20necessary%20now%20that%20we%20move%20to%20constructing%20prompts%20within%20the%20artStyle%20list%5Cn//%20%20-%20%60remember=true%60%20for%20user%20input%20specs,%20which%20remembers%20values%20even%20after%20page%20reload%5Cn//%20%20-%20multiple%20chat%20channels%5Cn//%20%20-%20html%20select/input%20element%20value%20is%20exposed%20on%20on%20the%20settings.userInputs.foo%20object%5Cn//%20%20-%20%60takesUpFullRow=true%60%20to%20make%20an%20input%20take%20up%20a%20full%20row%5Cn//%20%20-%20%60visible%60%20function%20property%20for%20each%20user%20input%20which%20is%20called%20after%20every%20input%20event%20and%20'generate'%20button%20click%20to%20determine%20whether%20that%20input%20should%20be%20visible%5Cn//%20%20-%20%60localStorage.generateClickCount%60%20tracks%20how%20many%20times%20the%20user%20has%20clicked%20the%20generate%20button%20%5Cn//%20%20-%20a%20lot%20of%20other%20stuff%5Cn%5Cn//%20todo,%20maybe:%5Cn//%20%20-%20%60autoSuggest=true%60%20for%20a%20text%20area%20input%20to%20get%20AI-generated%20completions%20a%20full%20prompt%20suggestions/ideas%20based%20on%20what%20the%20user%20has%20typed%20so%20far%5Cn//%20%20-%20new%20'visual'%20mode%20for%20select%20type%20-%20just%20add%20_image%20sub%20property%20(with%20url)%20to%20your%20options.%20for%20the%20artStyle%20list,%20each%20image%20could%20be%20a%20row%20of%20several%20images%20made%20with%20that%20style%5Cn//%20%20-%20add%20onChange,%20onInput,%20etc.%20to%20the%20user%20input%20objects/nodes%20-%20this%20allows%20e.g.%20changing%20a%20%3Cselect%3E%20option%20based%20on%20what%20the%20user%20types%20into%20an%20%3Cinput%3E%20option%5Cn%5Cn//%20notes:%5Cn//%20%20-%20default%20styles:%20https://perchance.org/t2i-styles#edit%5Cn//%20%20-%20image%20grid%20maker:%20https://perchance.org/image-grid-maker#edit%5Cn//%20%20%5Cn%5CntextToImagePlugin%20=%20%7Bimport:text-to-image-plugin%7D%5CncommentsPlugin%20=%20%7Bimport:comments-plugin%7D%5CnselectLeaf%20=%20%7Bimport:select-leaf-plugin%7D%5CnfullscreenButton%20=%20%7Bimport:fullscreen-button-plugin%7D%5CnaiText%20=%20%7Bimport:ai-text-plugin%7D%5Cnupload%20=%20%7Bimport:upload-plugin%7D%5Cn%5Cn//%20This%20$output%20function%20simply%20takes%20a%20%60settings%60%20list/hierarchy%20as%20an%20input,%20and%20returns%20the%20full%20HTML%20for%20the%20page%5Cn%5Cn$output(settings)%20=%3E%5Cn%20%20if(!window.input)%20window.input%20=%20%7B%7D;%5Cn%20%20if(!window.t2i)%20%7B%5Cn%20%20%20%20window.t2i%20=%20%7B%7D;%5Cn%20%20%20%20window.t2i.defaultText%20=%20%7B%5Cn%20%20%20%20%20%20promptTip:%20%60Tip:%20You%20can%20write%20text%20like%20{blue%7Cred%7Cgreen}%20and%20a%20random%20one%20will%20be%20chosen%20for%20each%20image.%5C%5Cn%5C%5CnClick%20the%20info%20icon%20on%20an%20image%20to%20see%20the%20prompt%20that%20was%20used.%5C%5Cn%5C%5CnAdd%20brackets%20around%20text%20(like%20this)%20or%20((even%20more))%20to%20get%20the%20AI%20to%20pay%20more%20attention%20to%20it.%60,%5Cn%20%20%20%20%20%20negativePromptTip:%20%60Important:%20If,%20for%20example,%20you%20don't%20want%20the%20image%20to%20have%20blue%20in%20it,%20just%20write%20%5C%22blue%5C%22%20in%20this%20box.%20Don't%20write%20%5C%22no%20blue%5C%22!%20In%20other%20words,%20you%20should%20write%20a%20description%20of%20a%20hypothetical%20%5C%22opposite%20image%5C%22%20of%20what%20you%20want.%60,%5Cn%20%20%20%20%20%20scratchpadTip:%20%60A%20little%20notepad%20for%20you%20to%20keep%20good%20prompts%20and%20stuff.%20It%20'remembers'%20the%20text%20that%20you%20put%20in%20it%20even%20after%20you%20refresh/close%20this%20page.%5C%5Cn%5C%5CnThe%20text%20will%20only%20be%20forgotten%20if%20you%20clear%20your%20browser's%20%5C%22site%20data%5C%22%20(cookies,%20localStorage,%20etc.)%20for%20perchance.org%60,%5Cn%20%20%20%20%20%20scratchpadPlaceholder:%20%60Use%20this%20box%20to%20store%20prompts%20and%20notes.%20They'll%20be%20remembered%20even%20if%20you%20refresh%20this%20page%20(unless%20you%20are%20in%20private%20browsing%20mode).%20Also,%20you%20can%20write:%5C%5Cn%5C%5CnANIMAL%20=%20{dog%7Cmouse%7Cfrog}%5C%5Cn%5C%5Cnin%20this%20box,%20and%20then%20write%20'[ANIMAL]'%20within%20your%20description%20(including%20the%20square%20brackets)%20to%20get%20a%20random%20one%20of%20those%20animals%20for%20each%20generated%20image.%20And%20you%20can%20replace%20the%20%F0%9F%8E%B2%20button's%20outputs%20by%20adding%20a%20DESCRIPTION%20line%20to%20this%20text%20box,%20like%20this:%5C%5Cn%5C%5CnDESCRIPTION%20=%20a%20very%20{silly%7Ccurious}%20[ANIMAL]%60,%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20window.t2i.handyText%20=%20window.t2i.defaultText;%20//%20'handyText'%20was%20the%20old%20name%5Cn%20%20%7D%5Cn%5Cn%20%20//%20Add%20some%20default%20settings%20(it's%20okay%20to%20write%20directly%20to%20the%20input%20parameter,%20because%20it's%20only%20used%20once%20-%20i.e.%20this%20function%20is%20only%20called%20once)%5Cn%20%20if(!settings.imageOptions.style)%20%7B%5Cn%20%20%20%20settings.imageOptions.style%20=%20%5C%22margin:0.25rem;%20border-radius:3px;%5C%22;%5Cn%20%20%7D%5Cn%5Cn%20%20//%20We%20need%20to%20make%20these%20global%20since%20we%20wnat%20to%20reference%20them%20from%20the%20HTML%20of%20the%20*importing*%20generator%20(e.g.%20in%20click%20handlers,%20etc.)%5Cn%20%20window.___textToImagePlugin746291937%20=%20textToImagePlugin;%5Cn%20%20window.___commentsPlugin746291937%20=%20commentsPlugin;%5Cn%20%20window.___userSettings746291937%20=%20settings;%5Cn%20%20window.___fullscreenButton893479%20=%20fullscreenButton;%5Cn%5Cn//%20%20%20let%20appState;%5Cn//%20%20%20try%20%7B%5Cn//%20%20%20%20%20appState%20=%20JSON.parse(localStorage.appState_nif983gh4tkshdf79834hi);%5Cn//%20%20%20%7D%20catch(e)%20%7B%5Cn//%20%20%20%20%20appState%20=%20%7B%7D;%5Cn//%20%20%20%7D%5Cn%20%20%5Cn//%20%20%20function%20saveAppState()%20%7B%5Cn//%20%20%20%20%20localStorage.appState_nif983gh4tkshdf79834hi%20=%20JSON.stringify(appState);%5Cn//%20%20%20%7D%5Cn%5Cn%5Cn%20%20if(!window.alreadyAddedT2IStuff83927492374)%20%7B%20//%20this%20$output%20function%20will%20only%20get%20called%20once,%20*except*%20when%20author%20is%20editing%20their%20generator,%20so%20this%20if%20statement/wrapper%20thing%20is%20just%20to%20prevent%20weird%20stuff%20for%20generator%20authors%5Cn%20%20%20%20//%20hide%20some%20clutter%20when%20in%20fullscreen:%5Cn%20%20%20%20document.addEventListener(%5C%22fullscreenchange%5C%22,%20function(e)%20%7B%5Cn%20%20%20%20%20%20let%20fbBtn%20=%20feedbackBtn893745ykfuhd;%5Cn%20%20%20%20%20%20let%20dmBtn%20=%20darkModeBtn_875979f948;%5Cn%20%20%20%20%20%20if(document.fullscreenElement)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20we%20just%20entered%20fullscreen%5Cn%20%20%20%20%20%20%20%20dmBtn.dataset.preFullscreenDisplayValue%20=%20dmBtn.style.display;%5Cn%20%20%20%20%20%20%20%20dmBtn.dataset.duringFullscreenDisplayValue%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20dmBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20fbBtn.dataset.preFullscreenDisplayValue%20=%20fbBtn.style.display;%5Cn%20%20%20%20%20%20%20%20fbBtn.dataset.duringFullscreenDisplayValue%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20fbBtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20//%20we%20just%20exited%20fullscreen,%20so%20we%20revert%20the%20display%20values%20*if*%20they're%20the%20same%20as%20what%20we%20set%20them%20to%20when%20we%20entered%20fullscreen%20(so%20we%20don't%20interfere%20with%20other%20code%20that%20may%20have%20since%20changed%20the%20display%20values)%5Cn%20%20%20%20%20%20%20%20if(dmBtn.style.display%20===%20dmBtn.dataset.duringFullscreenDisplayValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20dmBtn.style.display%20=%20dmBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20delete%20dmBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20delete%20dmBtn.dataset.duringFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20if(fbBtn.style.display%20===%20fbBtn.dataset.duringFullscreenDisplayValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20fbBtn.style.display%20=%20fbBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20delete%20fbBtn.dataset.preFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%20%20delete%20fbBtn.dataset.duringFullscreenDisplayValue;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.alreadyAddedT2IStuff83927492374%20=%20true;%5Cn%20%20%7D%5Cn%5Cn%20%20window.__createSelectorModal_56974639274%20=%20async%20function(options)%20%7B%20//%20use%20it%20like%20this:%20await%20createSelectorModal(%5B%7Bhtml:%5C%22foo%5C%22,%20value:%5C%22foo%5C%22%7D,%20%7Bhtml:%5C%22bar%5C%22,%20value:%5C%22bar%5C%22%7D%5D)%5Cn%20%20%20%20let%20resolve;%5Cn%20%20%20%20let%20promise%20=%20new%20Promise(r%20=%3E%20resolve%20=%20r);%5Cn%5Cn%20%20%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20let%20modal%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20ctn.style.cssText%20=%20%60position:fixed;%20top:0;%20left:0;%20width:100%25;%20height:100%25;%20background:rgba(0,0,0,0.3);%20backdrop-filter:%20blur(5px);%20display:flex;%20align-items:center;%20justify-content:center;%60;%5Cn%20%20%20%20modal.style.cssText%20=%20%60max-width:900px;%20width:95%25;%20max-height:95%25;%20background:var(--box-color);%20box-shadow:0%200%2010px%20rgba(0,0,0,0.5);%20overflow:auto;%60;%5Cn%5Cn%20%20%20%20options.forEach(opt%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20item%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20item.innerHTML%20=%20opt.html;%5Cn%20%20%20%20%20%20item.style.cssText%20=%20%60margin:0.5rem;%20border:3px%20solid%20$%7Bopt.selected%20?%20%5C%22#565656%5C%22%20:%20%5C%22rgba(0,0,0,0)%5C%22%7D;%20cursor:pointer;%60;%5Cn%20%20%20%20%20%20if(!opt.disabled)%20%7B%5Cn%20%20%20%20%20%20%20%20item.onmouseover%20=%20()%20=%3E%20item.style.border%20=%20%5C%223px%20dashed%20#8a8a8a%5C%22;%5Cn%20%20%20%20%20%20%20%20item.onmouseout%20=%20()%20=%3E%20item.style.border%20=%20opt.selected%20?%20%5C%223px%20solid%20#565656%5C%22%20:%20%5C%223px%20solid%20rgba(0,0,0,0)%5C%22;%5Cn%20%20%20%20%20%20%20%20item.onclick%20=%20()%20=%3E%20resolve(opt.value);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20modal.appendChild(item);%5Cn%20%20%20%20%7D);%5Cn%5Cn%20%20%20%20ctn.onclick%20=%20(e)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(e.target%20===%20ctn)%20resolve(null);%20//%20returns%20null%20if%20the%20user%20didn't%20select%20an%20option%20(i.e.%20they%20clicked%20somewhere%20outside%20the%20popup)%5Cn%20%20%20%20%7D;%5Cn%5Cn%20%20%20%20ctn.appendChild(modal);%5Cn%20%20%20%20document.body.append(ctn);%5Cn%5Cn%20%20%20%20let%20value%20=%20await%20promise;%5Cn%20%20%20%20ctn.remove();%5Cn%20%20%20%20return%20value;%5Cn%20%20%7D%5Cn%5Cn%20%20function%20saveRememberedInput(inputName,%20inputValue)%20%7B%5Cn%20%20%20%20localStorage%5B%60rememberedInput_P9hkcjnv92hfO2bf9hiu_$%7BinputName%7D%60%5D%20=%20inputValue;%5Cn%20%20%7D%5Cn%20%20function%20getRememberedInput(inputName)%20%7B%5Cn%20%20%20%20return%20localStorage%5B%60rememberedInput_P9hkcjnv92hfO2bf9hiu_$%7BinputName%7D%60%5D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20updateInputVisibilities()%20%7B%5Cn%20%20%20%20let%20userInputs%20=%20window.___userSettings746291937.userInputs;%5Cn%20%20%20%20for(let%20name%20of%20userInputs.getChildNames)%20%7B%5Cn%20%20%20%20%20%20if(userInputs%5Bname%5D.visible%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20userInputs%5Bname%5D._element.closest('.input-ctn').style.display%20=%20userInputs%5Bname%5D.visible()%20?%20%5C%22%5C%22%20:%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20/////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20%3Cselect%3E%20element%20changes%20%20%20%20//%5Cn%20%20/////////////////////////////////////////////////%5Cn%20%20window.___selectElChangeEvent746291937%20=%20function(event)%20%7B%5Cn%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bthis.dataset.name%5D;%20%20%20%20%5Cn%20%20%20%20let%20optionsList%20=%20userInputSpec.compiledOptions;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20displayName;%5Cn%20%20%20%20if(this.value.startsWith(%5C%22ref:optionKeyName:%5C%22))%20%7B%5Cn%20%20%20%20%20%20//%20this%20option%20wasn't%20just%20a%20simple%20key=value,%20it%20was%20a%20node%20with%20child%20properties,%20so%20we%20expose%20the%20whole%20option%20object/node%20as%20a%20global%20variable%20called%20%60this.dataset.name%60%20%5Cn%20%20%20%20%20%20let%20key%20=%20this.value.split(%5C%22:%5C%22)%5B2%5D;%5Cn%20%20%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20optionsList%5Bkey%5D;%5Cn%20%20%20%20%20%20userInputSpec.value%20=%20optionsList%5Bkey%5D;%5Cn%20%20%20%20%20%20displayName%20=%20key;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20this.value;%5Cn%20%20%20%20%20%20userInputSpec.value%20=%20this.value;%5Cn%20%20%20%20%20%20displayName%20=%20this.value;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20visualSelectBtn%20=%20this.parentElement.querySelector(%5C%22.visual-select-btn%5C%22);%5Cn%20%20%20%20if(visualSelectBtn)%20%7B%5Cn%20%20%20%20%20%20visualSelectBtn.textContent%20=%20displayName;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall%20&&%20userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20saveRememberedInput(this.dataset.name,%20this.value);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20%3Cinput%3E/%3Ctextarea%3E%20element%20changes%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20let%20parseVariablesRateLimitTimeout%20=%20null;%5Cn%20%20let%20allPreviouslyParsedVariableNames%20=%20new%20Set();%5Cn%20%20function%20parseAllVariables()%20%7B%5Cn%20%20%20%20let%20variableSourceTextareas%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.parseVariables%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element);%5Cn%20%20%20%20for(let%20name%20of%20allPreviouslyParsedVariableNames)%20%7B%5Cn%20%20%20%20%20%20delete%20window%5Bname%5D;%20//%20clear%20old%20variables%20first%20(if%20they%20e.g.%20delete%20their%20scratchpad%20text,%20the%20variables%20should%20go%20away)%5Cn%20%20%20%20%7D%5Cn%20%20%20%20allPreviouslyParsedVariableNames.clear();%5Cn%20%20%20%20for(let%20el%20of%20variableSourceTextareas)%20%7B%5Cn%20%20%20%20%20%20let%20varLines%20=%20el.value.split(%5C%22%5C%5Cn%5C%22).filter(line%20=%3E%20/%5E%5BA-Z0-9_%5D+?%20*=.+$/.test(line));%5Cn%20%20%20%20%20%20for(let%20line%20of%20varLines)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20name%20=%20line.split(%5C%22=%5C%22)%5B0%5D.trim();%5Cn%20%20%20%20%20%20%20%20let%20value%20=%20line.split(%5C%22=%5C%22).slice(1).join(%5C%22=%5C%22);%5Cn%20%20%20%20%20%20%20%20window%5Bname%5D%20=%20value.trim();%5Cn%20%20%20%20%20%20%20%20allPreviouslyParsedVariableNames.add(name);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20window.___inputElInputEvent746291937%20=%20function(event)%20%7B%5Cn%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bthis.dataset.name%5D;%20%5Cn%20%20%20%20%5Cn%20%20%20%20let%20value%20=%20this.value;%5Cn%20%20%20%20%5Cn%20%20%20%20if(value%20===%20%5C%22%5C%22%20&&%20userInputSpec.defaultValue%20!==%20undefined)%20value%20=%20userInputSpec.defaultValue;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20if(userInputSpec.parseVariables)%20%7B%5Cn%20%20%20%20%20%20clearTimeout(parseVariablesRateLimitTimeout);%5Cn%20%20%20%20%20%20parseVariablesRateLimitTimeout%20=%20setTimeout(parseAllVariables,%201000);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20window.input%5Bthis.dataset.name%5D%20=%20value;%5Cn%20%20%20%20userInputSpec.value%20=%20value;%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall%20&&%20userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20saveRememberedInput(this.dataset.name,%20value);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!event._isInitCall)%20%7B%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%7D%5Cn%20%20%7D;%5Cn%20%20setTimeout(parseAllVariables,%20500);%5Cn%20%20%5Cn%20%20let%20socialFeatures%20=%20settings.socialFeatures;%5Cn%20%20if(socialFeatures%20===%20undefined)%20socialFeatures%20=%20%5C%22enabled%5C%22;%5Cn%20%20socialFeatures%20=%20socialFeatures.evaluateItem;%5Cn%20%20%5Cn%20%20let%20thisGeneratorIsUsingClickCountBasedSocialDisplay%20=%20false;%5Cn%20%20%7B%5Cn%20%20%20%20let%20n%20=%20(socialFeatures.match(/button%20after%20(%5B0-9%5D+)%20clicks/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(n)%20%7B%5Cn%20%20%20%20%20%20thisGeneratorIsUsingClickCountBasedSocialDisplay%20=%20true;%5Cn%20%20%20%20%20%20n%20=%20Number(n);%5Cn%20%20%20%20%20%20if(Number(localStorage.generateClickCount%20%7C%7C%200)%20%3E=%20n)%20%7B%5Cn%20%20%20%20%20%20%20%20socialFeatures%20=%20%5C%22button%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20socialFeatures%20=%20%5C%22disabled%5C%22;%5Cn%20%20%20%20%20%20%20%20window.showSocialFeaturesButtonAfterThisManyClicks%20=%20n;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20%20copy%20share%20link%20button%20handler%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////%5Cn%20%20window.__generateSettingsShareLink084722%20=%20async%20function%20generateShareLink()%20%7B%20%5Cn%20%20%20%20%5Cn%20%20%20%20if(!localStorage.knowsHowShareLinksWork)%20%7B%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20heuristic%20to%20try%20to%20warn%20about%20their%20scratchpad%20being%20shared%20too:%5Cn%20%20%20%20%20%20let%20includingScratchpadWarning%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20let%20sharableScratchpadExists%20=%20Object.values(window.___userSettings746291937.userInputs).find(o%20=%3E%20(o.getName%20===%20%5C%22scratchpad%5C%22%20%7C%7C%20o.getName%20===%20%5C%22notes%5C%22%20%7C%7C%20o.getName%20===%20%5C%22notepad%5C%22)%20&&%20!o.excludeFromShareLink);%5Cn%20%20%20%20%20%20if(sharableScratchpadExists)%20includingScratchpadWarning%20=%20%60,%20%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B0%F0%9D%97%B9%F0%9D%98%82%F0%9D%97%B1%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B4%20the%20scratchpad/notepad%20text%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20confirmed%20=%20confirm(%60This%20will%20create%20a%20sharable%20link%20to%20a%20snapshot%20of%20the%20settings%20you've%20specified%20above$%7BincludingScratchpadWarning%7D.%60);%5Cn%20%20%20%20%20%20if(!confirmed)%20%7B%5Cn%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20localStorage.knowsHowShareLinksWork%20=%20%5C%221%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%5Cn%20%20%20%20if(!window.CompressionStream)%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22Share%20links%20use%20a%20feature%20that's%20only%20available%20in%20modern%20browsers.%20Please%20upgrade%20your%20browser%20to%20the%20latest%20version%20to%20use%20this%20feature.%5C%22);%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22none%5C%22;%5Cn%5Cn%20%20%20%20shareSettingsBtn758374.disabled%20=%20true;%5Cn%20%20%20%20shareSettingsBtn758374.textContent%20=%20%5C%22%E2%8F%B3%20uploading%20settings%20data...%5C%22;%5Cn%5Cn%20%20%20%20let%20dataJsonStr%20=%20JSON.stringify(getAllUserInputValues());%5Cn%5Cn%20%20%20%20//%20convert%20json%20text%20to%20blob:%5Cn%20%20%20%20let%20blob%20=%20await%20fetch(%5C%22data:text/plain;charset=utf-8,%5C%22+dataJsonStr.replace(/#/g,%20%5C%22%2523%5C%22)).then(res%20=%3E%20res.blob());%5Cn%5Cn%20%20%20%20//%20compress%20blob:%5Cn%20%20%20%20let%20compressedBlob%20=%20await%20compressBlobWithGzip(blob);%5Cn%5Cn%20%20%20%20let%20%7B%20url,%20size,%20error%20%7D%20=%20await%20upload(compressedBlob);%5Cn%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20shareSettingsLinkInputEl759307.value%20=%20%60error:%20$%7Berror%7D%60;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20shareSettingsLinkInputEl759307.value%20=%20%60https://perchance.org/$%7Bwindow.generatorName%7D#data=%60+url.replace(%5C%22https://user-uploads.perchance.org/file/%5C%22,%20%5C%22uup1:%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20shareSettingsBtn758374.textContent%20=%20%5C%22%F0%9F%94%97%20share%20these%20settings%5C%22;%5Cn%20%20%20%20shareSettingsBtn758374.disabled%20=%20false;%5Cn%20%20%20%20shareSettingsBtn758374.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20async%20function%20compressBlobWithGzip(blob)%20%7B%5Cn%20%20%20%20const%20cs%20=%20new%20CompressionStream('gzip');%5Cn%20%20%20%20const%20compressedStream%20=%20blob.stream().pipeThrough(cs);%5Cn%20%20%20%20let%20outputBlob%20=%20await%20new%20Response(compressedStream).blob();%5Cn%20%20%20%20return%20new%20Blob(%5BoutputBlob%5D,%20%7B%20type:%20%5C%22application/gzip%5C%22%20%7D);%20//%20%3C--%20to%20add%20the%20correct%20mime%20type%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20async%20function%20loadDataFromUrlHash()%20%7B%20%5Cn%20%20%20%20let%20success%20=%20false;%5Cn%20%20%20%20if(!window.DecompressionStream)%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22Share%20links%20use%20a%20browser%20feature%20that's%20only%20available%20in%20modern%20browsers.%20Please%20upgrade%20your%20browser%20to%20the%20latest%20version%20(ideally%20Chrome%20or%20Edge)%20to%20allow%20for%20loading%20data%20from%20character%20share%20links.%5C%22);%5Cn%20%20%20%20%20%20return%20%7Bsuccess,%20error:%5C%22browser_compat%5C%22%7D;%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20let%20loadingModal%20=%20document.createElement('div');%5Cn%20%20%20%20loadingModal.innerHTML%20=%20%60%3Cdiv%20style=%5C%22position:%20fixed;%20top:%200;%20left:%200;%20width:%20100%25;%20height:%20100%25;%20background-color:%20rgba(0,%200,%200,%200.5);%20z-index:%209999;%20display:%20flex;%20justify-content:%20center;%20align-items:%20center;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22padding:%2020px;%20background-color:%20var(--box-color);%20border-radius:%208px;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%E2%8F%B3%20loading%20share%20link%20data...%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20loadingModal%20=%20loadingModal.firstElementChild;%5Cn%20%20%20%20document.body.append(loadingModal);%5Cn%5Cn%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20let%20hashText%20=%20window.location.hash.slice(1);%5Cn%20%20%20%20%20%20if(!hashText.startsWith(%5C%22data=%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20throw%20new%20Error(%5C%22Invalid%20share%20URL.%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20fileUrl%20=%20hashText.replace(/%5Edata=/,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20if(fileUrl.startsWith(%5C%22uup1:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20fileUrl%20=%20fileUrl.replace(%5C%22uup1:%5C%22,%20%5C%22https://user-uploads.perchance.org/file/%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20fetchOptions%20=%20%7B%7D;%5Cn%20%20%20%20%20%20if(window.AbortSignal%20&&%20AbortSignal.timeout)%20fetchOptions.signal%20=%20AbortSignal.timeout(10000);%5Cn%20%20%20%20%20%20let%20blob%20=%20await%20fetch(fileUrl,%20fetchOptions).then(res%20=%3E%20res.blob());%5Cn%20%20%20%20%20%20let%20text;%5Cn%20%20%20%20%20%20if(fileUrl.endsWith(%5C%22.gz%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20let%20decompressedBlob%20=%20await%20decompressBlobWithGzip(blob);%5Cn%20%20%20%20%20%20%20%20text%20=%20await%20decompressedBlob.text();%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20text%20=%20await%20blob.text();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20let%20data%20=%20JSON.parse(text);%5Cn%20%20%20%20%20%20if(data.___format%20===%20%5C%22t2i-framework-format1%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userHasSomeTextTheyAreTryingToRemember%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.remember%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element.value).join(%5C%22%5C%22).length%20%3E%20100;%5Cn%20%20%20%20%20%20%20%20if(userHasSomeTextTheyAreTryingToRemember)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20confirmed%20=%20confirm(%5C%22%F0%9D%97%9B%F0%9D%97%B2%F0%9D%97%AE%F0%9D%97%B1%F0%9D%98%80%20%F0%9D%98%82%F0%9D%97%BD:%20You're%20loading%20a%20share%20link.%20This%20will%20overwrite%20your%20existing%20saved%20settings/scratchpad.%20%F0%9D%97%96%F0%9D%97%BC%F0%9D%97%BB%F0%9D%98%81%F0%9D%97%B6%F0%9D%97%BB%F0%9D%98%82%F0%9D%97%B2?%5C%5Cn%5C%5Cn(Note:%20You%20can%20click%20cancel%20and%20then%20load%20the%20share%20link%20in%20your%20browser's%20incognito/private%20mode%20to%20avoid%20overwriting%20your%20current%20data,%20or%20just%20backup%20your%20existing%20data%20first.)%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20if(!confirmed)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20loadingModal.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return%20%7Bsuccess,%20error:%5C%22loading_cancelled_by_user%5C%22%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20importUserInputValues(data);%5Cn%20%20%20%20%20%20%20%20success%20=%20true;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20alert(%5C%22Unknown%20share%20link%20data%20format.%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20alert(%60Failed%20to%20load%20share%20link%20data:%20$%7Be.message%7D%60);%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20loadingModal.remove();%5Cn%20%20%20%20return%20%7Bsuccess%7D;%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20decompressBlobWithGzip(blob)%20%7B%5Cn%20%20%20%20const%20ds%20=%20new%20DecompressionStream(%5C%22gzip%5C%22);%5Cn%20%20%20%20const%20decompressedStream%20=%20blob.stream().pipeThrough(ds);%5Cn%20%20%20%20return%20await%20new%20Response(decompressedStream).blob();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20getAllUserInputValues()%20%7B%5Cn%20%20%20%20let%20userInputs%20=%20%7B%7D;%5Cn%20%20%20%20for(let%20key%20in%20window.___userSettings746291937.userInputs)%20%7B%5Cn%20%20%20%20%20%20if(window.___userSettings746291937.userInputs%5Bkey%5D.excludeFromShareLink)%20continue;%5Cn%20%20%20%20%20%20let%20value%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element?.value;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20userInputs%5Bkey%5D%20=%20value;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20userInputs.___format%20=%20%5C%22t2i-framework-format1%5C%22;%5Cn%20%20%20%20return%20userInputs;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20importUserInputValues(data)%20%7B%5Cn%20%20%20%20for(let%20key%20in%20window.___userSettings746291937.userInputs)%20%7B%5Cn%20%20%20%20%20%20if(window.___userSettings746291937.userInputs%5Bkey%5D.excludeFromShareLink)%20continue;%5Cn%20%20%20%20%20%20let%20value%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element?.value;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20if(data%5Bkey%5D%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20el%20=%20window.___userSettings746291937.userInputs%5Bkey%5D._element;%5Cn%20%20%20%20%20%20%20%20%20%20el.value%20=%20data%5Bkey%5D;%5Cn%20%20%20%20%20%20%20%20%20%20if(el.onchange)%20el.onchange(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20if(el.oninput)%20el.oninput(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20social/gallery%20button%20stuff%20%20%20%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20window.__showSocialsButtonClickHandler98347938%20=%20function()%20%7B%5Cn%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294());%5Cn%20%20%20%20imageGalleryCtn8569284.innerHTML=window.generateImageGalleryHtml358402048();%5Cn%20%20%20%20showHideGalleryAndCommentsButtonsCtn83728732671.style.display='';%5Cn%20%20%20%20if(autoShowCheckbox84937483.checked)%20%7B%20localStorage.autoShowSocialsNextTime='1';%20%7D;%5Cn%20%20%20%20showSocialsButtonCtn9000274628.remove();%5Cn%20%20%20%20if(thisGeneratorIsUsingClickCountBasedSocialDisplay%20&&%20!localStorage.theyKnowAboutClickCountBasedSocialDisplay)%20%7B%5Cn%20%20%20%20%20%20clickCountBasedSocialDisplayNotifierEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20handler%20for%20generate%20button%20click%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////%5Cn%20%20window.___generateButtonClickEvent746291937%20=%20async%20function(event)%20%7B%5Cn%20%20%5Cn%20%20%20%20clearPerchanceErrors();%20//%20in%20case%20they%20has%20errors%20in%20their%20syntax%20in%20their%20last%20attempt,%20we%20don't%20want%20to%20keep%20showing%20the%20error%20bubble%20forever%5Cn%20%20%5Cn%20%20%20%20shareSettingsBtn758374.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20shareLinkCtn83927376.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%5Cn%20%20%20%20generateButtonEl.textContent%20=%20%5C%22%E2%AC%87%EF%B8%8F%20generating...%20%E2%AC%87%EF%B8%8F%5C%22;%5Cn%20%20%20%20generateButtonEl.disabled%20=%20true;%5Cn%20%20%20%20generateButtonEl.style.opacity%20=%200.7;%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20generateButtonEl.textContent%20=%20%5C%22generate%5C%22;%5Cn%20%20%20%20%20%20generateButtonEl.disabled%20=%20false;%5Cn%20%20%20%20%20%20generateButtonEl.style.opacity%20=%201;%5Cn%20%20%20%20%7D,%203000);%5Cn%20%20%5Cn%20%20%20%20let%20numImages%20=%206;%5Cn%20%20%20%20if(!isNaN(Number(settings.numImages?.evaluateItem)))%20numImages%20=%20Number(settings.numImages?.evaluateItem);%5Cn%20%20%20%20if(isNaN(numImages))%20numImages%20=%206;%5Cn%20%20%20%20%5Cn%20%20%20%20if(numImages%20%3E=%2012)%20%7B%5Cn%20%20%20%20%20%20mainColumnEl85394739.style.maxWidth%20=%20%5C%22100%25%5C%22;%20//%20it's%20set%20to%201000px%20by%20default%20so%203,%206,%209,%20and%2012%20images%20display%20nicely%20as%203%20per%20row,%20but%20at%2012%20or%20more%20on%20wide%20screens%20it's%20fine%20to%20take%20up%20the%20full%20screen%20width%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20mainColumnEl85394739.style.maxWidth%20=%20%5C%221000px%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(localStorage.forcedColorScheme)%20window.___userSettings746291937.imageOptions.forceColorScheme%20=%20localStorage.forcedColorScheme;%5Cn%20%20%20%20outputAreaEl.innerHTML%20=%20%5C%22%5Bwindow.___textToImagePlugin746291937(window.___userSettings746291937.imageOptions)%5D%5C%22.repeat(numImages).evaluateItem%20+%20(settings.underImagesMessage%20?%20%60%3Cdiv%20style=%5C%22margin-top:0.5rem;flex:0%200%20100%25%5C%22%3E$%7Bsettings.underImagesMessage%7D%3C/div%3E%60%20:%20%5C%22%5C%22);%5Cn%20%20%20%20%5Cn%20%20%20%20let%20generateClickCount%20=%20Number(localStorage.generateClickCount%20%7C%7C%200);%5Cn%20%20%20%20generateClickCount++;%5Cn%20%20%20%20if(isNaN(generateClickCount)%20%7C%7C%20typeof%20generateClickCount%20!==%20%5C%22number%5C%22)%20generateClickCount%20=%201;%5Cn%20%20%20%20localStorage.generateClickCount%20=%20generateClickCount;%5Cn%20%20%20%20%5Cn%20%20%20%20if(window.showSocialFeaturesButtonAfterThisManyClicks%20!==%20undefined%20&&%20generateClickCount%20%3E=%20window.showSocialFeaturesButtonAfterThisManyClicks)%20%7B%5Cn%20%20%20%20%20%20let%20socialButton%20=%20document.querySelector(%5C%22#showSocialsButtonCtn9000274628%5C%22);%5Cn%20%20%20%20%20%20if(socialButton)%20socialButton.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20shareLinkOuterCtn2893827.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20pageTitleEl48759084793.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%209%20&&%20generateClickCount%2510%20===%200)%20%7B%20//%20caution:%20don't%20change%20%2510%20without%20changing%20the%20alert%20condition%20below%5Cn%20%20%20%20%20%20let%20successfullyPersisting%20=%20false;%5Cn%20%20%20%20%20%20let%20errorWhileTryingToPersist%20=%20false;%5Cn%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20if(navigator.storage%20&&%20navigator.storage.persist)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20persistent%20=%20await%20navigator.storage.persist();%5Cn%20%20%20%20%20%20%20%20%20%20if(persistent)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Storage%20will%20not%20be%20cleared%20except%20by%20explicit%20user%20action%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20successfullyPersisting%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Storage%20may%20be%20cleared%20by%20the%20UA%20under%20storage%20pressure.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20errorWhileTryingToPersist%20=%20e;%5Cn%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(!successfullyPersisting)%20%7B%5Cn%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20userHasSomeTextTheyAreTryingToRemember%20=%20Object.values(window.___userSettings746291937.userInputs).filter(o%20=%3E%20o.remember%20&&%20o._element.tagName.toLowerCase()%20===%20%5C%22textarea%5C%22).map(o%20=%3E%20o._element.value).join(%5C%22%5C%22).length%20%3E%20100;%5Cn%20%20%20%20%20%20%20%20%20%20if(userHasSomeTextTheyAreTryingToRemember)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20//%20note:%20these%20numbers%20must%20match%20generateClickCount%2510%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(generateClickCount%20===%2020%20%7C%7C%20generateClickCount%20===%2050%20%7C%7C%20generateClickCount%20===%20100%20%7C%7C%20generateClickCount%20===%20200%20%7C%7C%20generateClickCount%20===%20400%20%7C%7C%20generateClickCount%20===%20800)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20alert(%60Heads%20up:%20Your%20browser%20is%20currently%20not%20allowing%20scratchpad/input%20text%20to%20be%20permanently%20stored/persisted%20between%20page%20visits.%20The%20stored%20text%20may%20eventually%20be%20deleted%20by%20your%20browser.%20This%20could%20be%20because%20you're%20in%20incognito/private%20mode,%20or%20your%20hard%20drive%20is%20nearly%20full,%20or%20because%20the%20web%20browser%20you're%20using%20has%20bugs.%20Chrome%20is%20currently%20best%20browser%20in%20my%20experience%20(fewest%20bugs).%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%20console.error(e);%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%5Cn%20%20%20%20bottomClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20leftClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20rightClickHelperEl.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20function%20generateModifierHtml(modifiers)%20%7B%5Cn%20%20%20%20let%20selectEls%20=%20%5B%5D;%5Cn%20%20%20%20for(let%20modifierName%20of%20modifiers.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20let%20list%20=%20modifiers%5BmodifierName%5D;%5Cn%20%20%20%20%20%20if(!list.getAllKeys)%20continue;%20//%20some%20people%20have%20bugs%20in%20their%20list%20indentation%20etc.%20and%20this%20prevents%20their%20bugs%20from%20breaking%20the%20other%20modifiers%5Cn%20%20%20%20%20%20let%20optionEls%20=%20%5B%5D;%5Cn%20%20%20%20%20%20optionEls.push(%60%3Coption%20value=%5C%22%5C%22%20selected%3EAdd%20$%7BmodifierName%7D...%3C/option%3E%60);%5Cn%20%20%20%20%20%20for(let%20key%20of%20list.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20%20%20optionEls.push(%60%3Coption%20value=%5C%22$%7Blist%5Bkey%5D.evaluateItem.replaceAll(%5C%22%5C%5C%5C%22%5C%22,%20%5C%22"%5C%22)%7D%5C%22%3E$%7Bkey%7D%3C/option%3E%60)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20selectEls.push(%60%3Cselect%20onchange=%5C%22if(this.value)%20%7B%20this.closest('.input-ctn').querySelector('textarea').value%20+=%20this.value;%20this.value='';%20this.closest('.input-ctn').querySelector('textarea').oninput(%7B%7D);%20let%20o=this.querySelector('option');%20let%20originalFirstItemContent=o.textContent;%20o.textContent='%E2%86%91%20Added%20%E2%86%91';%20setTimeout(()%20=%3E%20o.textContent=originalFirstItemContent,%201000);%20%7D%5C%22%20style=%5C%22margin-right:0.25rem;%20margin-top:0.25rem;%20font-size:80%25;%5C%22%3E$%7BoptionEls.join(%5C%22%5C%22)%7D%3C/select%3E%60);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20return%20selectEls.join(%5C%22%5C%22);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20initHandlers%20=%20%5B%5D;%5Cn%5Cn%20%20////////////////////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20generate%20the%20HTML%20based%20on%20the%20specified%20userInputs%20list%20items%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////////////////////////////////%5Cn%20%20let%20userInputsHtml%20=%20settings.userInputs.selectAll.map(item%20=%3E%20%7B%5Cn%20%20%5Cn%20%20%20%20let%20tipText%20=%20item.tip?.evaluateItem.trim();%5Cn%20%20%20%20if(tipText)%20tipText%20=%20tipText.replace(/%5C%22/g,%20%5C%22"%5C%22);%5Cn%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22text%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20widthStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.width)%20widthStyle%20+=%20%60width:$%7Bitem.width%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20keyUpKeyDownAttributes%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.enterKeyTriggersGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20keyUpKeyDownAttributes%20=%20%60onkeyup=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20document.querySelector('#generateButtonEl').click();%20%7D%5C%22%20onkeydown=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20event.preventDefault();%20%7D%5C%22%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20foldToggleState%20=%20item.foldToggleState;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20html%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-ctn%20input-type-text%20$%7Bitem.takesUpFullRow%20?%20%5C%22takesUpFullRow%5C%22%20:%20%5C%22%5C%22%7D%5C%22%20data-fold-toggle-state=%5C%22$%7BfoldToggleState%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%20style=%5C%22$%7BwidthStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BfoldToggleState%20===%20undefined%20?%20%5C%22%5C%22%20:%20%60%3Cbutton%20onclick=%5C%22let%20s%20=%20this.closest('.input-ctn').dataset.foldToggleState;%20if(s==='hidden')%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='shown';%20%7D%20else%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='hidden';%20%7D%5C%22%20class=%5C%22input-toggle-button%5C%22%3E%3C/button%3E%60%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22width:100%25;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22display:none;%5C%22%7D%5C%22%20class=%5C%22auto-suggest-btn%5C%22%3E%F0%9F%92%AD%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22padding-right:0;%5C%22%7D%5C%22%20class=%5C%22text-input%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20type=%5C%22text%5C%22%20oninput=%5C%22window.___inputElInputEvent746291937.bind(this)(event);%5C%22%20$%7BkeyUpKeyDownAttributes%7D%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7Bitem.random%20?%20%60%3Cdiv%20class=%5C%22random-input-btn-ctn%5C%22%20data-input-name=%5C%22$%7Bitem.getName%7D%5C%22%3E%3Cbutton%3E%F0%9F%8E%B2%3C/button%3E%3C/div%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22paragraph%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20widthStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.width)%20widthStyle%20+=%20%60width:$%7Bitem.width%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20textareaStyle%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20let%20height%20=%20%5C%224rem%5C%22;%5Cn%20%20%20%20%20%20if(item.height)%20%7B%5Cn%20%20%20%20%20%20%20%20height%20=%20%60$%7Bitem.height%7D%60;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20if(window.innerWidth%20%3C%20550)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20height%20=%20%5C%226rem%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20textareaStyle%20+=%20%60height:$%7Bheight%7D;%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20foldToggleState%20=%20item.foldToggleState;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20keyUpKeyDownAttributes%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20if(item.enterKeyTriggersGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20keyUpKeyDownAttributes%20=%20%60onkeyup=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20document.querySelector('#generateButtonEl').click();%20%7D%5C%22%20onkeydown=%5C%22if(event.which%20===%2013%20&&%20!event.shiftKey)%20%7B%20event.preventDefault();%20%7D%5C%22%60;%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20modifiersHtml%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20try%20%7B%20//%20try/catch%20just%20while%20testing%20this%5Cn%20%20%20%20%20%20%20%20let%20modifiersContainerId%20=%20%5C%22id%5C%22+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22)+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20modifiersHtml%20=%20%60%3Cdiv%20id=%5C%22$%7BmodifiersContainerId%7D%5C%22%20class=%5C%22input-modifiers%5C%22%20style=%5C%22display:flex;flex-wrap:%20wrap;%5C%22%3E$%7Bitem.modifiers%20?%20generateModifierHtml(item.modifiers)%20:%20%5C%22%5C%22%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(item.modifierUpdates)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20handlers%20=%20item.modifierUpdates.evaluateItem.split(%5C%22,%5C%22).map(h%20=%3E%20h.trim()).filter(h%20=%3E%20h.startsWith(%5C%22event:%5C%22)).map(h%20=%3E%20h.replace(/%5Eevent:/,%20%5C%22%5C%22).split(%5C%22.%5C%22)).map(a%20=%3E%20(%7BinputName:a%5B0%5D,%20eventName:a%5B1%5D%7D));%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20h%20of%20handlers)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20handlerFunction%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.querySelector(%60#$%7BmodifiersContainerId%7D%60).innerHTML%20=%20item.modifiers%20?%20generateModifierHtml(item.modifiers)%20:%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20initHandlers.push(%7BinputName:h.inputName,%20eventName:h.eventName,%20handler:handlerFunction%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(e);%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20html%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-ctn%20input-type-paragraph%20$%7Bitem.takesUpFullRow%20?%20%5C%22takesUpFullRow%5C%22%20:%20%5C%22%5C%22%7D%5C%22%20data-fold-toggle-state=%5C%22$%7BfoldToggleState%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%20style=%5C%22$%7BwidthStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BfoldToggleState%20===%20undefined%20?%20%5C%22%5C%22%20:%20%60%3Cbutton%20onclick=%5C%22let%20s%20=%20this.closest('.input-ctn').dataset.foldToggleState;%20if(s==='hidden')%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='shown';%20%7D%20else%20%7B%20this.closest('.input-ctn').dataset.foldToggleState='hidden';%20%7D%5C%22%20class=%5C%22input-toggle-button%5C%22%3E%3C/button%3E%60%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22width:100%25;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22display:none;%5C%22%7D%5C%22%20class=%5C%22auto-suggest-btn%5C%22%3E%F0%9F%92%AD%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Ctextarea%20style=%5C%22$%7Bitem.autoSuggest%20?%20%5C%22%5C%22%20:%20%5C%22padding-right:0;%5C%22%7D%20$%7BtextareaStyle%7D%5C%22%20class=%5C%22paragraph-input%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20oninput=%5C%22window.___inputElInputEvent746291937.bind(this)(event);%5C%22%20$%7BkeyUpKeyDownAttributes%7D%3E%3C/textarea%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7Bitem.random%20?%20%60%3Cdiv%20class=%5C%22random-input-btn-ctn%5C%22%20data-input-name=%5C%22$%7Bitem.getName%7D%5C%22%3E%3Cbutton%20class=%5C%22random-input-btn%5C%22%3E%F0%9F%8E%B2%3C/button%3E%3Cbutton%20class=%5C%22ai-suggest-btn%5C%22%20style=%5C%22margin-top:0.25rem;%5C%22%3E%F0%9F%A7%A0%3C/button%3E%3C/div%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BmodifiersHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(item.type%20===%20%5C%22select%5C%22%20%7C%7C%20item.type%20===%20%5C%22visual-select%5C%22)%20%7B%5Cn%20%20%20%20%20%20let%20options%20=%20%5B%5D;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20thereAreImports%20=%20false;%5Cn%20%20%20%20%20%20item.compiledOptions%20=%20new%20Map();%20//%20use%20map%20to%20maintain%20insertion%20order%20when%20converting%20to%20%60entries%60%5Cn%20%20%20%20%20%20let%20nameToForcedPosition%20=%20%7B%7D;%5Cn%20%20%20%20%20%20let%20groupIndex%20=%20-1;%20//%20all%20items%20within%20an%20import%20have%20the%20same%20group%20index%20and%20normally-defined%20items%20are%20their%20own%20single-item%20group%20-%20this%20is%20so%20we%20can%20properly%20do%20sorting%20at%20the%20end,%20so%20that%20all%20imports%20are%20only%20sorted%20within%20their%20group.%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20for(let%20key%20of%20item.options.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20%20%20groupIndex++;%5Cn%20%20%20%20%20%20%20%20if(key.startsWith(%5C%22meta:import%5C%22))%20%7B%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20thereAreImports%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20let%20tagImportWeights%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20if(item.options%5Bkey%5D.tagWeights)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tagImportWeights%20=%20Object.fromEntries(item.options%5Bkey%5D.tagWeights.evaluateItem.split(%5C%22,%5C%22).map(t%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20tag%20=%20t.split(%5C%22:%5C%22)%5B0%5D.trim();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20factor%20=%20Number(t.split(%5C%22:%5C%22)%5B1%5D%20??%2010);%20//%20default%20boost%20is%2010.%20note%20that%20'boost'%20can%20be%20less%20than%201,%20which%20supresses%20the%20tag,%20and%20can%20even%20be%200,%20which%20filters%20out%20items%20with%20that%20tag%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(isNaN(factor))%20factor%20=%2010;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return%20%5Btag,%20factor%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D));%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20let%20intraGroupSortingEpsilon%20=%200.00001;%20//%20%3C--%20just%20a%20little%20hack%20so%20that%20the%20imports%20that%20have%20the%20same%20score%20stay%20in%20the%20order%20in%20which%20they%20were%20defined%20in%20the%20imported%20list%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20optionItem%20of%20item.options%5Bkey%5D.from.selectAll)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(item.compiledOptions.has(optionItem.getName))%20continue;%20//%20we%20don't%20overwrite%20ones%20that%20came%20before%20(higher%20takes%20precedence%20over%20lower)%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___groupIndex%20=%20groupIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20item.compiledOptions.set(optionItem.getName,%20optionItem);%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(optionItem%5B%5C%22meta:position%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20nameToForcedPosition%5BoptionItem.getName%5D%20=%20optionItem%5B%5C%22meta:position%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(optionItem%5B%5C%22meta:tags%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20for%20each%20importer%20tag%20weight,%20we%20multiply%20it%20by%20the%20matching%20'inherent'%20weight%20of%20the%20tag%20(if%20it%20exists%20on%20this%20imported%20item).%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20note%20that%20this%20means%20that%20if%20there%20are%20*any*%20matches,%20then%20ONLY%20those%20matches%20are%20considered.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20thereWereTagWeightMatches%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20for(let%20%5Btag,%20inherentTagWeight%5D%20of%20Object.entries(optionItem%5B%5C%22meta:tags%5C%22%5D))%20%7B%20//%20for%20each%20tag%20on%20this%20imported%20item%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(tagImportWeights%5Btag%5D%20!==%20undefined)%20%7B%20//%20if%20the%20importer%20has%20specified%20a%20weight%20for%20this%20tag%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20thereWereTagWeightMatches%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20+=%20inherentTagWeight*tagImportWeights%5Btag%5D;%20//%20add%20to%20the%20score%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20if%20this%20imported%20style%20didn't%20have%20any%20tags%20that%20matched%20any%20of%20the%20importer%20tag%20weights,%20then%20we%20set%20its%20ranking%20score%20to%201%20+%20a%20small%20amount%20based%20on%20the%20mean%20of%20its%20inherent%20tag%20weights:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!thereWereTagWeightMatches)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20inherentTagWeights%20=%20Object.values(optionItem%5B%5C%22meta:tags%5C%22%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20EDIT:%20the%20problem%20with%20this%20is%20that%20it%20separates%20'categories'%20of%20styles%20which%20are%20better%20defined%20together%20-%20e.g.%20if%20all%20the%20anime%20styles%20are%20defined%20one%20after%20the%20other,%20then%20it's%20better%20to%20leave%20them%20like%20that%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20so%20for%20now%20I'm%20just%20going%20to%20set%20the%20score%20to%201%20if%20there%20were%20no%20matching%20tags.%20Can%20change%20this%20in%20v3%20if%20needed.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%201;%20//%20+%20(inherentTagWeights.reduce((a,v)%20=%3E%20a+v,%200)%20/%20inherentTagWeights.length)%20/%2010000;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20=%201;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20optionItem.___intraGroupRankingScore%20+=%20intraGroupSortingEpsilon;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20intraGroupSortingEpsilon%20-=%20intraGroupSortingEpsilon*0.00001;%20//%20so%20the%20next%20item%20will%20get%20a%20slightly%20smaller%20boost%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20item.options%5Bkey%5D.___groupIndex%20=%20groupIndex;%5Cn%20%20%20%20%20%20%20%20%20%20item.options%5Bkey%5D.___intraGroupRankingScore%20=%201;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20item.compiledOptions.set(key,%20item.options%5Bkey%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(item.options%5Bkey%5D%5B%5C%22meta:position%5C%22%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20nameToForcedPosition%5Bkey%5D%20=%20item.options%5Bkey%5D%5B%5C%22meta:position%5C%22%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20entries%20=%20%5B...item.compiledOptions.entries()%5D;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(thereAreImports)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20filter%20out%20items%20with%20a%20score%20below%20or%20equal%20to%20zero%5Cn%20%20%20%20%20%20%20%20entries%20=%20entries.filter(e%20=%3E%20e%5B1%5D.___intraGroupRankingScore%20%3E%200);%5Cn%5Cn%20%20%20%20%20%20%20%20//%20here%20we%20do%20score-based%20ordering%20while%20strictly%20maintaining%20group%20index%20ordering.%5Cn%20%20%20%20%20%20%20%20//%20note%20that%20items%20from%20a%20meta:import%20are%20all%20part%20of%20their%20own%20group,%20whereas%20items%20that%20are%20defined%20normally%20are%20their%20own%20single-item%20group.%5Cn%20%20%20%20%20%20%20%20entries.sort((a,%20b)%20=%3E%20a%5B1%5D.___groupIndex%20-%20b%5B1%5D.___groupIndex%20%7C%7C%20b%5B1%5D.___intraGroupRankingScore%20-%20a%5B1%5D.___intraGroupRankingScore);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20do%20forced%20positioning:%5Cn%20%20%20%20%20%20for(let%20%5Bname,%20position%5D%20of%20Object.entries(nameToForcedPosition))%20%7B%5Cn%20%20%20%20%20%20%20%20let%20index%20=%20entries.findIndex((%5Bkey%5D)%20=%3E%20key%20===%20name);%5Cn%20%20%20%20%20%20%20%20if(index%20!==%20-1)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20%5Bremoved%5D%20=%20entries.splice(index,%201);%20//%20remove%20the%20item%20from%20its%20current%20position%5Cn%20%20%20%20%20%20%20%20%20%20entries.splice(position,%200,%20removed);%20//%20insert%20it%20into%20the%20desired%20position%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20item.compiledOptions%20=%20Object.fromEntries(entries);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20options.push(...entries.map((%5Bname,%20obj%5D)%20=%3E%20name).map(n%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20hasSubKeys%20=%20false;%5Cn%20%20%20%20%20%20%20%20if(item.compiledOptions%5Bn%5D.getAllKeys%20&&%20item.compiledOptions%5Bn%5D.getAllKeys.length%20%3E%200)%20hasSubKeys%20=%20true;%20//%20hasSubKeys%20is%20needed%20because%20if%20it%20does%20have%20subkeys,%20then%20we%20expose%20the%20whole%20option%20object/node%20as%20%60keyName%60,%20rather%20than%20just%20the%20value%5Cn%20%20%20%20%20%20%20%20let%20keyName%20=%20n;%5Cn%20%20%20%20%20%20%20%20let%20display%20=%20item.compiledOptions%5Bn%5D.name%20??%20n;%5Cn%20%20%20%20%20%20%20%20let%20value%20=%20item.compiledOptions%5Bn%5D;%5Cn%20%20%20%20%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20value,%5Cn%20%20%20%20%20%20%20%20%20%20display,%5Cn%20%20%20%20%20%20%20%20%20%20keyName:n,%5Cn%20%20%20%20%20%20%20%20%20%20hasSubKeys,%5Cn%20%20%20%20%20%20%20%20%20%20disabled:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:disabled%5C%22%5D%20===%20true,%5Cn%20%20%20%20%20%20%20%20%20%20image:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:image%5C%22%5D,%5Cn%20%20%20%20%20%20%20%20%20%20selected:%20item.compiledOptions%5Bn%5D%5B%5C%22meta:selected%5C%22%5D%20===%20true,%5Cn%20%20%20%20%20%20%20%20%7D;%20%5Cn%20%20%20%20%20%20%7D));%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20selectedOpt%20=%20options.find(opt%20=%3E%20opt.selected);%5Cn%20%20%20%20%20%20if(!selectedOpt)%20options%5B0%5D.selected%20=%20true;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20selectElHtml%20=%20%60%5Cn%20%20%20%20%20%20%20%20%3Cselect%20style=%5C%22$%7Bitem.type%20===%20%5C%22visual-select%5C%22%20?%20%5C%22display:none;%5C%22%20:%20%5C%22%5C%22%7D%20width:-webkit-fill-available;%20width:-moz-available;%20width:fill-available;%20max-width:9rem;%5C%22%20data-name=%5C%22$%7Bitem.getName%7D%5C%22%20onchange=%5C%22window.___selectElChangeEvent746291937.bind(this)(event);%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7Boptions.map(opt%20=%3E%20%60%3Coption%20value=%5C%22$%7Bopt.hasSubKeys%20?%20%60ref:optionKeyName:$%7Bopt.keyName%7D%60%20:%20opt.value%7D%5C%22%20$%7Bopt.disabled%20?%20%5C%22disabled%5C%22%20:%20%5C%22%5C%22%7D%20%20$%7Bopt.selected%20?%20%5C%22selected%5C%22%20:%20%5C%22%5C%22%7D%3E$%7Bopt.display%7D%3C/option%3E%60).join(%5C%22%5C%5Cn%5C%22)%7D%5Cn%20%20%20%20%20%20%20%20%3C/select%3E%5Cn%20%20%20%20%20%20%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20the%20visual%20select%20is%20just%20a%20%5C%22facade%5C%22%20over%20the%20top%20of%20a%20normal%20(hidden)%20select%20-%20the%20underlying%20%3Cselect%3E%20is%20still%20used%20for%20all%20relevant%20logic%5Cn%20%20%20%20%20%20if(item.type%20===%20%5C%22visual-select%5C%22)%20%7B%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20visualSelectOptions%20=%20options.map(opt%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20visualHtml;%5Cn%20%20%20%20%20%20%20%20%20%20if(false%20&&%20opt.image)%20%7B%20//%20TODO:%20work%20out%20the%20best%20approach%20here%20(e.g.%20grid%20+%20%5C%22slideshow%5C%22%20for%20each%20style?)%20and%20then%20enabled%20this%5Cn%20%20%20%20%20%20%20%20%20%20%20%20visualHtml%20=%20%60%3Cimg%20src=%5C%22$%7Bopt.image%7D%5C%22%20style=%5C%22max-height:20vh;%20display:block;%5C%22%3E%3Cdiv%20style=%5C%22font-size:85%25;position:%20sticky;bottom:%202rem;left:0;right:0;width:100%25;height:%200;text-align:center;%5C%22%3E%3Cspan%20style=%5C%22background:#ffffff;%20padding:0.25rem;%20border:2px%20solid%20black;%20border-radius:0.25rem;%20color:black;%5C%22%3E$%7Bopt.display%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!window.__preloadedVisualSelectImageUrls_957378)%20window.__preloadedVisualSelectImageUrls_957378%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(!window.__preloadedVisualSelectImageUrls_957378%5Bopt.image%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20img%20=%20document.createElement(%5C%22img%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20img.src%20=%20opt.image;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20img.style.cssText%20=%20%60position:fixed;%20width:1px;%20height:1px;%20left:-10px;%20top:-10px;%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(img);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.__preloadedVisualSelectImageUrls_957378%5Bopt.image%5D%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20visualHtml%20=%20%60%3Cdiv%20style=%5C%22display:flex;%20justify-content:center;%20align-items:center;%20min-height:3rem;%5C%22%3E$%7Bopt.display%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20return%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20value:%20opt.hasSubKeys%20?%20%60ref:optionKeyName:$%7Bopt.keyName%7D%60%20:%20opt.value,%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20disabled:%20opt.disabled,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20selected:%20opt.selected,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20html:%20%60%3Cdiv%20style=%5C%22border-radius:3px;%20overflow:hidden;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22overflow-x:auto;%20overflow-y:hidden;%20position:relative;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20$%7BvisualHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%60,%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20selectElHtml%20=%20%60%5Cn%20%20%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22visual-select-btn%5C%22%20style=%5C%22width:max-content;%5C%22%20onclick=%5C%22window.__createSelectorModal_56974639274(JSON.parse(decodeURIComponent(this.dataset.options))).then(v%20=%3E%20%7B%20if(v%20!==%20null)%20%7B%20let%20selectEl%20=%20this.parentElement.querySelector('select');%20selectEl.value=v;%20selectEl.onchange(%7B%7D);%20%7D%20%7D)%5C%22%20data-options=%5C%22$%7BencodeURIComponent(JSON.stringify(visualSelectOptions))%7D%5C%22%3E$%7Boptions.find(opt%20=%3E%20opt.selected).display%7D%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%20%20$%7BselectElHtml%7D%5Cn%20%20%20%20%20%20%20%20%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20html%20=%20%60%3Cdiv%20class=%5C%22input-ctn%20input-type-select%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-inner%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-label%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%3Cspan%20style=%5C%22width:max-content;%5C%22%3E$%7Bitem.label%20%7C%7C%20item.getName.sentenceCase%7D%3C/span%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BtipText%20?%20%60%20%3Cspan%20class=%5C%22input-tip-btn%5C%22%20title=%5C%22$%7BtipText%7D%5C%22%20onclick=%5C%22alert(this.title)%5C%22%3E%E2%93%98%3C/span%3E%60%20:%20%5C%22%5C%22%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22input-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%20%20%20%20$%7BselectElHtml%7D%5Cn%20%20%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(item.takesUpFullRow)%20%7B%5Cn%20%20%20%20%20%20%20%20html%20=%20%60%3Cdiv%20style=%5C%22width:100%25;%20display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E$%7Bhtml%7D%3C/div%3E%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20return%20html;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20%5Cn%20%20%7D).join(%5C%22%5C%5Cn%5C%22);%5Cn%20%20%5Cn%20%20window.getCurrentColorScheme%20=%20function()%20%7B%5Cn%20%20%20%20if(localStorage.forcedColorScheme%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20return%20localStorage.forcedColorScheme;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20return%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.toggleManualDarkMode_jv83hb27igksf%20=%20function()%20%7B%5Cn%20%20%20%20//%20get%20current%20mode:%5Cn%20%20%20%20let%20colorScheme%20=%20window.getCurrentColorScheme();%5Cn%20%20%20%20%5Cn%20%20%20%20//%20change%20mode:%5Cn%20%20%20%20let%20newColorScheme%20=%20(colorScheme%20===%20%5C%22dark%5C%22%20?%20%5C%22light%5C%22%20:%20%5C%22dark%5C%22);%5Cn%20%20%20%20localStorage.forcedColorScheme%20=%20newColorScheme;%5Cn%20%20%20%20setColorScheme(newColorScheme);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20if%20chosen%20mode%20matches%20current%20OS%20default,%20we%20remove%20manual%20%5C%22forced%5C%22%20mode:%5Cn%20%20%20%20let%20systemColorScheme%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20%20%20if(systemColorScheme%20===%20newColorScheme)%20%7B%5Cn%20%20%20%20%20%20localStorage.removeItem(%5C%22forcedColorScheme%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20regenerate%20comments%20and%20gallery%20(to%20propagate%20forceColorScheme%20if%20needed)%5Cn%20%20%20%20if(imageGalleryCtn8569284.querySelector(%5C%22iframe%5C%22))%20%7B%5Cn%20%20%20%20%20%20imageGalleryCtn8569284.innerHTML%20=%20%5C%22%5C%22;%20//%20need%20to%20clear%20it%20first%20because%20text-to-image%20plugin%20returns%20%5C%22%5C%22%20for%20gallery%20if%20one%20already%20exists%20(it's%20doing%20a%20hacky%20thing%20to%20prevent%20update()%20from%20reloading%20the%20gallery)%5Cn%20%20%20%20%20%20imageGalleryCtn8569284.innerHTML%20=%20window.generateImageGalleryHtml358402048();%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(commentsPluginCtn654732.querySelector(%5C%22iframe%5C%22))%20%7B%5Cn%20%20%20%20%20%20commentsPluginCtn654732.innerHTML%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294())%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20function%20setColorScheme(scheme)%20%7B%5Cn%20%20%20%20if(scheme%20!==%20%5C%22dark%5C%22%20&&%20scheme%20!==%20%5C%22light%5C%22)%20throw%20new%20Error(%5C%22scheme%20should%20be%20'light'%20or%20'dark'%5C%22);%5Cn%20%20%20%20document.querySelector(%5C%22#darkModeBtn_875979f948%5C%22).textContent%20=%20(scheme%20===%20%5C%22dark%5C%22%20?%20%5C%22%F0%9F%8C%84%5C%22%20:%20%5C%22%F0%9F%8C%83%5C%22);%5Cn%20%20%20%20if(scheme%20===%20%5C%22dark%5C%22)%20%7B%5Cn%20%20%20%20%20%20document.documentElement.style.colorScheme%20=%20%5C%22dark%5C%22;%5Cn%20%20%20%20%20%20document.body.style.color%20=%20%5C%22#d8d4cf%5C%22;%5Cn%20%20%20%20%20%20document.body.style.backgroundColor%20=%20%5C%22#131516%5C%22;%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--box-color',%20'#2a2a2a');%20//%20CAUTION!!!!%20--%3E%20do%20not%20rename%20this%20variable%20-%20it%20is%20being%20used%20in%20%5C%22user-land%5C%22%20on%20some%20generators%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--active-comment-channel-tab-color',%20'#5b5b5b');%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20document.documentElement.style.colorScheme%20=%20%5C%22light%5C%22;%5Cn%20%20%20%20%20%20document.body.style.color%20=%20%5C%22black%5C%22;%5Cn%20%20%20%20%20%20document.body.style.backgroundColor%20=%20%5C%22white%5C%22;%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--box-color',%20'#ebebeb');%5Cn%20%20%20%20%20%20document.documentElement.style.setProperty('--active-comment-channel-tab-color',%20'#c6c6c6');%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20///////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20do%20some%20stuff%20after%20page%20loads%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////%5Cn%20%20window.___pageLoadHandler746291937%20=%20function()%20%7B%5Cn%20%20%20%20%5Cn%20%20%20%20//%20let%20pageUrlIsShareLink%20=%20window.location.hash.slice(1).startsWith(%5C%22data=%5C%22);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20//%20during%20page%20load,%20set%20the%20chosen%20mode%20based%20on%20localStorage%20value%20if%20it%20exists:%5Cn%20%20%20%20if(localStorage.forcedColorScheme%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20setColorScheme(localStorage.forcedColorScheme);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20user%20has%20not%20manually%20overwritten,%20so%20we%20use%20OS%20default:%5Cn%20%20%20%20%20%20let%20systemIsInDarkMode%20=%20!!(window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches);%5Cn%20%20%20%20%20%20setColorScheme(systemIsInDarkMode%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(socialFeatures%20===%20%5C%22enabled%5C%22)%20%7B%5Cn%20%20%20%20%20%20commentsPluginCtn654732.appendChild(window.generateCommentsPluginElement85638294());%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20generateClickCount%20=%20localStorage.generateClickCount%20?%20Number(localStorage.generateClickCount)%20:%200;%5Cn%20%20%20%20%5Cn%20%20%20%20if(thisGeneratorIsUsingClickCountBasedSocialDisplay%20&&%20!localStorage.theyKnowAboutClickCountBasedSocialDisplay)%20%7B%5Cn%20%20%20%20%20%20//%20clickCountBasedSocialDisplayNotifierEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20===%200)%20%7B%5Cn%20%20%20%20%20%20bottomClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20leftClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20rightClickHelperEl.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(generateClickCount%20%3E%203)%20%7B%5Cn%20%20%20%20%20%20shareLinkOuterCtn2893827.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20//%20Do%20init%20stuff%20like%20triggering%20oninput/onchange%20for%20each%20input%20right%20after%20init.%5Cn%20%20%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(localStorage.autoShowSocialsNextTime%20&&%20document.querySelector(%5C%22#showSocialsButton927514532%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20document.querySelector(%5C%22#showSocialsButton927514532%5C%22).click();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20userInputSpec._element%20=%20el;%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20for(let%20h%20of%20initHandlers)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20element%20=%20window.___userSettings746291937.userInputs%5Bh.inputName%5D._element;%5Cn%20%20%20%20%20%20%20%20element.addEventListener(h.eventName,%20h.handler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20initial%20values%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(userInputSpec.remember)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20value%20=%20getRememberedInput(el.dataset.name);%5Cn%20%20%20%20%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.value%20=%20value;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20//%20%3Cselect%3E%20options%20can%20be%20removed%20by%20gen%20authors,%20so%20if%20the%20option%20doesn't%20exist,%20we%20just%20set%20it%20to%20the%20first%20option:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if((userInputSpec.type%20===%20%5C%22select%5C%22%20%7C%7C%20userInputSpec.type%20===%20%5C%22visual-select%5C%22)%20&&%20userInputSpec.compiledOptions%5Bvalue.replace(/%5Eref:optionKeyName:/,%20%5C%22%5C%22)%5D%20===%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20el.value%20=%20el.querySelector(%5C%22option%5C%22).value;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20NOTE:%20triggering%20change/input%20events%20like%20this%20doesn't%20trigger%20addEventListener%20handlers%20-%20like%20those%20added%20via%20initHandlers,%20above,%20but%5Cn%20%20%20%20%20%20%20%20//%20for%20now%20this%20is%20a%20happy%20accident%20because%20it's%20not%20for%20modifiers%20to%20not%20show%20up%20until%20you've%20actually%20typed%20something%20-%20reduces%20UI%5Cn%20%20%20%20%20%20%20%20//%20complexity%20on%20first%20impression.%5Cn%20%20%20%20%20%20%20%20if(el.onchange)%20el.onchange(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%20%20if(el.oninput)%20el.oninput(%7B_isInitCall:true%7D);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20updateInputVisibilities();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20up%20intervals%20for%20the%20rotating%20'example'%20placeholders%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('input,%20select,%20textarea').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.name%5D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20let%20examplesList%20=%20userInputSpec.examples;%5Cn%20%20%20%20%20%20%20%20if(examplesList%20&&%20((el.nodeName%20===%20%5C%22INPUT%5C%22%20&&%20el.type%20===%20%5C%22text%5C%22)%20%7C%7C%20el.nodeName%20===%20%5C%22TEXTAREA%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20set%20rotating%20placeholder%20text%20on%20text%20inputs%5Cn%20%20%20%20%20%20%20%20%20%20function%20nextExample()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(userInputSpec.useVariables%20&&%20window%5Bel.dataset.name.toUpperCase()%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.ignorePerchanceErrors(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20el.placeholder%20=%20window%5Bel.dataset.name.toUpperCase()%5D.evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20try%20a%20few%20times%20to%20get%20a%20different%20one%20to%20the%20last-displayed%20one:%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(text%20===%20el.placeholder)%20text%20=%20selectLeaf(examplesList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20simple%20hack%20to%20save%20me%20a%20headache%20with%20escaping%20(e.g.%20for%20scratchpad%20placholder%20text)%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/[/g,%20%5C%22%5B%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/]/g,%20%5C%22%5D%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/{/g,%20%5C%22%7B%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20text%20=%20text.replace(/}/g,%20%5C%22%7D%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20el.placeholder%20=%20text;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20nextExample();%5Cn%20%20%20%20%20%20%20%20%20%20setInterval(nextExample,%203500);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20set%20up%20click%20handlers%20for%20the%20'random'%20buttons:%5Cn%20%20%20%20%20%20userInputsCtn8462746262.querySelectorAll('.random-input-btn-ctn').forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(el.querySelector(%5C%22.random-input-btn%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.random-input-btn%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20inputEl%20=%20el.closest(%5C%22.input-ctn%5C%22).querySelector(%5C%22input,%20textarea%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20userInputSpec%20=%20window.___userSettings746291937.userInputs%5Bel.dataset.inputName%5D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(userInputSpec.useVariables%20&&%20window%5Bel.dataset.inputName.toUpperCase()%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.clearPerchanceErrors();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20window%5Bel.dataset.inputName.toUpperCase()%5D.evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20randomList%20=%20userInputSpec.random;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20selectLeaf(randomList).evaluateItem;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.oninput(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(el.querySelector(%5C%22.ai-suggest-btn%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).onclick%20=%20async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20input%20=%20prompt(%5C%22Enter%20a%20couple%20of%20keywords%20or%20ideas%20and%20the%20AI%20will%20generate%20a%20prompt%20for%20you%20based%20on%20that:%5C%22,%20window.lastUsedAiSuggestPrompt%20%7C%7C%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(input%20&&%20input.trim())%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20window.lastUsedAiSuggestPrompt%20=%20input.trim();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).innerHTML%20=%20%60%3Cspan%20style=%5C%22display:inline-block;%20animation:rotate%201.5s%20linear%20infinite;%5C%22%3E%E2%8F%B3%3C/span%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).disabled%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20inputEl%20=%20el.closest(%5C%22.input-ctn%5C%22).querySelector(%5C%22input,%20textarea%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20chunkCount%20=%200;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20fullTextSoFar%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20originalInputElHeight%20=%20inputEl.offsetHeight;%20//%20so%20we%20don't%20make%20the%20textarea%20smaller%20than%20it%20originally%20was%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20%5C%22Loading...%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20pendingObj%20=%20aiText(%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20instruction:%20%60Your%20task%20is%20to%20create%20a%20description%20of%20a%20hypothetical%20image%20which%20is%20based%20on%20the%20following%20idea/keywords/instruction:%20$%7Binput.evaluateItem%7D%5C%5Cn%5C%5CnCome%20up%20with%20a%20fully-formed%20idea%20based%20on%20that%20instruction,%20and%20write%20a%20description/caption%20which%20fully%20captures%20all%20visual%20aspects%20the%20image.%20Your%20response%20should%20be%20descriptive,%20engaging,%20and%20creative.%5C%5Cn%5C%5CnStart%20your%20response%20with%20%5C%22Description:%20The%20image%20portrays%5C%22%20and%20then%20give%20a%20one-paragraph%20description%20which%20captures%20all%20visual%20details%20of%20the%20idea.%60,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20startWith:%20%60Description:%20The%20image%20portrays%60,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20stopSequences:%20%5B%5C%22%5C%5Cn%5C%22%5D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20hideStartWith:%20true,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20onChunk:%20(data)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(chunkCount%20===%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20gotFirstChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(!data.isFromStartWith)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fullTextSoFar%20+=%20data.textChunk;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.value%20=%20fullTextSoFar.trim()%5B0%5D.toUpperCase()%20+%20fullTextSoFar.trim().slice(1);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(inputEl.offsetHeight%20%3C%20inputEl.scrollHeight+10)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.style.height%20=%20%5C%2210px%5C%22;%20//%20otherwise%20scrollHeight%20can%20be%20bigger%20than%20the%20text.%20this%20ensures%20that%20the%20textarea%20is%20short%20enough%20for%20the%20textarea%20scrollbar%20to%20be%20showing%20-%20user%20shouldn't%20see%20it%20because%20its%20done%20synchonously%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputEl.style.height%20=%20Math.max(originalInputElHeight,%20inputEl.scrollHeight+10)%20+%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20chunkCount++;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20onInputInterval%20=%20setInterval(()%20=%3E%20inputEl.oninput(%7B%7D),%202000);%20//%20so%20that%20if%20they%20click%20'generate'%20mid-text-gen,%20it'll%20still%20work%5Cn%20%20%20%20%20%20%20%20%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20await%20pendingObj.onFinishPromise;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20clearInterval(onInputInterval);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputEl.oninput(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).innerHTML%20=%20%60%F0%9F%A7%A0%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.querySelector(%5C%22.ai-suggest-btn%5C%22).disabled%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20focus%20on%20first%20non-hidden%20text%20input%20(only%20on%20non-mobile%20devices,%20otherwise%20onscreen%20keyboard%20pops%20up,%20which%20might%20be%20annoying):%5Cn%20%20%20%20%20%20if(window.innerWidth%20%3E%20700%20&&%20!window.location.hash.startsWith(%5C%22#edit%5C%22)%20&&%20!window.alreadyFocussedTextAreaOnLoad)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20textInput%20=%20%5B...userInputsCtn8462746262.querySelectorAll('textarea,%20input')%5D.filter(el%20=%3E%20el.offsetHeight%20!==%200)%5B0%5D;%5Cn%20%20%20%20%20%20%20%20if(textInput)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20distanceFromTopOfPage%20=%20textInput.getBoundingClientRect().top;%5Cn%20%20%20%20%20%20%20%20%20%20if(distanceFromTopOfPage%20%3C%20300)%20%7B%20//%20don't%20focus%20if%20it's%20way%20down%20the%20page%20-%20we%20want%20to%20keep%20the%20page%20scrolled%20to%20the%20top%20on%20load%5Cn%20%20%20%20%20%20%20%20%20%20%20%20textInput.focus();%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.alreadyFocussedTextAreaOnLoad%20=%20true;%20//%20this%20is%20a%20hacky%20way%20to%20disable%20this%20when%20someone%20is%20editing%20a%20t2i-framework%20powered%20generator,%20since%20that's%20the%20only%20case%20where%20this%20plugin's%20code%20will%20be%20called%20multiple%20times%20(and%20the%20focus%20will%20annoyingly%20steal%20away%20focus%20from%20the%20perchance%20code%20editor)%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20wait%20a%20'tick'%20and%20then%20load%20share%20link%20data%20if%20it%20exists:%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%2010));%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20hash%20=%20window.location.hash.slice(1);%5Cn%20%20%20%20%20%20if(hash%20&&%20hash.startsWith(%5C%22data=%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22Loading%20data%20from%20URL%20hash...%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20result%20=%20await%20loadDataFromUrlHash();%5Cn%20%20%20%20%20%20%20%20if(result.success)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Loaded%20data%20from%20URL%20hash.%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Loading%20share%20data%20from%20URL%20hash%20failed:%5C%22,%20result);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%7D,%20100);%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20//%20Hackily%20trigger%20the%20page%20load%20handler%20with%20an%20%3Cimg%3E%20onerror%20because%20it's%20an%20easy%20way%20to%20execute%20a%20script%20right%20after%20the%20HTML%20has%20been%20rendered.%5Cn%20%20let%20dummyImageScriptTrigger%20=%20%60%3Cimg%20style=%5C%22display:fixed;opacity:0;pointer-events:none;top:-2000px;%5C%22%20src=%5C%22%5C%22%20onerror=%5C%22window.___pageLoadHandler746291937();%20this.remove();%5C%22%3E%60;%5Cn%20%20%5Cn%20%20window.generateFeedbackCommentsHtml_8974sklfjosifo%20=%20function()%20%7B%5Cn%20%20%20%20//%20old%20channel%20name:%20feedback-94d35yisdfiwh%20(annoying%20to%20subscribe%20to%20notifications%20for)%5Cn%20%20%20%20let%20options%20=%20%7Bchannel:%5C%22t2i-feedback%5C%22,%20hideComments:settings.showFeedback%20%7C%7C%20location.hash.startsWith(%5C%22#showfeedback%5C%22)%20?%20false%20:%20true,%20height:settings.showFeedback%20%7C%7C%20location.hash.startsWith(%5C%22#showfeedback%5C%22)%20?%20500%20:%20220,%20width:300,%20commentPlaceholderText:%20%5C%22Share%20some%20feedback.%20Do%20not%20share%20personal%20info,%20this%20feedback%20data%20is%20public.%20If%20there's%20a%20technical%20issue/bug%20%F0%9D%98%81%F0%9D%97%BF%F0%9D%98%86%20%F0%9D%98%82%F0%9D%98%80%F0%9D%97%B6%F0%9D%97%BB%F0%9D%97%B4%20%F0%9D%97%96%F0%9D%97%B5%F0%9D%97%BF%F0%9D%97%BC%F0%9D%97%BA%F0%9D%97%B2%20%F0%9D%97%BC%F0%9D%97%BF%20%F0%9D%97%99%F0%9D%97%B6%F0%9D%97%BF%F0%9D%97%B2%F0%9D%97%B3%F0%9D%97%BC%F0%9D%98%85,%20otherwise%20give%20as%20much%20detail%20as%20you%20can%20about%20the%20issue,%20including%20your%20device%20(e.g.%20Android/iPhone).%20If%20the%20issue%20is%20about%20bad%20outputs,%20specify%20the%20chosen%20style%20and%20prompt%20you%20used%20(if%20relevant).%5C%22,%20submitButtonText:%20%5C%22submit%20feedback%5C%22,%20hideSettingsButton:true,%20hideFullscreenButton:true%7D;%5Cn%20%20%20%20if(localStorage.forcedColorScheme)%20options.forceColorScheme%20=%20localStorage.forcedColorScheme;%5Cn%20%20%20%20return%20window.___commentsPlugin746291937(options);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.generateCommentsPluginElement85638294%20=%20function()%20%7B%5Cn%20%20%20%20let%20defaultCommentOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20let%20commentChannelsList%20=%20window.___userSettings746291937.commentChannels;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20items%20=%20%5B%5D;%5Cn%20%20%20%20for(let%20channel%20of%20commentChannelsList.selectAll)%20%7B%5Cn%20%20%20%20%20%20let%20item%20=%20%7Bname:channel.getName,%20label:channel.label%7D;%5Cn%20%20%20%20%20%20let%20commentOptions%20=%20%7B%7D;%5Cn%20%20%20%20%20%20//%20get%20default%20options:%5Cn%20%20%20%20%20%20for(let%20key%20of%20defaultCommentOptions.getAllKeys)%20%7B%5Cn%20%20%20%20%20%20%20%20commentOptions%5Bkey%5D%20=%20defaultCommentOptions%5Bkey%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20//%20apply%20channel-specific%20comment%20option%20overrides:%5Cn%20%20%20%20%20%20for(let%20key%20of%20channel.getAllKeys)%20%7B%20%5Cn%20%20%20%20%20%20%20%20commentOptions%5Bkey%5D%20=%20channel%5Bkey%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(channel.getName%20!==%20%5C%22general%5C%22)%20%7B%20//%20%3C--%20for%20backwards%20compatibility%20with%20v1%20of%20this%20framework%20(i.e.%20to%20keep%20comment%20history)%5Cn%20%20%20%20%20%20%20%20commentOptions.channel%20=%20channel.getName;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20Note:%20If%20you%20change%20stuff%20here,%20make%20sure%20to%20update%20the%20custom%20tab%20creation%20code%20in%20createCommentsTabs%20too.%5Cn%20%20%20%20%20%20if(localStorage.forcedColorScheme)%20commentOptions.forceColorScheme%20=%20localStorage.forcedColorScheme;%5Cn%20%20%20%20%20%20item.content%20=%20window.___commentsPlugin746291937(commentOptions);%5Cn%20%20%20%20%20%20items.push(item);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20return%20createCommentsTabs(items,%20%7BallowCustomChannels:!!commentChannelsList.allowCustomChannels%7D);%5Cn%20%20%7D%5Cn%20%20window.generateImageGalleryHtml358402048%20=%20function()%20%7B%5Cn%20%20%20%20if(!window.___userSettings746291937.galleryOptions%20%7C%7C%20!window.___userSettings746291937.galleryOptions.gallery)%20return%20%5C%22%5C%22;%5Cn%20%20%20%20window.___userSettings746291937.galleryOptions.forceColorScheme%20=%20null;%5Cn%20%20%20%20if(localStorage.forcedColorScheme)%20window.___userSettings746291937.galleryOptions.forceColorScheme%20=%20localStorage.forcedColorScheme;%5Cn%20%20%20%20return%20window.___textToImagePlugin746291937(window.___userSettings746291937.galleryOptions).evaluateItem;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20try%20%7B%5Cn%20%20%20%20let%20isSafari%20=%20navigator.vendor%20&&%20navigator.vendor.indexOf('Apple')%20%3E%20-1%20&&%20navigator.userAgent%20&&%20navigator.userAgent.indexOf('CriOS')%20==%20-1%20&&%20navigator.userAgent.indexOf('FxiOS')%20==%20-1;%5Cn%20%20%20%20let%20isTouchScreen%20=%20window.matchMedia(%5C%22(pointer:%20coarse)%5C%22).matches;%5Cn%20%20%20%20if(isSafari%20&&%20window.innerWidth%20%3C%20800%20&&%20isTouchScreen)%20%7B%5Cn%20%20%20%20%20%20let%20viewportMetaEl%20=%20document.querySelector(%5C%22%5Bname=viewport%5D%5C%22);%5Cn%20%20%20%20%20%20if(!viewportMetaEl.getAttribute(%5C%22content%5C%22).includes(%5C%22maximum-scale%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20viewportMetaEl.setAttribute(%5C%22content%5C%22,%20viewportMetaEl.getAttribute(%5C%22content%5C%22)%20+%20%5C%22,%20maximum-scale=1%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20console.log(%5C%22Safari%20iOS%20detected.%20Added%20maximum-scale%20attribute%20to%20prevent%20zooming:%5C%22,%20viewportMetaEl.getAttribute(%5C%22content%5C%22));%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20console.error(e);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20return%20%60%3Cstyle%3E%5Cn%20%20%20%20body%20*:not(a,%20button)%20%7B%5Cn%20%20%20%20%20%20color:%20inherit;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%20%7B%5Cn%20%20%20%20%20%20width:%20min-content;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn.takesUpFullRow%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20%7B%5Cn%20%20%20%20%20%20width:%20min-content;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-wrapper%20%7B%5Cn%20%20%20%20%20%20display:%20none;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-inner%20%7B%5Cn%20%20%20%20%20%20padding:%200.25rem;%20/*%20%3C--%20if%20you%20change%20this,%20you%20need%20to%20change%20the%20CSS%20width%20calc%20on%20input-wrapper,%20generated%20by%20the%20JS%20code%20*/%5Cn%20%20%20%20%20%20margin:%200.25rem;%5Cn%20%20%20%20%20%20border-radius:%203px;%5Cn%20%20%20%20%20%20background:%20var(--box-color,%20#ebebeb);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-type-text%20.input-inner,%20.input-type-paragraph%20.input-inner%20%7B%5Cn%20%20%20%20%20%20width:%20300px;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-label%20%7B%5Cn%20%20%20%20%20%20font-size:%2080%25;%20%5Cn%20%20%20%20%20%20text-align:%20left;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20.input-toggle-button%20%7B%5Cn%20%20%20%20%20%20margin-left:%20auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-toggle-button%20%7B%5Cn%20%20%20%20%20%20margin-left:%201rem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='hidden'%5C%5C%5C%5C%5D%20.input-toggle-button::before%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22show%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-ctn%5C%5C%5C%5C%5Bdata-fold-toggle-state='shown'%5C%5C%5C%5C%5D%20.input-toggle-button::before%20%7B%5Cn%20%20%20%20%20%20content:%20%5C%22hide%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20.text-input%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding-right:%201.375rem;%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-wrapper%20.paragraph-input%20%7B%5Cn%20%20%20%20%20%20width:%20100%25;%5Cn%20%20%20%20%20%20padding-right:%201.375rem;%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.random-input-btn-ctn%20%7B%5Cn%20%20%20%20%20%20margin-left:%200.25rem;%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20flex-direction:%20column;%5Cn%20%20%20%20%20%20justify-content:%20center;%5Cn%20%20%20%20%20%20align-items:%20center;%5Cn%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20margin-bottom:%20auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.auto-suggest-btn%20%7B%5Cn%20%20%20%20%20%20position:absolute;%5Cn%20%20%20%20%20%20top:0.125rem;%5Cn%20%20%20%20%20%20right:0.125rem;%5Cn%20%20%20%20%20%20cursor:pointer;%5Cn%20%20%20%20%20%20opacity:0.6;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.auto-suggest-btn:hover%20%7B%5Cn%20%20%20%20%20%20opacity:1;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.input-tip-btn%20%7B%5Cn%20%20%20%20%20%20cursor:pointer;%5Cn%20%20%20%20%20%20font-weight:bold;%5Cn%20%20%20%20%20%20margin-left:0.25rem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20@keyframes%20rotate%7B%5Cn%20%20%20%20%20%20to%20%7B%20transform:%20rotate(360deg);%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20.tabs-header%20%7B%5Cn%20%20%20%20%20%20display:%20flex;%5Cn%20%20%20%20%20%20font-size:%2070%25;%5Cn%20%20%20%20%20%20overflow:auto;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.tab%20%7B%5Cn%20%20%20%20%20%20padding:%200.25rem;%5Cn%20%20%20%20%20%20cursor:%20pointer;%5Cn%20%20%20%20%20%20background:%20var(--box-color,%20#ebebeb);%5Cn%20%20%20%20%20%20border-radius:%200.25rem;%5Cn%20%20%20%20%20%20margin:%200.25rem;%5Cn%20%20%20%20%20%20user-select:%20none;%5Cn%20%20%20%20%20%20min-width:%20max-content;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.active-tab%20%7B%5Cn%20%20%20%20%20%20background:%20var(--active-comment-channel-tab-color,%20#c6c6c6);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.tab-content%20%7B%5Cn%20%20%20%20%20%20display:%20none;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.active-content%20%7B%5Cn%20%20%20%20%20%20display:%20block;%5Cn%20%20%20%20%7D%5Cn%20%20%3C/style%3E%5Cn%5Cn%20%20%3Ch1%20id=%5C%22pageTitleEl48759084793%5C%22%20style=%5C%22font-size:1.2rem;%20margin-bottom:0.5rem;%5C%22%3E$%7Bsettings.pageTitle%7D%3C/h1%3E%20%5Cn%5Cn%20%20%3Cdiv%20id=%5C%22mainColumnEl85394739%5C%22%20style=%5C%22margin:0%20auto;%20max-width:1000px;%5C%22%3E%20%3C!--%20NOTE:%20if%20you%20change%201000px%20to%20something%20else,%20ctrl+f%20for%20mainColumnEl85394739%20and%20change%20the%20numImage-based%20stuff%20--%3E%5Cn%20%20%20%20%3Cdiv%20id=%5C%22userInputsCtn8462746262%5C%22%20style=%5C%22display:flex;%20padding:0.25rem;%20justify-content:center;%20flex-wrap:wrap;%5C%22%3E%5Cn%20%20%20%20%20%20$%7BuserInputsHtml%7D%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20$%7BdummyImageScriptTrigger%7D%5Cn%5Cn%20%20%20%20%3C!--%3Cdiv%20style=%5C%22margin:1rem%200;%20display:%20flex;%20align-items:%20center;%20justify-content:%20center;%5C%22%3E%5Cn%20%20%20%20%20%20%E2%9E%A1%EF%B8%8F %3Cbutton%20id=%5C%22generateButtonEl%5C%22%20style=%5C%22font-size:1.5rem;%5C%22%20onclick=%5C%22window.___generateButtonClickEvent746291937(event);%5C%22%3Egenerate%3C/button%3E %E2%AC%85%EF%B8%8F%5Cn%20%20%20%20%3C/div%3E--%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20id=%5C%22shareLinkOuterCtn2893827%5C%22%20style=%5C%22display:none;%20margin-bottom:1.5rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22shareSettingsBtn758374%5C%22%20onclick=%5C%22window.__generateSettingsShareLink084722()%5C%22%20style=%5C%22font-size:70%25;%5C%22%3E%F0%9F%94%97%20share%20these%20settings%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22shareLinkCtn83927376%5C%22%20style=%5C%22display:none;%20margin-top:0.5rem;%20font-size:80%25;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20style=%5C%22width:200px;%5C%22%20id=%5C%22shareSettingsLinkInputEl759307%5C%22%20disabled%3E%20%3Cbutton%20style=%5C%22min-width:80px;%5C%22%20onclick=%5C%22navigator.clipboard.writeText(shareSettingsLinkInputEl759307.value).then(r%20=%3E%20this.innerHTML='%E2%9C%85');%20setTimeout(()%20=%3E%20this.innerHTML='copy%20link',%202000);%5C%22%3Ecopy%20link%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20style=%5C%22font-size:80%25;%20opacity:0.7;%5C%22%3E(this%20link%20contains%20a%20snapshot%20of%20the%20above%20settings)%3C/div%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22margin:1rem%200;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:%20flex;align-items:%20center;justify-content:%20center;%5C%22%3E%3Cspan%20id=%5C%22leftClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3Eclick%20%E2%9E%A1 %3C/span%3E%3Cbutton%20id=%5C%22generateButtonEl%5C%22%20style=%5C%22font-size:1.5rem;%5C%22%20onclick=%5C%22window.___generateButtonClickEvent746291937(event);%5C%22%3Egenerate%3C/button%3E%3Cspan%20id=%5C%22rightClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3E %E2%AC%85%20click%3C/span%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22bottomClickHelperEl%5C%22%20style=%5C%22display:none;%5C%22%3E%3Cdiv%3E%E2%AC%86%3C/div%3E%3Cdiv%3Eclick%3C/div%3E%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%5Cn%20%20%20%20%3Cdiv%20id=%5C%22outputAreaEl%5C%22%20style=%5C%22margin-top:1rem;%20min-height:12rem;%20display:flex;%20flex-wrap:wrap;%20justify-content:center;%20align-items:center;%20padding:0.25rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cspan%3E$%7Bsettings.introMessage%20%7C%7C%20%5C%22%E2%86%91%20Set%20inputs%20and%20click%20%3Ci%3Egenerate%3C/i%3E%20to%20begin.%20%E2%86%91%5C%22%7D%3C/span%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22position:fixed;%20bottom:0.5rem;%20right:0.5rem;%20text-align:right;%20z-index:100;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20id=%5C%22feedbackCommentsCtn%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22feedbackBtn893745ykfuhd%5C%22%20onclick=%5C%22if(feedbackCommentsCtn.innerHTML.length%20===%200)%20%7B%20feedbackCommentsCtn.innerHTML=window.generateFeedbackCommentsHtml_8974sklfjosifo();%20this.innerHTML='%E2%9C%96%20close';%20%7D%20else%20%7B%20%20feedbackCommentsCtn.innerHTML='';%20%20this.innerHTML='%F0%9F%97%A8%EF%B8%8F%20feedback';%20%7D%5C%22%3E%F0%9F%97%A8%EF%B8%8F%20feedback%3C/button%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20id=%5C%22showSocialsButtonCtn9000274628%5C%22%20style=%5C%22$%7BsocialFeatures%20===%20'button'%20?%20''%20:%20'display:none;'%7D%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22showSocialsButton927514532%5C%22%20style=%5C%22margin-top:2rem;%20margin-bottom:0.5rem;%5C%22%20onclick=%5C%22window.__showSocialsButtonClickHandler98347938();%5C%22%3E%3Cdiv%20style=%5C%22padding:0.5rem;%5C%22%3E%F0%9F%92%AC%20show%20comments%20&%20gallery%20%F0%9F%96%BC%EF%B8%8F%3C/div%3E%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cinput%20id=%5C%22autoShowCheckbox84937483%5C%22%20style=%5C%22cursor:pointer;%5C%22%20type=%5C%22checkbox%5C%22%3E%3Cspan%20style=%5C%22margin-left:0.25rem;%20cursor:pointer;%5C%22%20onclick=%5C%22autoShowCheckbox84937483.checked=!autoShowCheckbox84937483.checked;%5C%22%3Eauto-show%20next%20time%3C/span%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%5Cn%20%20%20%20%3Cdiv%20id=%5C%22showHideGalleryAndCommentsButtonsCtn83728732671%5C%22%20style=%5C%22$%7BsocialFeatures%20===%20%5C%22button%5C%22%20%7C%7C%20socialFeatures%20===%20%5C%22disabled%5C%22%20?%20%5C%22display:none;%5C%22%20:%20%5C%22%5C%22%7D%20margin-top:1rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20onclick=%5C%22if(this.dataset.hidden)%20%7B%20this.dataset.hidden='';%20this.textContent%20=%20'hide%20comments';%20commentsPluginCtn654732.style.display%20=%20'';%20%7D%20else%20%7B%20this.dataset.hidden='1';%20this.textContent%20=%20'show%20comments';%20commentsPluginCtn654732.style.display%20=%20'none';%20%7D%5C%22%20data-hidden=%5C%22%5C%22%3Ehide%20comments%3C/button%3E%5Cn%20%20%20%20%20%20%3Cbutton%20onclick=%5C%22if(this.dataset.hidden)%20%7B%20this.dataset.hidden='';%20this.textContent%20=%20'hide%20gallery';%20imageGalleryCtn8569284.style.display%20=%20'';%20%7D%20else%20%7B%20this.dataset.hidden='1';%20this.textContent%20=%20'show%20gallery';%20imageGalleryCtn8569284.style.display%20=%20'none';%20%7D%5C%22%20data-hidden=%5C%22%5C%22%3Ehide%20gallery%3C/button%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%5Cn%20%20%20%20%3Cdiv%20id=%5C%22commentsPluginCtn654732%5C%22%20style=%5C%22padding:0.25rem;%20max-width:1000px;%20margin:0%20auto;%20margin-top:1rem;%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%5Cn%20%20%20%20%3Cdiv%20style=%5C%22position:fixed;%20bottom:0.5rem;%20left:0.5rem;%5C%22%3E%5Cn%20%20%20%20%20%20%3Cbutton%20id=%5C%22darkModeBtn_875979f948%5C%22%20style=%5C%22cursor:pointer;%5C%22%20onclick=%5C%22window.toggleManualDarkMode_jv83hb27igksf();%5C%22%3E%F0%9F%8C%83%3C/button%3E%5Cn%20%20%20%20%20%20%3Cdiv%20style=%5C%22display:inline-block;%5C%22%3E%5Bwindow.___fullscreenButton893479(%5C%22   %E2%87%B1   %5C%22,%20%5C%22   %E2%87%B2   %5C%22)%5D%3C/div%3E%5Cn%20%20%20%20%3C/div%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3C!--%20%3Cdiv%20style=%5C%22background-image:url(https://example.com/image.webp);%20filter:%20blur(1px);%20opacity:0.5;%20background-position:center;%20background-size:cover;%20z-index:-10;%20position:fixed;%20top:0;left:0;right:0;bottom:0;%5C%22%3E%3C/div%3E%20--%3E%5Cn%20%20%3Cdiv%20id=%5C%22clickCountBasedSocialDisplayNotifierEl%5C%22%20style=%5C%22font-size:80%25;%20max-width:800px;%20margin:0%20auto;%20padding:0.5rem;%20text-align:left;%20display:none;%5C%22%3E%5Cn%20%20%20%20%3Cdiv%20style=%5C%22background:var(--box-color);padding:%200.5rem;%5C%22%3E%3Cb%3ENote:%3C/b%3E%20The%20comments%20and%20gallery%20only%20appear%20after%20generating%20several%20batches%20of%20images.%20If%20you%20visit%20this%20page%20again%20later%20and%20don't%20see%20the%20gallery/comments,%20it's%20because%20your%20cookies/storage%20for%20this%20site%20got%20cleared%20for%20some%20reason,%20so%20you'd%20need%20to%20generate%20some%20more%20images.%20%3Cbutton%20style=%5C%22font-size:80%25;%5C%22%20onclick=%5C%22localStorage.theyKnowAboutClickCountBasedSocialDisplay='1';%20this.parentElement.style.display='none';%5C%22%3E%E2%9C%85%20got%20it%3C/button%3E%3C/div%3E%5Cn%20%20%3C/div%3E%5Cn%20%20%5Cn%20%20%3Cdiv%20id=%5C%22imageGalleryCtn8569284%5C%22%20style=%5C%22margin-top:1rem;%5C%22%3E%5Cn%20%20%20%20$%7B%5B%5C%22disabled%5C%22,%20%5C%22button%5C%22%5D.includes(socialFeatures)%20?%20%5C%22%5C%22%20:%20window.generateImageGalleryHtml358402048()%7D%5Cn%20%20%3C/div%3E%5Cn%20%20%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%5Cn%20%20%60.replaceAll(%5C%22%7B%5C%22,%20%5C%22%5C%5C%5C%5C%7B%5C%22).replaceAll(%5C%22%7D%5C%22,%20%5C%22%5C%5C%5C%5C%7D%5C%22);%5Cn%20%20%5Cn%20%20%5Cn%20%20%5CncreateCommentsTabs(items,%20opts)%20=%3E%20//%20items%20=%20%5B%7Bname,%20label,%20content%7D,%20%7Bname,%20label,%20content%7D,%20...%5D%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20ctn.innerHTML%20=%20%60%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabs-header%5C%22%3E%3C/div%3E%5Cn%20%20%20%20%3Cdiv%20class=%5C%22tabs-content%5C%22%3E%3C/div%3E%60;%5Cn%5Cn%20%20const%20tabsHeaderEl%20=%20ctn.querySelector('.tabs-header');%5Cn%20%20const%20tabsContentEl%20=%20ctn.querySelector('.tabs-content');%5Cn%5Cn%20%20//%20Function%20to%20handle%20tab%20click%5Cn%20%20function%20handleTabClick(event)%20%7B%5Cn%20%20%20%20let%20clickedTab%20=%20event.target;%5Cn%20%20%20%20if(!clickedTab.classList.contains('tab'))%20return;%5Cn%20%20%20%20%5Cn%20%20%20%20if(event.target.classList.contains('addCustomChannel'))%20%7B%5Cn%20%20%20%20%20%20let%20name%20=%20prompt(%5C%22Choose%20a%20channel%20name.%20Others%20will%20only%20see%20this%20channel%20if%20they%20also%20add%20it.%20Start%20the%20name%20with%20an%20exclaimation%20mark%20to%20remove%20an%20existing%20channel.%5C%22);%5Cn%20%20%20%20%20%20if(name)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20removeChannel%20=%20false;%5Cn%20%20%20%20%20%20%20%20if(name.startsWith(%5C%22!%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20removeChannel%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20name%20=%20name.slice(1);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20name%20=%20name.toLowerCase();%5Cn%20%20%20%20%20%20%20%20name%20=%20name.replace(/%5B%5Ea-z0-9%5C%5C-%5D/g,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(!name)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20alert(%5C%22Channel%20names%20can%20only%20contain%20lower-case%20letters,%20numbers%20and%20hyphens.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(name%20===%20%5C%22t2i-feedback%5C%22)%20return;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(!localStorage.__t2iFrameworkCustomChannels)%20localStorage.__t2iFrameworkCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__t2iFrameworkCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%20%20%20%20%20%20%20%20if(removeChannel)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20delete%20customChannels%5Bname%5D;%5Cn%20%20%20%20%20%20%20%20%20%20tabsHeaderEl.querySelector(%60%5Bdata-name='$%7Bname%7D'%5D%60).remove();%5Cn%20%20%20%20%20%20%20%20%20%20tabsContentEl.querySelector(%60%5Bdata-name='$%7Bname%7D'%5D%60).remove();%5Cn%20%20%20%20%20%20%20%20%20%20showTabByName(tabsHeaderEl.firstElementChild.dataset.name);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!customChannels%5Bname%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20customChannels%5Bname%5D%20=%20%7Bname:name,%20label:name%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20item%20=%20JSON.parse(JSON.stringify(customChannels%5Bname%5D));%5Cn%20%20%20%20%20%20%20%20%20%20%20%20item.content%20=%20createCustomTabContent(item);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20addTab(item);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20tabsHeaderEl.append(event.target);%20//%20move%20%5C%22+%5C%22%20button%20to%20the%20end%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20showTabByName(name);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20localStorage.__t2iFrameworkCustomChannels%20=%20JSON.stringify(customChannels);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20showTabByName(clickedTab.dataset.name);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20showTabByName(name)%20%7B%5Cn%20%20%20%20tabsHeaderEl.querySelectorAll('.tab').forEach(el%20=%3E%20el.classList.remove('active-tab'));%5Cn%20%20%20%20tabsHeaderEl.querySelector(%60.tab%5Bdata-name='$%7Bname%7D'%5D%60).classList.add('active-tab');%5Cn%20%20%20%20%5Cn%20%20%20%20tabsContentEl.querySelectorAll('.tab-content').forEach(el%20=%3E%20el.classList.remove('active-content'));%5Cn%20%20%20%20tabsContentEl.querySelector(%60.tab-content%5Bdata-name='$%7Bname%7D'%5D%60).classList.add('active-content');%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20addTab(item)%20%7B%5Cn%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20tab.className%20=%20'tab';%5Cn%20%20%20%20tab.textContent%20=%20item.label;%5Cn%20%20%20%20tab.dataset.name%20=%20item.name;%5Cn%5Cn%20%20%20%20const%20tabContent%20=%20document.createElement('div');%5Cn%20%20%20%20tabContent.className%20=%20'tab-content';%5Cn%20%20%20%20tabContent.innerHTML%20=%20item.content;%5Cn%20%20%20%20tabContent.dataset.name%20=%20item.name;%5Cn%20%20%20%20%5Cn%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%20%20tabsContentEl.appendChild(tabContent);%5Cn%20%20%20%20return%20%7Btab,%20tabContent%7D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20createCustomTabContent(item)%20%7B%5Cn%20%20%20%20let%20commentOptions%20=%20JSON.parse(JSON.stringify(item));%5Cn%20%20%20%20let%20defaultCommentOptions%20=%20window.___userSettings746291937.defaultCommentOptions;%5Cn%20%20%20%20for(let%20key%20of%20defaultCommentOptions.getPropertyNames)%20%7B%5Cn%20%20%20%20%20%20commentOptions%5Bkey%5D%20=%20defaultCommentOptions%5Bkey%5D;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(localStorage.forcedColorScheme)%20%7B%5Cn%20%20%20%20%20%20commentOptions.forceColorScheme%20=%20localStorage.forcedColorScheme;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20commentOptions.channel%20=%20commentOptions.name;%5Cn%20%20%20%20delete%20commentOptions.name;%5Cn%20%20%20%20return%20window.___commentsPlugin746291937(commentOptions);%5Cn%20%20%7D%5Cn%5Cn%20%20let%20i%20=%200;%5Cn%20%20for(let%20item%20of%20items)%20%7B%5Cn%20%20%20%20let%20%7Btab,%20tabContent%7D%20=%20addTab(item);%5Cn%20%20%20%20if(i%20===%200)%20%7B%5Cn%20%20%20%20%20%20tabContent.classList.add('active-content');%5Cn%20%20%20%20%20%20tab.classList.add('active-tab');%5Cn%20%20%20%20%7D%5Cn%20%20%20%20i++;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(opts.allowCustomChannels)%20%7B%5Cn%20%20%20%20//%20add%20user-specified%20custom%20channels:%5Cn%20%20%20%20if(!localStorage.__t2iFrameworkCustomChannels)%20localStorage.__t2iFrameworkCustomChannels%20=%20%5C%22%7B%7D%5C%22;%5Cn%20%20%20%20let%20customChannels%20=%20%7B%7D;%5Cn%20%20%20%20try%20%7B%20customChannels%20=%20JSON.parse(localStorage.__t2iFrameworkCustomChannels)%20%7D%20catch(e)%20%7B%20console.error(%5C%22Failed%20to%20parse%20custom%20channels%20from%20localStorage:%5C%22,%20e);%20%7D%5Cn%20%20%20%20for(let%20item%20of%20Object.values(customChannels))%20%7B%5Cn%20%20%20%20%20%20let%20itemCopy%20=%20JSON.parse(JSON.stringify(item));%5Cn%20%20%20%20%20%20itemCopy.content%20=%20createCustomTabContent(itemCopy);%5Cn%20%20%20%20%20%20addTab(itemCopy);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20//%20add%20the%20%5C%22+%5C%22%20button:%5Cn%20%20%20%20const%20tab%20=%20document.createElement('div');%5Cn%20%20%20%20tab.className%20=%20'tab%20addCustomChannel';%5Cn%20%20%20%20tab.textContent%20=%20%5C%22+%5C%22;%5Cn%20%20%20%20tab.style.cssText%20=%20%5C%22min-width:1.4rem;%5C%22;%5Cn%20%20%20%20tabsHeaderEl.appendChild(tab);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20tabsHeaderEl.addEventListener('click',%20handleTabClick);%5Cn%5Cn%20%20return%20ctn;%5Cn%20%20%5Cn%20%20%5Cn%22,%22imports%22:%5B%22ai-text-plugin%22,%22comments-plugin%22,%22fullscreen-button-plugin%22,%22select-leaf-plugin%22,%22text-to-image-plugin%22,%22upload-plugin%22%5D,%22lastEditTime%22:1714621982867,%22found%22:true%7D,%7B%22name%22:%22t2i-styles%22,%22modelText%22:%22//%20note%20that%20%60input%60%20is%20a%20global%20variable%20(i.e.%20%60input%60%20is%20%60window.input%60),%20which%20is%20created%20by%20t2i-framework-plugin%5Cn//%20see%20here%20for%20an%20example%20generator%20that%20imports%20these%20styles:%20https://perchance.org/ai-character-generator#edit%5Cn%5Cn//%20style%20tester:%20https://perchance.org/prompt-style-tester%5Cn%5Cn$output%5Cn%20%20Painted%20Anime%5Cn%20%20%20%20prompt%20//%20this%20style%20is%20biased%20towards%20female%20characters%20due%20to%20the%20biases%20of%20the%20artists%20mentioned,%20so%20we%20alter%20the%20description%20if%20'male'%20is%20mentioned%20to%20boost%20'maleness'%20and%20supress%20'femaleness'%5Cn%20%20%20%20%20%20(%5B/%5C%5Cb(male%7Cman)%5C%5Cb/i.test(input.description)%20?%20input.description.replace(/%5C%5Cb(male%7Cman)%5C%5Cb/i,%20%5C%22(male,%20masculine,%20masc,%20male)%5C%22)%20:%20input.description%5D),%20art%20by%20atey%20ghailan,%20painterly%20anime%20style%20at%20pixiv,%20art%20by%20kantoku,%20in%20art%20style%20of%20redjuice/nec%C3%B6mi/rella/tiv%20pixiv%20collab,%20your%20name%20anime%20art%20style,%20masterpiece%20digital%20painting,%20exquisite%20lighting%20and%20composition,%20inspired%20by%20wlop%20art%20style,%208k,%20sharp,%20very%20detailed,%20high%20resolution,%20illustration%20%5E2%5Cn%20%20%20%20%20%20painterly%20anime%20artwork,%20%5Binput.description%5D,%20masterpiece,%20fine%20details,%20breathtaking%20artwork,%20painterly%20art%20style,%20high%20quality,%208k,%20very%20detailed,%20high%20resolution,%20exquisite%20composition%20and%20lighting%5Cn%20%20%20%20negative%5Cn%20%20%20%20%20%20(worst%20quality,%20low%20quality,%20blurry:1.3),%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5B/%5C%5Cbmale%5C%5Cb/i.test(input.description)%20?%20%5C%22,%20female,%20feminine,%20fem,%20female%5C%22%20:%20%5C%22%5C%22%5D%5Cn%20%20%20%20%20%20%5Binput.negative%5D,%20(worst%20quality,%20low%20quality,%20blurry:1.3),%20black%20and%20white,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20bad%20art,%20bad%20anatomy,%20bad%20lighting,%20disfigured,%20faded,%20blurred%20face%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:100,%20painting:100,%20paintedAnime:100,%20drawing:55,%20cartoon:50%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Casual%20Photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20casual%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20bad%20lighting,%20high%20production%20value,%20unnatural%20studio%20lighting,%20commercial%20photoshoot,%20photoshopped,%20terrible%20photo,%20disfigured%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:98,%20casualPhoto:100,%20portrait:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Cinematic%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cinematic%20shot,%20dynamic%20lighting,%2075mm,%20Technicolor,%20Panavision,%20cinemascope,%20sharp%20focus,%20fine%20details,%208k,%20HDR,%20realism,%20realistic,%20key%20visual,%20film%20still,%20cinematic%20color%20grading,%20depth%20of%20field%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20lighting,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20holding%20camera,%20bad%20art,%20bad%20angle,%20boring,%20low-resolution,%20worst%20quality,%20bad%20composition,%20disfigured%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:100,%20portrait:85,%20render:70,%20cinematic:100%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20%20%20%20%20genre%5Cn%20%20%20%20%20%20%20%20adventure%20=%20,%20adventure%5Cn%20%20%20%20%20%20%20%20b-horror%20=%20,%20b-horror%20film%20screencap%5Cn%20%20%20%20%20%20%20%20epic%20fantasy%20=%20,%20epic%20fantasy%5Cn%20%20%20%20%20%20%20%20sci-fi%20=%20,%20sci-fi%5Cn%20%20%20%20%20%20%20%20film%20noir%20=%20,%20film%20noir%5Cn%20%20%20%20%20%20%20%20horror%20=%20,%20horror%5Cn%20%20%20%20%20%20%20%20indie%20=%20,%20indie%20film%20screencap%5Cn%20%20%20%20%20%20%20%20western%20=%20,%20western,%20wild%20west%5Cn%20%20%20%20%20%20%20%20thriller%20=%20,%20thriller%5Cn%20%20Digital%20Painting%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20breathtaking%20digital%20art,%20trending%20on%20artstation,%20by%20atey%20ghailan,%20by%20greg%20rutkowski,%20by%20greg%20tocchini,%20by%20james%20gilleard,%208k,%20high%20resolution,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20signature%20watermark%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:90,%20landscape:70,%20digitalPainting:100,%20drawing:60%7D)%5D%5Cn%20%20Concept%20Art%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20concept%20art,%20digital%20art,%20illustration,%20inspired%20by%20wlop%20style,%208k,%20fine%20details,%20sharp,%20very%20detailed,%20high%20resolution,%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20worst%20quality,%20blurry%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:50,%20landscape:70%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20league%20of%20legends%20=%20,%20league%20of%20legends%20style%20concept%20art%5Cn%20%20%20%20%20%20%20%20epic%20fantasy%20=%20,%20epic%20fantasy%20concept%20art%20by%20noah%20bradley%5Cn%20%20%20%20%20%20%20%20sci-fi%20=%20,%20sci-fi%20concept%20art%5Cn%20%20%20%20%20%20%20%20horror%20=%20,%20horror%20concept%20art%5Cn%20%20%20%20%20%20%20%20western%20=%20,%20western,%20wild%20west%20concept%20art%5Cn%20%203D%20Disney%20Character%5Cn%20%20%20%20prompt%20=%203D%20cartoon%20Disney%20character%20portrait%20render.%20%5Binput.description%5D,%20bokeh,%204k,%20highly%20detailed,%20Pixar%20render,%20CGI%20Animation,%20Disney,%20cute%20big%20circular%20reflective%20eyes,%20dof,%20(cinematic%20film),%20Disney%20realism,%20subtle%20details,%20breathtaking%20Pixar%20short,%20fine%20details,%20close%20up,%20sharp%20focus,%20HDR,%20Disney-style%20octane%20render,%20incredible%20composition,%20superb%20lighting%20and%20detail,%20%5Binput.description%5D%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20worst%20quality,%20poorly%20drawn,%20bad%20art,%20boring,%20deformed,%20bad%20composition,%20crappy%20artwork,%20bad%20lighting%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:95,%20render:80,%20portrait:75,%20cartoon:90%7D)%5D%5Cn%20%202D%20Disney%20Character%5Cn%20%20%20%20prompt%20=%202D%20cartoon%20Disney%20character%20digital%20art%20of%20%5Binput.description%5D.%20superb%20linework,%20classic%202D%20Disney%20style%20art,%20close-up,%20inspired%20by%20the%20art%20styles%20of%20Glen%20Keane%20and%20Aaron%20Blaise,%20Disney-style%20character%20concept%20with%20a%20Disney-style%20face,%20(trending%20on%20artstation),%20Disney-style%20version%20of%20%5Binput.description%5D%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%203D%20render,%20bad%203D%20shadowing,%20worst%20quality,%20poorly%20drawn,%20low-resolution%20render,%20bad%20colors,%20a%20photo,%20terrible%20art,%20text,%20logo,%20bad%20composition,%20bad%20lighting,%20disfigured,%20deformed,%20bad%20anatomy,%20crappy%20educational%20infographic%20cartoon,%20bad%203D%20render,%20black%20and%20white%20photo%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:90,%20portrait:75,%20cartoon:100,%20comic:80,%20drawing:75%7D)%5D%5Cn%20%20Disney%20Sketch%5Cn%20%20%20%20prompt%20=%20Glen%20Keane%20character%20concept%20art%20(black%20and%20white)%20pencil%20sketch%20of%20%5Binput.description%5D.%20(rough%20pencil%20sketch%20by%20Glen%20Keane:1.2),%20rough%20pencil%20sketch,%20close%20up,%20loose%20Disney-style%20character%20concept%20art%20sketch,%20(nice%20sketchy%20pencil%20strokes),%20Disney%20character%20design%20sketch,%20pencil%20texture,%20a%20concept%20art%20pencil%20sketch%20of%20%5Binput.description%5D,%20(by%20Glen%20Keane:1.3)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20a%20photo,%20photorealistic%20style,%20with%20color,%20(a%20bad%20photo),%20bad%20digital%20art,%20bad%203D%20render,%20gradient,%20overly%20detailed,%20high%20contrast,%20bloom,%20a%20color%20photo,%20smooth%20shading,%20hilariously%20bad%20drawings,%20bad%20anatomy,%20bad%20art,%203D,%20a%20photo,%20soft%20shadows,%20lot%20of%20color%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:90,%20cartoon:85,%20sketch:80,%20comic:80,%20drawing:70%7D)%5D%5Cn%20%20Concept%20Sketch%5Cn%20%20%20%20prompt%20=%20black%20and%20white%20technical%20drawing%20showcasing%20%7Ba%7D%20%5Binput.description%5D,%20annotation%20details,%20masterpiece%20black%20and%20white,%20pencil%20strokes,%20annotated%20technical%20concept%20art%20sketch,%20pencil%20texture%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bsketch:75,%20comic:50,%20drawing:75%7D)%5D%20%5Cn%20%20Painterly%5Cn%20%20%20%20prompt%20=%20painterly%20digital%20painting,%20%5Binput.description%5D,%20digital%20painting%20by%20Ilya%20Kuvshinov%20with%20painterly%20brush%20strokes,%20by%20Ilya%20Kuvshinov,%20painterly%20masterpiece%5Cn%20%20%20%20negative%20=%20brush,%20%5Binput.negative%5D,%20bad%203D%20render,%20(holding%20paintbrush),%20easel,%20bad%20photo,%20bad%20art,%20boring,%20bad%203D%20render%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:85,%20landscape:65,%20digitalPainting:95,%20drawing:45%7D)%5D%5Cn%20%20Oil%20Painting%5Cn%20%20%20%20prompt%20=%20breathtaking%20alla%20prima%20oil%20painting,%20%5Binput.description%5D,%20close%20up,%20(alla%20prima%20style:1.3),%20oil%20on%20linen,%20painterly%20oil%20on%20canvas,%20(painterly%20style:1.3),%20exquisite%20composition%20and%20lighting,%20modern%20painterly%20masterpiece,%20by%20alexi%20zaitsev,%20award-winning%20painterly%20alla%20prima%20oil%20painting%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20framed,%20faded%20colors,%20terrible%20photo,%20bad%20composition,%20hilariously%20bad%20drawing,%20bad%20photo,%20bad%20anatomy,%20extremely%20high%20contrast,%20worst%20quality,%20watermarked%20signature,%20bad%20colors,%20deformed,%20amputee,%20washed%20out,%20glare,%20boring%20colors,%20bad%20crayon%20drawing%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:87,%20oilPainting:100,%20landscape:60,%20portrait:65,%20drawing:40%7D)%5D%5Cn%20%20Oil%20Painting%20-%20Realism%5Cn%20%20%20%20prompt%20=%20breathtaking%20oil%20painting,%20%5Binput.description%5D,%20photorealistic%20oil%20painting,%20by%20charlie%20bowater,%20fine%20details,%20by%20wlop,%20trending%20on%20artstation,%20very%20detailed%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20worst%20quality%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:87,%20oilPainting:95,%20landscape:60,%20portrait:70,%20drawing:40%7D)%5D%5Cn%20%20Oil%20Painting%20-%20Old%5Cn%20%20%20%20prompt%20=%20(%5Binput.description%5D)%20(Oil%20painting)%20(by%20Jean-Fran%C3%A7ois%20Millet),%20(by%20Gustave%20Courbet),%20(by%20Jules%20Breton),%20close%20up%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20frame,%20(badly%20drawn%20hands),%20extra%20limbs,%20extra%20fingers,%20bad%20anatomy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:85,%20oilPainting:90,%20landscape:55,%20portrait:65,%20drawing:35%7D)%5D%5Cn%20%20Professional%20Photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20%7Bsharp%7Csoft%7D%20focus,%20depth%20of%20field,%208k%20photo,%20HDR,%20professional%20lighting,%20taken%20with%20Canon%20EOS%20R5,%2075mm%20lens%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20worst%20quality,%20bad%20lighting,%20cropped,%20blurry,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20bad%20art,%20bad%20angle,%20boring,%20low-resolution,%20worst%20quality,%20bad%20composition,%20terrible%20lighting,%20bad%20anatomy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:95,%20portrait:60%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Anime%5Cn%20%20%20%20prompt%20=%20(anime%20art%20of%20%5Binput.description%5D:1.2),%20masterpiece,%204k,%20best%20quality,%20anime%20art%5Cn%20%20%20%20negative%20=%20(worst%20quality,%20low%20quality:1.3),%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20hilariously%20bad%20drawing,%20bad%203D%20render%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BbasicAnime:100,%20anime:60,%20drawing:50,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Drawn%20Anime%5Cn%20%20%20%20prompt%20=%20digital%20art%20drawing,%20illustration%20of%20(%5Binput.description%5D),%20anime%20drawing/art,%20bold%20linework,%20illustration,%20cel%20shaded,%20painterly%20style,%20digital%20art,%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20boring%20flat%20infographic,%20oversaturated,%20bad%20photo,%20terrible%203D%20render,%20bad%20anatomy,%20worst%20quality,%20greyscale,%20black%20and%20white,%20disfigured,%20deformed,%20glitch,%20cross-eyed,%20lazy%20eye,%20ugly,%20deformed,%20distorted,%20glitched,%20lifeless,%20low%20quality,%20bad%20proportions%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:60,%20drawing:85,%20drawnAnime:100,%20cartoon:40%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Cute%20Anime%5Cn%20%20%20%20prompt%20=%20(((adorable,%20cute,%20kawaii)),%20%5Binput.description%5D,%20cute%20moe%20anime%20character%20portrait,%20adorable,%20featured%20on%20pixiv,%20kawaii%20mo%C3%A9%20masterpiece,%20cuteness%20overload,%20very%20detailed,%20sooooo%20adorable!!!,%20absolute%20masterpiece%5Cn%20%20%20%20negative%20=%20(worst%20quality,%20low%20quality:1.3),%20%5Binput.negative%5D,%20worst%20quality,%20ugly,%203D,%20photograph,%20bad%20art,%20blurry,%20boring%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:55,%20drawing:50,%20cuteAnime:100,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Soft%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20anime%20masterpiece,%20soft%20lighting,%20intricate,%20highly%20detailed,%20pixiv,%20anime%20art,%204k,%20art%20from%20your%20name%20anime,%20garden%20of%20words%20style%20art,%20high%20quality%5Cn%20%20%20%20negative%20=%20(worst%20quality,%20low%20quality:1.3),%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:50,%20drawing:50,%20cartoon:30%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20Fantasy%20Painting%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20d&d,%20fantasy,%20highly%20detailed,%20digital%20painting,%20artstation,%20sharp%20focus,%20fantasy%20art,%20illustration,%208k,%20in%20the%20style%20of%20greg%20rutkowski%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:50,%20landscape:80,%20fantasy:80%7D)%5D%5Cn%20%20Fantasy%20Landscape%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20fantasy%20matte%20painting,%20absolute%20masterpiece,%20detailed%20matte%20painting%20by%20andreas%20rocha%20and%20greg%20rutkowski,%20by%20Brothers%20Hildebrandt,%20superb%20composition,%20vivid%20fantasy%20art,%20breathtaking%20fantasy%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20faded,%20blurry,%20bad%20art,%20boring%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20poster:30,%20coverArt:50,%20vintage:30,%20landscape:90,%20fantasy:20%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BlandscapeModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BlandscapeModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BlandscapeModifiers.effect%5D%5Cn%20%20Fantasy%20Portrait%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20d&d,%20fantasy,%20highly%20detailed,%20digital%20painting,%20artstation,%20sharp%20focus,%20fantasy%20art,%20character%20art,%20illustration,%208k,%20art%20by%20artgerm%20and%20greg%20rutkowski%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:50,%20fantasy:70,%20portrait:75%7D)%5D%5Cn%20%20Studio%20Ghibli%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20(studio%20ghibli%20style%20art:1.3),%20sharp,%20very%20detailed,%20high%20resolution,%20inspired%20by%20hayao%20miyazaki,%20anime,%20art%20from%20ghibli%20movie%5Cn%20%20%20%20negative%20=%20(worst%20quality,%20low%20quality:1.3),%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:50,%20cartoon:50%7D)%5D%5Cn%20%2050s%20Enamel%20Sign%5Cn%20%20%20%20prompt%20=%2050s%20enamel%20sign%20of%20%5Binput.description%5D,%2050s%20advert%20enamel%20sign,%20masterpiece,%20authentic%20vintage%20enamel%20sign%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:85%7D)%5D%5Cn%20%20Vintage%20Comic%5Cn%20%20%20%20prompt%20=%20comic%20book%20style%20art%20of%20%5Binput.description%5D,%20(drawing,%20by%20Dave%20Stevens,%20by%20Adam%20Hughes,%201940's,%201950's:1.2),%20hand-drawn,%20color,%20high%20resolution,%20best%20quality,%20closeup%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20terrible%20photoshop,%20low%20contrast,%20disfigured,%20poorly%20drawn,%20deformed,%20tiled,%20cropped,%20framed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:90,%20cartoon:70%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20effect%5Cn%20%20%20%20%20%20%20%20retrofuturism%20=%20,%20(retrofuturism,%20atompunk)%5Cn%20%20%20%20%20%20%20%20gritty%20noir%20=%20,%20(gritty%20noir)%5Cn%20%20%20%20%20%20%20%20pop%20art%20=%20,%20(pop%20art%20style)%5Cn%20%20%20%20%20%20%20%20cyberpunk%20=%20,%20(cyberpunk%20aesthetic)%5Cn%20%20%20%20%20%20%20%20steampunk%20=%20,%20(steampunk)%5Cn%20%20%20%20%20%20%20%20watercolor%20=%20,%20(watercolor%20wash)%5Cn%20%20%20%20%20%20%20%20sketchy%20ink%20=%20,%20sketchy%20ink%20work%5Cn%20%20%20%20%20%20%20%20manga%20fusion%20=%20,%20(manga%20fusion)%5Cn%20%20%20%20%20%20%20%20psychedelic%20=%20,%20psychedelic%20imagery%5Cn%20%20%20%20%20%20%20%20pulp%20magazine%20=%20,%20pulp%20magazine%20look%5Cn%20%20%20%20%20%20%20%20heroic%20proportions%20=%20,%20heroic%20proportions%5Cn%20%20Franco-Belgian%20Comic%5Cn%20%20%20%20prompt%20=%20franco-belgian%20color%20comic%20about%20%5Binput.description%5D,%20bande%20dessin%C3%A9e,%20franco-belgian%20comic%20panel,%20masterpiece,%20breathtaking%20composition,%20intricate,%20detailed,%20best%20quality,%20close-up%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20framed%20blurry%20crappy%20photo,%20overexposed,%20worst%20quality,%20border,%20deformed%20horror,%20overly%20faded%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:75,%20comic:85,%20cartoon:75%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20single-panel%20=%20,%20splash%20panel,%20full%20cover%20image%5Cn%20%20%20%20%20%20%20%20multi-panel%20=%20,%20multi-panel%20comic%20book%20page,%20comic%20panel%20layout%5Cn%20%20%20%20%20%20%20%20cyberpunk%20=%20,%20(cyberpunk%20aesthetic)%5Cn%20%20%20%20%20%20%20%20steampunk%20=%20,%20(steampunk)%5Cn%20%20%20%20%20%20%20%20manga%20fusion%20=%20,%20(manga%20fusion)%5Cn%20%20%20%20%20%20%20%20psychedelic%20=%20,%20psychedelic%20imagery%5Cn%20%20%20%20%20%20%20%20pulp%20magazine%20=%20,%20pulp%20magazine%20look%5Cn%20%20%20%20%20%20%20%20heroic%20proportions%20=%20,%20heroic%20proportions%5Cn%20%20Tintin%20Comic%5Cn%20%20%20%20prompt%20=%20color%20comic%20panel%20in%20the%20style%20of%20Herg%C3%A9%20about%20%5Binput.description%5D,%20by%20Herg%C3%A9,%20tintin%20style,%20french%20comic%20panel,%20franco-belgian%20style,%20close-up,%20masterpiece,%20high-resolution%20Herg%C3%A9%20style%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20blurry,%20framed%20edge%20border,%20text,%20overexposed,%20bad%20anatomy,%20deformed,%20disfigured,%20blur,%20horror,%20dead%20eyes,%20boring,%20faded,%20(worst%20quality,%20low%20quality:1.2)%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:77,%20comic:87,%20cartoon:77%7D)%5D%5Cn%20%20//%20Vintage%20Comic%5Cn%20%20//%20%20%20prompt%20=%20comic%20book%20style%20art%20of%20%5Binput.description%5D,%20(drawing%20by%20Jack%20Kirby,%20Steve%20Ditko%20art,%201940's,%201950's:1.2),%20closeup,%20color,%20vintage%20masterpiece,%20best%20quality%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20worst%20quality,%20low%20resolution,%20fuzzy,%20jpeg%20compression%20artifacts,%20blurry,%20low%20quality%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:90,%20cartoon:70%7D)%5D%5Cn%20%20//%2090s%20Comic%5Cn%20%20//%20%20%20prompt%20=%20%5Binput.description%5D,%20(90s%20comic%20book%20artwork),%20colored%20comic%20book%20panel,%20classic%2090s%20style,%20masterpiece%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20greyscale,%20blurry,%20bad%203D%20render,%20crappy%203D%20art,%20barcode,%20logo,%20bad%20photo%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:80%7D)%5D%5Cn%20%20//%2090s%20Superhero%5Cn%20%20//%20%20%20prompt%20=%20%5Binput.description%5D,%20(90s%20comic%20book%20artwork),%20colored%20comic%20book%20panel,%20classic%2090s%20style,%20masterpiece,%20art%20by%20Greg%20Capullo,%20art%20by%20Jim%20Lee,%20art%20by%20Todd%20McFarlane%5Cn%20%20//%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20greyscale,%20blurry,%20bad%203D%20render,%20crappy%203D%20art,%20barcode,%20logo,%20bad%20photo%5Cn%20%20//%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20comic:80%7D)%5D%5Cn%20%20Medieval%5Cn%20%20%20%20prompt%20=%20medieval%20illuminated%20manuscript%20picture%20of%20%5Binput.description%5D,%20medieval%20illuminated%20manuscript%20art,%20masterpiece%20medieval%20color%20illustration,%2016th%20century,%208k%20high-resolution%20scan%20of%2016th%20century%20illuminated%20manuscript%20painting,%20detailed%20medieval%20masterpiece,%20close-up%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20worst%20quality,%20blurry%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80,%20painting:70,%20portrait:40%7D)%5D%5Cn%20%20Pixel%20Art%5Cn%20%20%20%20prompt%20=%20%5Binput.description.length%20%3E%2040%20?%20%5C%22(pixel%20art),%20%5C%22%20:%20%5C%22%5C%22%5D%5Binput.description%5D,%20best%20pixel%20art,%20neo-geo%20graphical%20style,%20retro%20nostalgic%20masterpiece,%20128px,%2016-bit%20pixel%20art%20%5Binput.description.length%20%3C%2010%20?%20%5C%22of%20%5C%22+input.description%20:%20%5C%22%5C%22%5D,%202D%20pixel%20art%20style,%20adventure%20game%20pixel%20art,%20inspired%20by%20the%20art%20style%20of%20hyper%20light%20drifter,%20masterful%20dithering,%20superb%20composition,%20beautiful%20palette,%20exquisite%20pixel%20detail%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20glitched,%20deep%20fried,%20jpeg%20artifacts,%20out%20of%20focus,%20gradient,%20soft%20focus,%20low%20quality,%20poorly%20drawn,%20blur,%20grainy%20fabric%20texture,%20text,%20bad%20art,%20boring%20colors,%20blurry%20platformer%20screenshot%5Cn%20%20%20%20meta:tags%20=%20%5B(%7BpixelArt:90,%20vintage:70%7D)%5D%5Cn%20%20%20%20//%20randomPrompt%20=%20%7Bmermaid%7Cgoblin%7D%5Cn%20%20Furry%20-%20Oil%5Cn%20%20%20%20prompt%20=%20(%5Binput.description%5D:1.3),%20crisp%20vibrant%20detailed%20soft%20painterly%20digital%20art,%20volumetric%20lighting,%20natural%20lighting,%20realistic%20lighting,%20vibrant%20colors,%20crisp%20oil%20painting,%20painterly%20realism,%20depth%20of%20field,%20subtle%20soft%20details,%20vivid,%20fresh,%20striking,%20by%20chunie,%20by%20darkgem,%20by%20honovy,%20by%20zaush,%20by%20anhes,%20by%20puinkey,%20by%20caraid,%20by%20dagasi,%20by%20taranfiddler,%20by%20atey%20ghailan,%20by%20MilletGustave,%20by%20Curbet,%20Charlie%20Bowater,%20lol%20art%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20blurry,%20faded,%20antique,%20muted%20colors,%20greyscale,%20boring%20colors,%20flat,%20bad%20photo,%20terrible%203D%20render,%20bad%20anatomy,%20worst%20quality,%20greyscale,%20black%20and%20white,%20disfigured,%20deformed,%20glitch,%20cross-eyed,%20lazy%20eye,%20ugly,%20deformed,%20distorted,%20glitched,%20lifeless,%20low%20quality,%20bad%20proportions,%20watermark,%20signature%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:100%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%5Cn%20%20Furry%20-%20Cinematic%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cinematic%20shot,%20dynamic%20lighting,%2075mm,%20Technicolor,%20Panavision,%20cinemascope,%20sharp%20focus,%20fine%20details,%208k,%20HDR,%20realism,%20realistic,%20key%20visual,%20film%20still,%20cinematic%20color%20grading,%20depth%20of%20field,%20(anthro:0.1)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20lighting,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20holding%20camera,%20bad%20art,%20bad%20angle,%20boring,%20low-resolution,%20worst%20quality,%20bad%20composition,%20disfigured%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:97,%20photo:60,%20portrait:40,%20render:75,%20cinematic:65%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20effect%20=%20%5BfurryModifiers.effect%5D%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20photo%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Furry%20-%20Painted%5Cn%20%20%20%20prompt%20=%20anthro%20%5Binput.description%5D%20digital%20art,%20masterpiece,%204k,%20fine%20details%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20worst%20quality,%20bad%20composition,%20bad%20lighting,%20bad%20colors,%20small%20eyes,%20low%20quality,%20bad%20art,%20poorly%20drawn,%20deformed,%20bad%203D%20render,%20boring,%20lifeless,%20deformed,%20ugly,%20low%20resolution%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:96%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%5Cn%20%20Furry%20-%20Drawn%5Cn%20%20%20%20prompt%20=%20anthro%20%5Binput.description%5D%20illustration,%20hand-drawn,%20bold%20linework,%20anthro%20illustration,%20cel%20shaded,%204k,%20fine%20details,%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20photo,%20terrible%203D%20render,%20bad%20anatomy,%20worst%20quality,%20greyscale,%20black%20and%20white,%20disfigured,%20deformed,%20glitch,%20cross-eyed,%20lazy%20eye,%20ugly,%20deformed,%20distorted,%20glitched,%20lifeless,%20low%20quality,%20bad%20proportions%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bfurry:95%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BfurryModifiers%5D%20%5Cn%20%20Cute%20Figurine%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20figurine,%20modern%20Disney%20style,%20octane%20render,%20chibi%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdisney:20,%20emoji:60%7D)%5D%5Cn%20%203D%20Emoji%5Cn%20%20%20%20prompt%20=%20masterpiece%20((%5Binput.description%5D))%20cartoon%20emoji%20concept%20render,%20(close-up:1.3),%20facing%20forward,%20(matte),%20emoji%20render%20trending%20on%20artstation,%20noto%20color%20emoji,%20app%20icon,%20joypixels,%20simple%20design,%20new%20iOS%2016.4%20(((%5Binput.description%5D)))%20emoji%20render,%20(simple%20background:1.2),%20(centered:1.2),%20masterpiece,%20telegram%20sticker,%20clash%20of%20clans%20character%20concept,%20(looking%20at%20camera),%20crisp%20render,%20sharp%20focus,%20simple%20cartoon%20design,%204k,%20sharp%20focus,%20an%20emoji%20with%20cartoon%20proportions,%20masterpiece%20emoji-style%20figurine%20render,%20transparent%20background%20png%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20framed,%20inset,%20border,%20glare,%20blurry,%20out%20of%20focus,%20shiny,%20(on%20pedestal:1.2),%20on%20platform,%20with%20base,%20gradient%20background,%20off-center,%20casting%20shadow,%20((deformed,%20disfigured)),%20glitchy,%20vector%20art,%20text,%20signature,%20bad%20anatomy,%20messed%20up,%20bad%20art,%20gradient%20background,%20complex%20background,%20blurry,%20worst%20quality,%20low%20resolution,%20messy,%20complex,%20gradient%20background,%20bad%20lighting%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bemoji:90%7D)%5D%5Cn%20%20Illustration%5Cn%20%20%20%20prompt%20=%20breathtaking%20illustration%20of%20%5Binput.description%5D,%20(illustration:1.3),%20masterpiece,%20breathtaking%20illustration%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20bad%203D%20render,%20bad%20composition,%20bad%20photo,%20worst%20quality%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:100,%20drawing:75%7D)%5D%5Cn%20%20Flat%20Illustration%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20illustration,%20flat,%202D,%20vector%20art,%20masterpiece,%20made%20with%20adobe%20illustrator,%20behance%20competition%20winner,%20trending%20on%20dribble,%204k,%20high%20resolution,%20crisp%20lines%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20art,%20children's%20crayon%20drawing,%20worst%20quality,%20blurry,%20blur,%20jpeg%20artifacts,%20compression%20artifacts,%20text,%20worst%20quality,%20noise,%20messy,%20low%20resolution%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Billustration:85,%20drawing:40%7D)%5D%5Cn%20%20Watercolor%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20(watercolor),%20high%20resolution,%20intricate%20details,%204k,%20wallpaper,%20concept%20art,%20watercolor%20on%20textured%20paper%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30%7D)%5D%5Cn%20%201990s%20Photo%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%2090s%20home%20video,%20nostalgic%2090s%20photo,%20taken%20with%20kodak%20disposable%20camera%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20blurry,%20blur,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bvintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%20%5Cn%20%20%20%20%20%20color%20=%20%5BphotoModifiers.color%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201980s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2080s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%2080s%20photo%20with%20film%20grain,%20Kodacolor%20II%2080s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2080s%20photo%20with%20wear%20and%20tear%20and%20minor%20creasing%20and%20scratches,%20vintage%20color%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:90,%20portrait:72%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201970s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2070s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201970s%20photo%20with%20film%20grain,%2070s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2070s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201960s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2060s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201960s%20photo%20with%20film%20grain,%2060s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%2060s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201950s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%2050s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201950s%20photo%20with%20film%20grain,%201950s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201950s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201940s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201940s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201940s%20photo%20with%20film%20grain,%201940s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201940s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201930s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201930s%20photo,%20%5Binput.description%5D,%20grainy%20photograph,%201930s%20photo%20with%20film%20grain,%201930s%20photo%20with%20vignetting,%20retro,%20r/OldSchoolCool,%201930s%20photo,%20vintage%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%201920s%20Photo%5Cn%20%20%20%20prompt%20=%20famous%20vintage%201920s%20photo,%20%5Binput.description%5D,%201920s%20photo,%20restored%20photograph,%20%7Bsepia%7Cblack%20and%20white%7D,%20historical%20archive%20photo%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bphoto:30,%20vintage:80%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20shot%20=%20%5BphotoModifiers.shot%5D%5Cn%20%20%20%20%20%20effect%20=%20%5BphotoModifiers.effect%5D%5Cn%20%20Vintage%20Pulp%20Art%5Cn%20%20%20%20prompt%20=%20(((1970s%20vintage%20pulp%20art))),%20%5Binput.description%5D,%20vintage%20pulp%20art,%20by%20Earle%20K.%20Bergey,%20by%20Kelly%20Freas,%20by%20Alex%20Schomburg,%20by%20H.%20J.%20Ward,%20glossy%20pulp%20art,%20Amazing%20Stories,%20Weird%20Tales,%208k,%20high%20resolution,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20text,%20cropped,%20bad%20art,%20deformed,%20worst%20quality,%20watermark,%20text%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20poster:30,%20coverArt:50,%20vintage:60,%20comic:40,%20cartoon:50%7D)%5D%5Cn%20%2050s%20Infomercial%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%201950s%20infomercial%20style,%20(delicate%20linework:1.1),%20paprika%20anime%20art%20style,%20close-up,%20(chromatic%20aberration%20glow:1.2),%202d%20painted%20cel%20animation,%20close-up,%20soft%20focus,%202D%20pixiv%201950s%5Cn%20%20%20%20negative%20=%20worst%20quality,%20low%20quality,%20%5Binput.negative%5D,%20neon%20tube,%20bad%20art,%20messy,%20disfigured,%20bad%20anatomy,%20out%20of%20focus,%20grainy,%20blurry,%20jpeg%20artifact%20noise,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpainting:30,%20anime:50,%20vintage:60,%20cartoon:50%7D)%5D%5Cn%20%203D%20Pokemon%5Cn%20%20%20%20prompt%20=%20a%20pokemon%20creature,%20((%5Binput.description%5D)),%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5D4k%20render,%20beautiful%20pokemon%20digital%20art,%20fakemon,%20pokemon%20creature,%20cryptid,%20fakemon,%20masterpiece,%20%7Bsoft%7Csharp%7D%20focus,%20(best%20quality,%20high%20quality:1.3)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20distorted,%20deformed,%20bad%20art,%20low%20quality,%20over%20saturated,%20extreme%20contrast,%20(worst%20quality,%20low%20quality:1.3)%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:60%7D)%5D%5Cn%20%20Painted%20Pokemon%5Cn%20%20%20%20prompt%20=%20(%5Binput.description%5D),%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5D4k%20digital%20painting%20of%20a%20pokemon,%20amazing%20pokemon%20creature%20art%20by%20piperdraws,%20cryptid%20creations%20by%20Piper%20Thibodeau,%20by%20Naoki%20Saito%20and%20%7BTokiya%7CMitsuhiro%20Arita%7D,%20incredible%20composition%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20crappy%203D%20render,%20distorted,%20deformed,%20bad%20art,%20low%20quality,%20text,%20signature%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:50%7D)%5D%5Cn%20%202D%20Pokemon%5Cn%20%20%20%20prompt%20=%20(%5Binput.description%5D),%20%5Binput.pokemonType%20?%20input.pokemonType+%5C%22,%20%5C%22%20:%20%5C%22%5C%22%5Dpokemon%20creature%20concept,%20superb%20line%20art,%20beautiful%20pokemon%20digital%20art,%20fakemon,%20by%20Sowsow,%20pokemon%20creature,%20cryptid,%20fakemon,%20masterpiece,%20by%20Yuu%20Nishida,%204k%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20distorted,%20deformed,%20bad%20art,%20low%20quality,%20crappy%203D%20render,%20text%20watermark%20symbols%20logo%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bpokemon:70,%20drawing:50,%20cartoon:35%7D)%5D%5Cn%20%20Vintage%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%201990s%20anime,%20vintage%20anime,%2090's%20anime%20style,%20by%20hajime%20sorayama,%20by%20greg%20tocchini,%20anime%20masterpiece,%20pixiv,%20akira-style%20art,%20akira%20anime%20art,%204k,%20high%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20(worst%20quality,%20low%20quality:1.3),%20bad%20art,%20distorted,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20vintage:50,%20drawing:50%7D)%5D%5Cn%20%20Neon%20Vintage%20Anime%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20((neon%20vintage%20anime))%20style,%2090's%20anime%20style,%201990s%20anime,%20hajime%20sorayama,%20greg%20tocchini,%20neon%20vintage%20anime%20masterpiece,%20anime%20art,%204k,%20high%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20blurry,%20(worst%20quality,%20low%20quality:1.3),%20bad%20art,%20distorted,%20deformed%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:30,%20vintage:50%7D)%5D%5Cn%20%20Manga%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20incredible%20hand-drawn%20manga,%20black%20and%20white,%20by%20Takehiko%20Inoue,%20by%20Katsuhiro%20Otomo%20and%20akira%20toriyama%20manga,%20hand-drawn%20art%20by%20rumiko%20takahashi%20and%20Inio%20Asano,%20Ken%20Akamatsu%20manga%20art%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20(worst%20quality,%20low%20quality:1.3),%20bad%20photo,%20bad%203D%20render,%20distorted,%20deformed,%20fuzzy,%20noisy,%20blurry,%20smudge%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20drawing:50,%20manga:100,%20comic:20,%20cartoon:30%7D)%5D%5Cn%20%20Fantasy%20World%20Map%5Cn%20%20%20%20prompt%20=%20beautiful%20fantasy%20map%20of%20%5Binput.description%5D,%20beautiful%20fantasy%20map%20inspired%20by%20middle%20earth%20and%20azeroth%20and%20discworld%20and%20westeros%20and%20essos%20and%20the%20witcher%20world%20and%20tamriel%20and%20faer%C3%BBn%20and%20thedas,%204k,%20beautiful%20colors,%20crisp,%20high-resolution%20artistic%20map,%20topographic%203D%20terrain,%20artistic%20map%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20blurry,%20worst%20quality,%20childrens%20drawing,%20boring,%20logo,%20scratchy%20and%20grainy,%20messy,%20washed%20out%20colors,%20sepia,%20hazy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:90,%20fantasy:20%7D)%5D%5Cn%20%20Fantasy%20City%20Map%5Cn%20%20%20%20prompt%20=%20an%20aerial%20view%20of%20a%20city,%20TTRPG%20city%20map%20showing%20the%20full%20city,%20%5Binput.description%5D,%20fantasy%20art,%20by%20senior%20environment%20artist,%20beautiful%20fantasy%20map%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20fuzzy,%20bad%20art%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:80,%20fantasy:20%7D)%5D%5Cn%20%20Old%20World%20Map%5Cn%20%20%20%20prompt%20=%20fantasy%20world%20map%20of%20%5Binput.description%5D,%20fantasy%20world%20map,%20highly%20detailed%20digital%20painting,%20fantasy%20art,%20map%20illustration,%208k%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20resolution,%20worst%20quality%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bmap:70,%20fantasy:20%7D)%5D%5Cn%20%203D%20Isometric%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%203D%20isometric%20render%20of%20cute%20%5Binput.description%5D,%203D%20app%20icon,%20clean%20isometric%20design,%20beautiful%20design,%20soft%20gradient%20background,%20soft%20colors,%20centered,%203D%20blender%20render,%20masterpiece,%20best%20quality,%20high%20resolution,%208k%20octane%20render,%20beautiful%20color%20scheme,%20soft%20smooth%20lighting,%20physically%20based%20rendering,%20square%20image,%20high%20polycount%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20terrible%20design,%20glitchy%20compression%20artefacts,%20deformed,%20blurry%20compression%20artefacts,%20text%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:90,%20emoji:86%7D)%5D%5Cn%20%20Flat%20Style%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20creative%20icon,%20flat%20style%20icon,%20masterpiece,%20high%20resolution,%20crisp,%20beautiful%20composition%20and%20color%20choice,%20beautiful%20flat%20painted%20style,%20behance%20contest-winner,%20award%20winning%20icon%20illustration,%208k,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20gradient,%20bad%20design,%20blurry,%20jpeg%20compression%20artefacts,%20grainy,%20gradient,%20text,%20messy%20and%20inconsistent%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:80%7D)%5D%5Cn%20%20Flat%20Style%20Logo%5Cn%20%20%20%20prompt%20=%20beautiful%20flat-style%20logo%20design%20depicting%20%5Binput.description%5D,%20creative%20flat-style%20logo%20design,%20trending%20on%20dribbble,%20featured%20on%20behance,%20portfolio%20piece,%20minimal%20flat%20design,%20breathtaking%20graphic%20design,%208k,%20high%20resolution%20vector%20logo,%20plain%20background,%20amazingly%20beautiful%20logo%20design,%20winner%20of%20best%20logo%20award%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20photo,%20hilariously%20bad%20design,%20bad%20composition,%20bad%20colors,%20blurry,%20worst%20quality,%20low%20quality,%20shadow,%20boring,%20bad%20dsign,%20worst%20design%20ever,%20hilariously%20bad%20design,%20drop-shadow,%20gradient,%20messy,%20chaotic%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:80,%20logo:80%7D)%5D%5Cn%20%20Game%20Art%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20concept%20art%20icon%20for%20league%20of%20legends,%20a%20digital%20art%20logo,%20illustration,%20league%20of%20legends%20style%20icon,%20inspired%20by%20wlop%20style,%208k,%20dota%202%20style%20icon,%20fine%20details,%20sharp,%20very%20detailed%20icon,%20high%20resolution%20rpg%20ability/spell/item%20icon%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20multiple%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:70%7D)%5D%5Cn%20%20Digital%20Painting%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20app%20logo%20icon,%20digital%20art%20pictogram%20icon,%20trending%20on%20artstation,%20app%20icon%20by%20atey%20ghailan,%20app%20icon%20by%20greg%20rutkowski,%20app%20icon%20by%20greg%20tocchini,%20app%20icon%20by%20james%20gilleard,%208k,%20high%20resolution,%20best%20quality%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20photo,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:60%7D)%5D%5Cn%20%20Concept%20Art%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20concept%20art%20icon,%20a%20digital%20art%20logo,%20illustration,%20league%20of%20legends%20style%20concept%20art%20logo%20icon,%20inspired%20by%20wlop%20style,%208k,%20fine%20details,%20sharp,%20very%20detailed,%20high%20resolution%20logo%20icon%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn,%20multiple%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:50%7D)%5D%5Cn%20%20Cute%203D%20Icon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20cute%203D%20icon%20of%20%5Binput.description%5D,%20cartoon%203D%20icon,%20very%20cute%20shape,%20stylized%20octane%20render,%208k,%20masterpiece,%20soooo%20cute,%20beautiful%20cute%20perfection,%20beautiful%20soft%20lighting,%20soft%20colors,%20centered,%20high%20resolution,%20%5Binput.description%5D,%20soft%20gradient%20background%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20text,%20ugly,%20gross%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:40%7D)%5D%5Cn%20%20Cute%203D%20Icon%20%F0%9D%97%A6%F0%9D%97%B2%F0%9D%98%81%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20a%20set%20of%20lovely%20little%203D%20icons,%20cute%203D%20icons,%20very%20cute%20shapes,%20stylized%20octane%20render,%208k,%20masterpiece,%20soooo%20cute,%20beautiful%20cute%20perfection,%20beautiful%20soft%20lighting,%20soft%20colors,%20centered,%20high%20resolution,%20%5Binput.description%5D,%20cute%20icon%20set%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low%20quality,%20text,%20ugly,%20gross%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bicon:30%7D)%5D%5Cn%20%20Crayon%20Drawing%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20crayon%20drawing%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20deformed,%20text,%20poorly%20drawn%5Cn%20%20Pencil%5Cn%20%20%20%20prompt%20=%20((black%20and%20white%20pencil%20drawing)),%20%5Binput.description%5D,%20black%20and%20white,%20breathtaking%20pencil%20illustration,%20highly%20detailed,%204k,%20(textured%20paper),%20pencil%20texture,%20sketch%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20stationary,%20holding%20pen,%20holding%20paper,%20low-quality,%20deformed,%20photo,%203D%20render,%20text,%20poorly%20drawn%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bdrawing:45%7D)%5D%5Cn%20%20Tattoo%20Design%5Cn%20%20%20%20prompt%20=%20amazing%20tattoo%20design,%20%5Binput.description%5D,%20breathtaking%20tattoo%20design,%20incredible%20tattoo%20design%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20low-quality,%20poorly%20drawn,%20blurry,%20faded,%20terrible%20design,%20worst%20quality,%20deformed,%20amputee,%20disfigured,%20ugly,%20bad,%20shitty,%20boring%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Btattoo:100%7D)%5D%5Cn%20%20Waifu%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20waifu%20character%20portrait,%20art%20by%20Kazenoko,%20featured%20on%20pixiv,%201%20girl,%20by%20Ilya%20Kuvshinov,%20Kantoku%20art,%20very%20detailed%20anime%20art%20by%20Redjuice%5Cn%20%20%20%20negative%20=%20(worst%20quality,%20low%20quality:1.3),%20%5Binput.negative%5D,%20bad%20photo,%20bad%20art,%20boring,%20bad%203D%20render,%20worst%20quality,%20ugly,%20blurry,%20low%20quality,%20poorly%20drawn,%20bad%20composition,%20deformed,%20bad%203D%20render,%20disfigured,%20bad%20anatomy,%20compression%20artifacts,%20dead,%20soulless,%20photorealistic%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Banime:40,%20waifu:100,%20cartoon:20%7D)%5D%5Cn%20%20%20%20modifiers%20=%20%5BanimeModifiers%5D%5Cn%20%20YuGiOh%20Art%5Cn%20%20%20%20prompt%20=%20yugioh%20card%20art%20for%20%5Binput.description%5D,%20art%20by%20genzoman,%20by%20Akina%20Fujiwara,%20by%20rossdraws,%20yugioh%20monster,%20close%20up,%20painterly%20details,%20breathtaking%20art,%20centered,%20masterpiece,%20amazing%20composition,%20%5Binput.description.length%20%3C%2030%20?%20input.description%20:%20%5C%22%5C%22%5D%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20Yugi%20Mutou,%20low-quality,%20blurry,%20crappy%203D%20render,%20worst%20quality,%20messy,%20noisy,%20framed,%20with%20border,%20cropped,%20confusing,%20stacked%20characters%20poster,%20low%20resolution,%20bad%203D%20render,%20fuzzy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Byugioh:100%7D)%5D%5Cn%20%20Traditional%20Japanese%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20in%20ukiyo-e%20art%20style,%20traditional%20japanese%20masterpiece%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20blurry,%20low%20resolution,%20worst%20quality,%20fuzzy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bjapanese:100,%20vintage:50,%20cartoon:30%7D)%5D%5Cn%20%20Nihonga%20Painting%5Cn%20%20%20%20prompt%20=%20japanese%20nihonga%20painting%20about%20%5Binput.description%5D,%20Nihonga,%20ancient%20japanese%20painting,%20intricate,%20detailed%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20framed%20blurry%20crappy%20photo,%20overly%20faded%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bjapanese:95,%20vintage:55,%20comic:70%7D)%5D%5Cn%20%20Claymation%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20claymation,%20incredible%20claymation%20style,%20kubo%20and%20the%20two%20strings%20style%20art,%20Missing%20Link%202019%20art%20style,%20clay%20texture,%20clay%20animation,%20stop-motion%20clay%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20glossy,%20creepy,%20dead%20eyes,%20lifeless%20eyes,%20blurry,%20scary,%20boring,%20tiling,%20cropped,%20terrifying,%20horror,%20out%20of%20focus%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bclaymation:100%7D)%5D%5Cn%20%20Cartoon%5Cn%20%20%20%20prompt%20=%20%5Binput.description%5D,%20cartoon-style%20art,%20superb%20linework,%20nice%20colors%20and%20composition,%20bold%20linework,%20close-up,%20(masterpiece),%20cute%20art%20by%20Dana%20Terrace,%20by%20Rebecca%20Sugar,%20by%20ry-spirit,%20amazing%20and%20wholesome%20cartoon-style%20art,%20cute%20art%20style,%20(trending%20on%20artstation)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20bad%20art,%20boring%20art,%20hilariously%20bad%20drawings,%20bad%203D%20render,%20bad%20photo,%20blurry,%20blur,%20worst%20quality,%20boring%20colors,%20logo%20vector%20image,%20monotone,%20lifeless,%20expressionless,%20faded,%20horror,%20creepy%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bcartoon:95,%20basicCartoon:100%7D)%5D%5Cn%20%20Cursed%20Photo%5Cn%20%20%20%20prompt%20=%20cursed%20photo%20of%20%5Binput.description%5D,%20(creepy%20and%20cursed:1.2),%20absolutely%20cursed%20photo,%20nope%20nope%20nope%20nope,%20what%20the%20actual%20f,%20(unsettling%20photo:1.2),%20cursed_thing,%20cursedimages,%20no%20context,%20cursed%20image,%20bad%20photo,%20weird%20photo,%20very%20strange,%20color%20photo,%20creepy%20photo,%20(nightmare%20fuel)%5Cn%20%20%20%20negative%20=%20%5Binput.negative%5D,%20skeleton%20face,%20nice%20photo,%20lovely%20photo,%20old%20photo,%20vintage%20photo,%20greyscale,%20wholesome,%20eyebleach,%20bad%20photoshop%5Cn%20%20%20%20meta:tags%20=%20%5B(%7Bcreepy:100%7D)%5D%5Cn%20%20%20%20modifiers%5Cn%20%20%20%20%20%20modifier%5Cn%20%20%20%20%20%20%20%20found%20footage%20=%20,%20found%20footage%5Cn%20%20%20%20%20%20%20%20cult%20=%20,%20photo%20from%20a%20real%20cult%5Cn%20%20%20%20%20%20%20%201920s%20=%20,%201920s%20photo%5Cn%20%20%20%20%20%20%20%20old%20phone%20=%20,%20old%20cell%20phone%20photo%5Cn%20%20%20%20%20%20%20%20VHS%20=%20,%20old%20VHS%20footage%5Cn%20%20%20%20%20%20%20%20CCTV%20=%20,%20old%20CCTV%20footage,%20high-angle%20CCTV%20image%5Cn%20%20%20%20%20%20%20%20trypophobia%20=%20,%20trypophobia%5Cn%20%20%20%20%20%20%20%20backrooms%20=%20,%20backrooms%5Cn%20%20%20%20%20%20%20%20black%20&%20white%20=%20,%20black%20&%20white%5Cn%20%20%20%20%20%20%20%20grainy%20=%20,%20grainy,%20noisy%20static%20effect%5Cn%20%20%20%20%20%20%20%20extreme%20close-up%20=%20,%20extreme%20close-up%5Cn%20%20%20%20%20%20%20%20low-angle%20=%20,%20low-angle%20shot%5Cn%20%20%20%20%20%20%20%20dramatic%20=%20,%20dramatic%20angle,%20extreme%20angle%20shot%5Cn%5Cn%5Cn%5Cn%5CnphotoModifiers%5Cn%20%20shot%5Cn%20%20%20%20extreme%20close-up%20=%20,%20extreme%20close-up%5Cn%20%20%20%20low-angle%20=%20,%20low-angle%20shot%5Cn%20%20%20%20high-angle%20=%20,%20high-angle%20shot%5Cn%20%20%20%20aerial%20=%20,%20aerial%20shot%5Cn%20%20%20%20close-up%20=%20,%20close-up%20shot%5Cn%20%20%20%20portrait%20=%20,%20close-up%20portrait%5Cn%20%20%20%20macro%20=%20,%20macro%20shot%5Cn%20%20%20%20wide-angle%20=%20,%20wide-angle%20shot%5Cn%20%20%20%20establishing%20=%20,%20establishing%20shot%5Cn%20%20%20%20over-the-shoulder%20=%20,%20over-the-shoulder%20shot%5Cn%20%20%20%20telephoto%20=%20,%20telephoto%20shot%5Cn%20%20%20%20handheld%20=%20,%20handheld%20shot%5Cn%20%20%20%20panoramic%20=%20,%20panoramic%20shot%5Cn%20%20%20%20dramatic%20=%20,%20dramatic%20angle,%20extreme%20angle%20shot%5Cn%20%20color%5Cn%20%20%20%20vibrant%20=%20,%20vibrant%20color%20grading%5Cn%20%20%20%20warm%20=%20,%20warm%20color%20grading%5Cn%20%20%20%20cool%20=%20,%20cool-toned%20color%20grading%5Cn%20%20%20%20pastel%20=%20,%20pastel%20color%20grading%5Cn%20%20%20%20bright%20=%20,%20bright%20color%20grading%5Cn%20%20%20%20muted%20=%20,%20muted%20color%20grading%5Cn%20%20%20%20neon%20=%20,%20neon%20color%20grading%5Cn%20%20%20%20duotone%20=%20,%20duotone%20color%20grading%5Cn%20%20%20%20monochrome%20=%20,%20monochrome%5Cn%20%20%20%20sterile%20=%20,%20cool-toned%20sterile%20colors%5Cn%20%20effect%5Cn%20%20%20%20bokeh%20=%20,%20bokeh%5Cn%20%20%20%20tilt-shift%20=%20,%20tilt-shift%20effect%5Cn%20%20%20%20soft%20focus%20=%20,%20soft%20focus%5Cn%20%20%20%20background%20blur%20=%20,%20shallow%20depth%20of%20field%5Cn%20%20%20%20chromatic%20aberrations%20=%20,%20chromatic%20aberrations%5Cn%20%20%20%20light%20leaks%20=%20,%20light%20leaks%5Cn%20%20%20%20rear%20projection%20=%20,%20rear%20projection%5Cn%20%20%20%20lens%20flare%20=%20,%20lens%20flare%5Cn%20%20%20%20long%20exposure%20=%20,%20long%20exposure%5Cn%20%20%20%20golden%20hour%20=%20,%20golden%20hour%5Cn%20%20%20%20silhouette%20=%20,%20silhouette%5Cn%5CnanimeModifiers%5Cn%20%20style%5Cn%20%20%20%20Ghibli%20=%20,%20Ghibli%20art%20style,%20Spirited%20Away%20art%20style%5Cn%20%20%20%20Your%20Name%20=%20,%20(Your%20Name%20art%20style:1.3)%5Cn%20%20%20%20Paprika%20=%20,%20Paprika%20art%20style%5Cn%20%20%20%20My%20Hero%20Academia%20=%20,%20My%20Hero%20Academia%20art%20style%5Cn%20%20%20%20Hunter%20x%20Hunter%20=%20,%20Hunter%20x%20Hunter%20art%20style%5Cn%20%20%20%20Attack%20on%20Titan%20=%20,%20(Attack%20on%20Titan%20art%20style:1.3)%5Cn%20%20effect%5Cn%20%20%20%20multi-view%20=%20,%20(multiple%20views:1.2)%5Cn%20%20%20%20toon%20=%20,%20(cartoon-style%20bold%20line%20work:1.2),%20vibrant%20colors,%20cel%20shading%5Cn%20%20%20%20vintage%20=%20,%20(cel%20shading,%20vintage%20anime:1.25)%5Cn%20%20%20%20ethereal%20=%20,%20(glow,%20god%20rays,%20ethereal,%20dreamy,%20heavenly,%20otherworldly,%20dream-like,%20breathtaking,%20captivating,%20divine)%5Cn%20%20%20%20outline%20=%20,%20outline,%20white%20outline%5Cn%20%20%20%20%5CnfurryModifiers%5Cn%20%20effect%5Cn%20%20%20%20humanoid%20face%20=%20,%20(human%20face,%20not%20furry:1.3)%5Cn%20%20%20%20multi-view%20=%20,%20(multiple%20views:1.2)%5Cn%20%20%20%20toon%20=%20,%20(cartoon-style%20bold%20line%20work:1.2),%20vibrant%20colors,%20cel%20shading%5Cn%20%20%20%20vintage%20=%20,%20(cel%20shading,%20vintage%20anime:1.25)%5Cn%20%20%20%20ethereal%20=%20,%20(glow,%20god%20rays,%20ethereal,%20dreamy,%20heavenly,%20otherworldly,%20dream-like,%20breathtaking,%20captivating,%20divine)%5Cn%20%20%20%20outline%20=%20,%20outline,%20white%20outline%5Cn%20%20%5CnlandscapeModifiers%5Cn%20%20shot%5Cn%20%20%20%20aerial%20=%20,%20aerial%20view%5Cn%20%20%20%20low-angle%20=%20,%20low-angle%20view%5Cn%20%20%20%20high-angle%20=%20,%20high-angle%20view%5Cn%20%20%20%20wide-angle%20=%20,%20wide-angle%20view%5Cn%20%20color%5Cn%20%20%20%20vibrant%20=%20,%20vibrant%20color%20tones%5Cn%20%20%20%20warm%20=%20,%20warm-toned%20colors%5Cn%20%20%20%20cool%20=%20,%20cool-toned%20colors%5Cn%20%20%20%20pastel%20=%20,%20pastel%20tones%5Cn%20%20%20%20muted%20=%20,%20muted%20color%20grading%5Cn%20%20%20%20sunset%20=%20,%20sunset%20color%20tones%5Cn%20%20%20%20monochrome%20=%20,%20monochrome%5Cn%20%20effect%5Cn%20%20%20%20tilt-shift%20=%20,%20tilt-shift%20effect%5Cn%20%20%20%20golden%20hour%20=%20,%20golden%20hour%5Cn%20%20%20%20mist%20=%20,%20misty%5Cn%20%20%20%20reflection%20=%20,%20water%20reflection%5Cn%20%20%20%20sun%20flare%20=%20,%20sun%20flare%5Cn%20%20%20%20starburst%20=%20,%20starburst%20effect%5Cn%20%20%20%20light%20trails%20=%20,%20light%20trails%5Cn%20%20%20%20long%20exposure%20=%20,%20long%20exposure%5Cn%20%20%20%20soft%20focus%20=%20,%20soft%20focus%5Cn%20%20%22,%22imports%22:%5B%5D,%22lastEditTime%22:1714760414769,%22found%22:true%7D,%7B%22name%22:%22simple-gen-footer%22,%22modelText%22:%22$output%5Cn%5CtThe%20%3Ca%20href%5C%5C=%5C%22/useful-generators%5C%22%3Euseful%20generators%20list%3C/a%3E%20is%20a%20handy%20list%20of%20simple%20text%20generators%20on%20various%20topics.%20If%20you're%20a%20Perchance%20builder%20then%20you'll%20probably%20find%20some%20of%20them%20useful%20for%20importing%20into%20your%20own%20projects.%5Cn%5CtIf%20you'd%20like%20to%20learn%20how%20to%20create%20a%20random%20text%20generator,%20then%20check%20out%20the%20%3Ca%20href%5C%5C=%5C%22/minimal#edit%5C%22%3Eminimal%20generator%20template%3C/a%3E%20and%20the%20%3Ca%20href%5C%5C=%5C%22/tutorial%5C%22%3Etutorial%3C/a%3E.%20It's%20easier%20than%20you'd%20think%20and%20is%20great%20fun%20:)%5Cn%5Ct$output%20=%20%3Cp%3E%5Bthis.joinItems(%5C%22%3C/p%3E%3Cp%3E%5C%22)%5D%3C/p%3E%22,%22imports%22:%5B%5D,%22lastEditTime%22:1618109989813,%22found%22:true%7D,%7B%22name%22:%22ai-text-plugin%22,%22modelText%22:%22$output(inputData)%20=%3E%5Cn%20%20//%20console.log(%5C%22inputData:%5C%22,%20inputData);%5Cn%20%20if(!inputData)%20return%20%5C%22(Error:%20No%20input%20data%20given%20to%20the%20ai%20text%20plugin.)%5C%22;%5Cn%20%20if(inputData.instructions)%20%7B%5Cn%20%20%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20inputData.outputTo.value%20=%20%5C%22(Error:%20Looks%20like%20you%20wrote%20'instructions%20=%20...'%20instead%20of%20'instruction%20=%20...'%20in%20your%20ai-text-plugin%20prompt%20data?)%5C%22;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20return%20%5C%22(Error:%20Looks%20like%20you%20wrote%20'instructions%20=%20...'%20instead%20of%20'instruction%20=%20...'%20in%20your%20ai-text-plugin%20prompt%20data?)%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20REMEMBER:%20if%20you%20add%20more%20inputs,%20you%20need%20to%20also%20update%20%60window.__continueAiTextResponseClickHandler%60%5Cn%20%20let%20hideStartWith%20=%20inputData.hideStartWith;%20//%20get%20the%20'concrete'%20value%20in%20case%20it%20was%20dynamic%20like%20%60hideStartWith%20=%20%5B%20...%20%5D%60%20-%20this%20is%20important%20because%20the%20condition%20in%20the%20square%20brackets%20could%20change%20later%5Cn%20%20%5Cn%20%20let%20instruction%20=%20inputData.instruction;%5Cn%20%20if(typeof%20instruction%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20instruction%20=%20instruction(%7B%7D);%20//%20this%20is%20useful%20as%20a%20way%20to%20give%20a%20string%20that%20should%20not%20be%20evaluated%20-%20since%20e.g.%20instruction%20=%20%5BtextareaEl.value%5D%20will%20actually%20evaluate%20the%20text%20when%20we%20call%20inputData.instruction%5Cn%20%20%20%20if(typeof%20instruction%20!==%20%5C%22string%5C%22)%20instruction%20=%20instruction.toString();%5Cn%20%20%7D%20else%20if(instruction)%20%7B%5Cn%20%20%20%20if(typeof%20instruction%20!==%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20instruction%20=%20instruction.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20instruction%20=%20instruction.toString();%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20instruction%20=%20%5C%22Write%20something.%5C%22;%20//%20default%20instruction%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20startWith%20=%20inputData.startWith;%5Cn%20%20if(typeof%20startWith%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20startWith%20=%20startWith(%7B%7D);%20//%20this%20is%20useful%20as%20a%20way%20to%20give%20a%20string%20that%20should%20not%20be%20evaluated%20-%20since%20e.g.%20startWith%20=%20%5BtextareaEl.value%5D%20will%20actually%20evaluate%20the%20text%20when%20we%20call%20inputData.startWith%5Cn%20%20%20%20if(typeof%20startWith%20!==%20%5C%22string%5C%22)%20startWith%20=%20startWith.toString();%5Cn%20%20%7D%20else%20if(startWith)%20%7B%5Cn%20%20%20%20if(typeof%20startWith%20!==%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20startWith%20=%20startWith.evaluateItem;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20startWith%20=%20startWith.toString();%5Cn%20%20%20%20//%20We%20trim%20whitespace%20off%20the%20end%20due%20to%20the%20classic%20tokenizer%20problem%20(most%20word%20tokens%20start%20with%20a%20space%20as%20of%202023%20tokenizers).%5Cn%20%20%20%20//%20This%20of%20course%20does%20mean%20that%20you%20can't%20%5C%22force%5C%22%20the%20model%20to%20start%20with%20a%20space%20after%20a%20word,%20but%20it's%20worth%20that%20trade-off%20until%20we%20get%20models%20with%20better%20tokenizers.%5Cn%20%20%20%20startWith%20=%20startWith.replace(/%20+$/g,%20%5C%22%5C%22);%20//%20CAUTION:%20Don't%20trim%20newlines%20-%20only%20spaces.%20Because%20e.g.%20the%20story%20writer%20demo%20relies%20on%20being%20able%20to%20start%20with%202%20new%20lines%20before%20the%20paragraph%20that%20the%20AI%20is%20about%20to%20generate,%20since%20if%20the%20AI%20generates%20them,%20it'll%20trigger%20the%20stop%20sequence%20before%20it%20even%20gets%20to%20start%20writing%20the%20new%20paragraph%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20startWith%20=%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%5Cn%20%20let%20stopSequences%20=%20inputData.stopSequences;%5Cn%20%20if(typeof%20stopSequences%20===%20%5C%22function%5C%22)%20%7B%5Cn%20%20%20%20stopSequences%20=%20stopSequences(%7B%7D);%5Cn%20%20%7D%20else%20if(stopSequences)%20%7B%5Cn%20%20%20%20if(!Array.isArray(stopSequences))%20%7B%5Cn%20%20%20%20%20%20stopSequences%20=%20stopSequences.selectAll.map(n%20=%3E%20n.evaluateItem);%5Cn%20%20%20%20%7D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20stopSequences%20=%20%5B%5D;%5Cn%20%20%7D%20%20%5Cn%20%20%5Cn%20%20//%20REMEMBER:%20if%20you%20add%20more%20inputs,%20you%20need%20to%20also%20update%20%60window.__continueAiTextResponseClickHandler%60%5Cn%20%20%5Cn%20%20let%20concreteInputs%20=%20%7BstartWith,%20instruction,%20stopSequences%7D;%20%20//%20%3C--%20CAUTION:%20the%20startWith%20property%20of%20this%20is%20changed%20after%20generation%20for%20the%20%60editAiTextResponseClickHandler%60%20feature%20-%20ctrl+f%20for%20%60concreteInputs.startWith%20=%60.%20Use%20%60originalConcreteInputs%60%20for%20original%20inputs.%5Cn%20%20const%20originalConcreteInputs%20=%20Object.freeze(JSON.parse(JSON.stringify(concreteInputs)));%5Cn%20%20let%20syncOutputObj;%5Cn%5Cn%20%20let%20placeholderEl;%5Cn%20%20let%20placeholderElDidInitiallyExist%20=%20false;%20//%20this%20is%20for%20keepalive%20stuff%20-%20so%20we%20can%20cancel%20a%20queued%20up%20generation%20if%20the%20placeholder%20is%20removed%5Cn%20%20let%20userStoppedGeneration%20=%20false;%5Cn%20%20%5Cn%20%20let%20textStreamController;%5Cn%20%20const%20textStream%20=%20new%20ReadableStream(%7B%5Cn%20%20%20%20start(c)%20%7B%5Cn%20%20%20%20%20%20textStreamController%20=%20c;%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%5Cn%20%20const%20serverOrigin%20=%20%5C%22https://text-generation.perchance.org%5C%22;%5Cn%20%20%5Cn%20%20const%20animatedLoadingSvg%20=%20%60%3Csvg%20style=%5C%22height:1rem;%20width:2rem;%20overflow:hidden;%20border-radius:3px;%20vertical-align:top;%20position:relative;%20top:0.07rem;%20margin-left:0.125rem;%5C%22%20height=%5C%221rem%5C%22%20width=%5C%222rem%5C%22%20class=%5C%22ai-text-plugin-loader%5C%22%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%220.5rem%5C%22%20cy=%5C%220.5rem%5C%22%20r=%5C%223%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%221rem%5C%22%20cy=%5C%220.5rem%5C%22%20r=%5C%223%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3Ccircle%20class=%5C%22ai-text-plugin-dot%5C%22%20cx=%5C%221.5rem%5C%22%20cy=%5C%220.5rem%5C%22%20r=%5C%223%5C%22%20style=%5C%22fill:grey;%5C%22%3E%3C/circle%3E%20%3C/svg%3E%60;%5Cn%20%20%5Cn%20%20let%20generatedText%20=%20%5C%22%5C%22;%5Cn%20%20let%20finishedGenerating%20=%20false;%5Cn%20%20let%20finishedGeneratingSuccessfully%20=%20false;%5Cn%20%20let%20thereWasAnErrorDuringGeneration%20=%20false;%5Cn%20%20%5Cn%20%20let%20onFinishPromiseResolver;%5Cn%20%20let%20onFinishPromiseRejecter;%5Cn%20%20let%20onFinishPromise%20=%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20onFinishPromiseResolver%20=%20resolve;%5Cn%20%20%20%20onFinishPromiseRejecter%20=%20reject;%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20let%20iframe;%20%20%5Cn%20%20if(!window.__alreadyAddedAiTextPluginStuff8492739)%20%7B%5Cn%20%20%20%20iframe%20=%20document.createElement(%5C%22iframe%5C%22);%20%5Cn%20%20%20%20iframe.src%20=%20%60$%7BserverOrigin%7D/embed%60;%5Cn%20%20%20%20iframe.style.cssText%20=%20%5C%22position:fixed;%20top:0.5rem;%20right:0.5rem;%20height:3rem;%20width:11rem;%20background:#333;%20border:none;%20border-radius:3px;%20box-shadow:0px%202px%204px%200px%20#00000066;%20z-index:10000%5C%22;%5Cn%20%20%20%20iframe.id%20=%20%5C%22aiTextPluginEmbedIframe%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(!window.__aiTextIframeEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.src%20=%20%60$%7BserverOrigin%7D/embed?__cacheBust=$%7BMath.random()%7D%60;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D,%2015*1000);%5Cn%20%20%20%20%5Cn%20%20%20%20const%20style%20=%20document.createElement(%5C%22style%5C%22);%5Cn%20%20%20%20style.textContent%20=%20%60%5Cn%20%20%20%20%20%20@keyframes%20ai-text-plugin-blink%20%7B%2050%25%20%7B%20fill:%20transparent%20%7D%7D%20.ai-text-plugin-dot%20%7B%20animation:%201s%20ai-text-plugin-blink%20infinite;%20fill:%20grey;%20%7D%20.ai-text-plugin-dot:nth-child(2)%20%7B%20animation-delay:%20250ms%20%7D%20.ai-text-plugin-dot:nth-child(3)%20%7B%20animation-delay:%20500ms%20%7D%20.ai-text-plugin-loader%20%7B%20background-color:%20#f1f1f1;%20color:%20grey;%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn:before%20%7B%5Cn%20%20%20%20%20%20%20%20content:%20%5C%22+%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn%20%7B%5Cn%20%20%20%20%20%20%20%20position:relative;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20display:none;%5Cn%20%20%20%20%20%20%20%20position:absolute;%5Cn%20%20%20%20%20%20%20%20width:%20max-content;%5Cn%20%20%20%20%20%20%20%20bottom:%200;%5Cn%20%20%20%20%20%20%20%20min-height:%202.5rem;%5Cn%20%20%20%20%20%20%20%20pointer-events:none;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20@media%20screen%20and%20(max-width:%20600px)%20%7B%5Cn%20%20%20%20%20%20%20%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20min-height:%203.5rem;%20/*%20buttons%20should%20be%20further%20apart%20on%20mobile%20-%20else%20'hover'%20click%20triggers%20the%20buttons%20themselves%20*/%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20.ai-text-response-end-buttons-ctn:hover%20.ai-text-response-buttons-wrapper%20%7B%5Cn%20%20%20%20%20%20%20%20display:flex;%5Cn%20%20%20%20%20%20%20%20pointer-events:auto;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%60;%5Cn%20%20%20%20document.head.appendChild(style);%5Cn%20%20%20%20%5Cn%20%20%20%20window.addEventListener('message',%20(event)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(event.source%20!==%20iframe.contentWindow)%20return;%5Cn%20%20%20%20%20%20if(event.origin%20!==%20serverOrigin)%20return;%5Cn%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22embedIsReady%5C%22)%20%7B%20%20%20%5Cn%20%20%20%20%20%20%20%20window.__aiTextIframeEmbedIsReady%20=%20true;%5Cn%20%20%20%20%20%20%20%20//%20console.log(%5C%22got%20embedIsReady,%20sent%20verifyUser%5C%22);%5Cn%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22verifyUser%5C%22%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22verified%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22verifying%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20iframe.style.display%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20document.body.appendChild(iframe);%5Cn%20%20%20%20%5Cn%20%20%20%20window.__alreadyAddedAiTextPluginStuff8492739%20=%20true;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20iframe%20=%20document.querySelector(%5C%22#aiTextPluginEmbedIframe%5C%22);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20completionId%20=%20%5C%22aiTextCompletion%5C%22+Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20let%20lastGeneratedChunkRecievedTime%20=%20null;%5Cn%5Cn%20%20async%20function%20streamTextFromIframe(chunkCallback)%20%7B%20%5Cn%20%20%20%20let%20postData%20=%20%7B%7D;%5Cn%20%20%20%20postData.instruction%20=%20concreteInputs.instruction%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20postData.startWith%20=%20concreteInputs.startWith%20%7C%7C%20%5C%22%5C%22;%5Cn%20%20%20%20postData.stopSequences%20=%20concreteInputs.stopSequences%20%7C%7C%20%5B%5D;%5Cn%20%20%20%20postData.generatorName%20=%20window.generatorName;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20url%20=%20%60$%7BserverOrigin%7D/api/generate%60;%5Cn%20%20%20%20let%20haveRecievedFirstTextChunk%20=%20false;%5Cn%20%20%20%20let%20haveRecievedLastTextChunk%20=%20false;%5Cn%20%20%20%20function%20messageHandler(event)%20%7B%5Cn%20%20%20%20%20%20if(event.data.requestId%20!==%20completionId)%20return;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20console.log(%5C%22streamTextFromIframe%20messageHandler:%5C%22,%20event.data);%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22streamData%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20lastGeneratedChunkRecievedTime%20=%20Date.now();%5Cn%20%20%20%20%20%20%20%20let%20text%20=%20event.data.value.text;%5Cn%20%20%20%20%20%20%20%20let%20data%20=%20%7Btext%7D;%5Cn%20%20%20%20%20%20%20%20if(event.data.value.stopReason)%20data.stopReason%20=%20event.data.value.stopReason;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20console.log(%5C%22event.data.value:%5C%22,%20event.data.value);%5Cn%20%20%20%20%20%20%20%20if(!haveRecievedFirstTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20data.isFirstChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20haveRecievedFirstTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(haveRecievedLastTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22haveRecievedLastTextChunk%20but%20about%20to%20send%20another%20chunk???%20maybe%20recieving%20streamEnd%20before%20it's%20actually%20finished??%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(event.data.value.final)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20data.isLastChunk%20=%20true;%20//%20remember,%20a%20chunk%20can%20be%20both%20the%20first%20*and*%20last%20chunk%5Cn%20%20%20%20%20%20%20%20%20%20haveRecievedLastTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20chunkCallback(data);%5Cn%20%20%20%20%20%20%7D%20else%20if%20(event.data.type%20===%20%5C%22streamEnd%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20//%20console.log(%60ai-text-plugin%20recieved%20'streamEnd'%20for%20$%7BcompletionId%7D%60);%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%20%20if(!haveRecievedLastTextChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20this%20can%20happen%20if%20stream%20is%20aborted%20for%20whatever%20reason,%20so%20we%20send%20a%20last%20%5C%22dummy%5C%22%20chunk%5Cn%20%20%20%20%20%20%20%20%20%20chunkCallback(%7Btext:%5C%22%5C%22,%20stopReason:%5C%22user%5C%22,%20isLastChunk:true,%20isFirstChunk:!haveRecievedFirstTextChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20haveRecievedLastTextChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if%20(event.data.type%20===%20%5C%22streamError%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20if(userStoppedGeneration%20&&%20event.data.status%20===%20%5C%22stale%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20this%20is%20not%20actually%20an%20error,%20but%20iframe%20embed%20can't%20know%20that,%20so%20it%20sends%20us%20this,%20which%20we%20just%20ignore.%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20%7B%20//%20%3C--%20just%20to%20guard%20against%20weird%20timing%20stuff%5Cn%20%20%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20chunkCallback(%7Btext:%5C%22%5C%22,%20error:true,%20isLastChunk:!haveRecievedLastTextChunk,%20isFirstChunk:!haveRecievedFirstTextChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20style=%5C%22z-index:1000;%20position:%20fixed;%20bottom:%201rem;%20width:%20100%25;%20pointer-events:none;%5C%22%3E%3Cspan%20style=%5C%22%20padding:%200.5rem;%20background:%20#ac2c2c;%20border-radius:%203px;%20color:%20white;%20pointer-events:auto;%5C%22%3Eerror:%20$%7Bevent.data.status.replaceAll(%5C%22_%5C%22,%20%5C%22%20%5C%22)%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20div%20=%20div.firstElementChild;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.body.appendChild(div);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20div.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D,%201000*5);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%5Cn%20%20%20%20while(!window.__aiTextIframeEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20100));%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData._debug)%20postData._debug%20=%20JSON.parse(JSON.stringify(inputData._debug));%5Cn%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22startStream%5C%22,%20url,%20postData,%20requestId:completionId,%20perchanceGeneratorOrigin:window.location.origin%20%7D,%20serverOrigin);%5Cn%20%20%20%20//%20console.log(%5C%22sent%20startStream%20request%20to%20iframe%5C%22);%5Cn%20%20%7D%5Cn%5Cn%20%20async%20function%20editAiTextResponseClickHandler(el)%20%7B%20%20%20%20%5Cn%20%20%20%20let%20saveButton%20=%20document.createElement(%5C%22button%5C%22);%5Cn%20%20%20%20saveButton.style.cssText%20=%20%5C%22position:fixed;%20z-index:501;%5C%22;%5Cn%20%20%20%20saveButton.textContent%20=%20%5C%22%F0%9F%92%BE%5C%22;%5Cn%20%20%20%20document.body.append(saveButton);%5Cn%5Cn%20%20%20%20let%20textarea%20=%20document.createElement(%5C%22textarea%5C%22);%5Cn%20%20%20%20textarea.style.cssText%20=%20%5C%22z-index:500;%20display:block;%20position:fixed;%20min-height:2rem;%20min-width:10rem;%5C%22;%5Cn%20%20%20%20textarea.value%20=%20concreteInputs.startWith;%5Cn%20%20%20%20document.body.append(textarea);%5Cn%20%20%20%20let%20updateCoverPosition%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20let%20rect%20=%20el.getBoundingClientRect();%5Cn%20%20%20%20%20%20textarea.style.left%20=%20%60$%7Brect.left%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.top%20=%20%60$%7Brect.top%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.width%20=%20%60$%7Brect.width%7Dpx%60;%5Cn%20%20%20%20%20%20textarea.style.height%20=%20%60$%7Brect.height+10%7Dpx%60;%5Cn%5Cn%20%20%20%20%20%20let%20textareaRect%20=%20textarea.getBoundingClientRect();%20//%20Use%20coverElement's%20dimensions%5Cn%20%20%20%20%20%20saveButton.style.left%20=%20%60$%7BtextareaRect.right-saveButton.offsetWidth%7Dpx%60;%5Cn%20%20%20%20%20%20saveButton.style.top%20=%20%60$%7BtextareaRect.bottom%7Dpx%60;%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20updateCoverPosition();%5Cn%20%20%20%20window.addEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20window.addEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20%5Cn%20%20%20%20const%20observer%20=%20new%20MutationObserver((mutationsList)%20=%3E%20%7B%5Cn%20%20%20%20%20%20for(let%20mutation%20of%20mutationsList)%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20node%20of%20mutation.removedNodes)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(node.contains(el))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20textarea.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20saveButton.remove();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20window.removeEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20window.removeEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20observer.observe(document.body,%20%7B%20childList:%20true,%20subtree:%20true%20%7D);%5Cn%5Cn%20%20%20%20await%20new%20Promise(r%20=%3E%20saveButton.onclick=r);%20%5Cn%5Cn%20%20%20%20let%20endButtonsCtn%20=%20document.querySelector(%5C%22.ai-text-response-end-buttons-ctn%5C%22);%5Cn%20%20%20%20endButtonsCtn.remove();%5Cn%5Cn%20%20%20%20concreteInputs.startWith%20=%20textarea.value;%5Cn%20%20%20%20%5Cn%20%20%20%20//%20el.innerHTML%20=%20textarea.value;%5Cn%20%20%20%20//%20el.appendChild(endButtonsCtn);%5Cn%20%20%20%20renderResponseTextIntoContainer(textarea.value,%20%7BaddEndButtons:true,%20isFinalRender:true%7D);%5Cn%5Cn%20%20%20%20window.removeEventListener('scroll',%20updateCoverPosition);%5Cn%20%20%20%20window.removeEventListener('resize',%20updateCoverPosition);%5Cn%20%20%20%20textarea.remove();%5Cn%20%20%20%20saveButton.remove();%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20async%20function%20continueAiTextResponseClickHandler(el)%20%7B%20%20%20%20%5Cn%20%20%20%20let%20instruction%20=%20concreteInputs.instruction;%5Cn%20%20%20%20let%20startWith%20=%20concreteInputs.startWith;%5Cn%20%20%20%20let%20stopSequences%20=%20concreteInputs.stopSequences;%5Cn%20%20%20%20%5Cn%20%20%20%20responseEndButtonsCtn.remove();%5Cn%20%20%20%20let%20obj%20=%20$output(%7Binstruction,%20startWith,%20stopSequences,%20style:inputData.style,%20outputTo:el,%20render:inputData.render,%20onFinish:inputData.onFinish,%20onChunk:inputData.onChunk%7D);%5Cn%20%20%20%20el.innerHTML%20+=%20obj.loadingIndicatorHtml;%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20let%20responseEndButtonsCtn;%5Cn%20%20%7B%5Cn%20%20%20%20let%20buttonGap%20=%20%5C%220.25rem%5C%22;%5Cn%20%20%20%20if(window.innerWidth%20%3C%20600)%20buttonGap%20=%20%5C%221.5rem%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20responseEndButtonsHtml%20=%20%60%3Cspan%20class=%5C%22ai-text-response-end-buttons-ctn%5C%22%20style=%5C%22display:%20inline-flex;background:%20#f1f1f1;color:%20grey;height:%201rem;width:%201rem;border-radius:%203px;vertical-align:%20top;position:%20relative;top:%200.07rem;margin-left:%200.125rem;align-items:%20center;justify-content:%20center;cursor:%20pointer;%20font-size:80%25%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22ai-text-response-buttons-wrapper%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22ai-text-continue-button%5C%22%20style=%5C%22height:min-content;%5C%22%3E%E2%96%B6%EF%B8%8F%3C/button%3E%5Cn%20%20%20%20%20%20%20%20%3Cbutton%20class=%5C%22ai-text-edit-button%5C%22%20style=%5C%22height:min-content;%20margin-left:$%7BbuttonGap%7D%5C%22%3E%E2%9C%8F%EF%B8%8F%3C/button%3E%5Cn%20%20%20%20%20%20%3C/div%3E%5Cn%20%20%20%20%3C/span%3E%60;%5Cn%20%20%20%20responseEndButtonsCtn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20responseEndButtonsCtn.innerHTML%20=%20responseEndButtonsHtml;%5Cn%20%20%20%20responseEndButtonsCtn%20=%20responseEndButtonsCtn.firstElementChild;%5Cn%20%20%20%20if(inputData.endButtons?.evaluateItem%20===%20%5C%22none%5C%22)%20%7B%5Cn%20%20%20%20%20%20responseEndButtonsCtn.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20responseEndButtonsCtn.querySelector(%5C%22.ai-text-continue-button%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20//%20console.log(%5C%22wrapper%20display:%5C%22,%20this.closest('.ai-text-response-buttons-wrapper').style.display);%5Cn%20%20%20%20%20%20continueAiTextResponseClickHandler(this.closest('.ai-text-response-ctn'));%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20responseEndButtonsCtn.querySelector(%5C%22.ai-text-edit-button%5C%22).onclick%20=%20function()%20%7B%5Cn%20%20%20%20%20%20//%20console.log(%5C%22wrapper%20display:%5C%22,%20this.closest('.ai-text-response-buttons-wrapper').style.display);%5Cn%20%20%20%20%20%20editAiTextResponseClickHandler(this.closest('.ai-text-response-ctn'));%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20escapeRegExp(text)%20%7B%5Cn%20%20%20%20return%20text.replace(/%5B-%5B%5C%5C%5D%7B%7D()*+?.,%5C%5C%5C%5C%5E$%7C#%5C%5Cs%5D/g,%20'%5C%5C%5C%5C$&');%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20startWithRegex;%5Cn%20%20%5Cn%20%20function%20renderResponseTextIntoContainer(response,%20opts=%7B%7D)%20%7B%5Cn%20%20%20%20if(!inputData.outputTo%20&&%20!placeholderEl)%20return;%20//%20%3C--%20indicates%20that%20they're%20doing%20things%20manually%20with%20e.g.%20onFinishPromise/onChunk/etc.%5Cn%20%20%20%20%5Cn%20%20%20%20if(hideStartWith)%20%7B%20//%20note%20that%20%60hideStartWith%60%20is%20purely%20'visual'%20-%20it's%20just%20a%20handy%20helper%20for%20a%20common%20case%20(that%20could%20otherwise%20be%20solved%20with%20%60render%60)%5Cn%20%20%20%20%20%20if(!startWithRegex)%20startWithRegex%20=%20new%20RegExp(%5C%22%5E%5C%22+escapeRegExp(concreteInputs.startWith));%5Cn%20%20%20%20%20%20response%20=%20response.replace(startWithRegex,%20%5C%22%5C%22);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData.render)%20%7B%5Cn%20%20%20%20%20%20response%20=%20inputData.render(%7Btext:response,%20isPartial:!opts.isFinalRender%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20if(typeof%20inputData.outputTo.value%20==%20%5C%22string%5C%22)%20%7B%20//%20textarea,%20input,%20or%20user's%20custom%20object%20with%20string%20%60.value%60%20property%5Cn%20%20%20%20%20%20%20%20inputData.outputTo.value%20=%20inputData.render%20?%20inputData.render(%7Btext:response,%20isPartial:!opts.isFinalRender%7D)%20:%20response;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20inputData.outputTo.innerHTML%20=%20response;%5Cn%20%20%20%20%20%20%20%20if(opts.addEndButtons)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20responseEndButtonsCtn.title%20=%20%60Inputs%20that%20were%20used:%5C%5Cn%5C%5Cninstruction=$%7BconcreteInputs.instruction%7D%5C%5Cn%5C%5CnstartWith=$%7BconcreteInputs.startWith%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20inputData.outputTo.append(responseEndButtonsCtn);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20if(typeof%20placeholderEl.value%20==%20%5C%22string%5C%22)%20%7B%20//%20textarea,%20input,%20or%20user's%20custom%20object%20with%20string%20%60.value%60%20property%5Cn%20%20%20%20%20%20%20%20placeholderEl.value%20=%20response;%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20placeholderEl.innerHTML%20=%20response;%5Cn%20%20%20%20%20%20%20%20if(opts.addEndButtons)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20responseEndButtonsCtn.title%20=%20%60Inputs%20that%20were%20used:%5C%5Cn%5C%5Cninstruction=$%7BconcreteInputs.instruction%7D%5C%5Cn%5C%5CnstartWith=$%7BconcreteInputs.startWith%7D%60;%5Cn%20%20%20%20%20%20%20%20%20%20placeholderEl.append(responseEndButtonsCtn);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20async%20function%20startStreamingResponse()%20%7B%5Cn%20%20%20%20try%20%7B%5Cn%20%20%20%20%20%20let%20chunks%20=%20%5B%5D;%5Cn%20%20%20%20%20%20let%20generatedChunks%20=%20%5B%5D;%20//%20difference%20from%20%60chunks%60%20is%20that%20this%20doesn't%20include%20the%20user-specified%20%60startWith%60%20text%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20(async%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20while(true)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(userStoppedGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22stopping%20keepalives%20due%20to%20%60userStoppedGeneration%60%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(finishedGenerating)%20%7B%20console.log(%5C%22stopping%20keepalives%20due%20to%20%60finishedGenerating%60%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!document.querySelector(%60#$%7BcompletionId%7D%60))%20%7B%20console.log(%5C%22stopping%20keepalives%20due%20to%20%60placeholderEl%60%5C%22);%20break;%20%7D%20//%20placeholderEl%20no%20longer%20exists%20in%20the%20DOM,%20so%20user%20probably%20clicked%20'randomize'%20or%20whatever%20while%20previous%20one%20was%20still%20loading,%20hence%20we%20abort%20previous%20one%20by%20stopping%20the%20keepalives,%20which%20drops%20it%20from%20the%20queue%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.outputTo%20&&%20(!document.body.contains(inputData.outputTo)%20%7C%7C%20inputData.outputTo.dataset.aiTextCompletionId%20!==%20completionId))%20%20%7B%20console.log(%5C%22stopping%20keepalives%20due%20to%20%60outputTo%60%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(lastGeneratedChunkRecievedTime%20!==%20null%20&&%20Date.now()-lastGeneratedChunkRecievedTime%20%3E%201000*20)%20%20%7B%20console.log(%5C%22stopping%20keepalives%20due%20to%20generation%20having%20started%20but%20no%20new%20chunks%20recieved%20in%2020%20seconds%5C%22);%20break;%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22streamKeepAlive%5C%22,%20requestId:completionId%20%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22streamKeepAlive%20sent%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(window.devTest98375290385)%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%2010000000000));%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20stop();%20//%20need%20to%20call%20stop()%20here%20(and%20not%20just%20wait%20for%20it%20to%20be%20called%20in%20streamTextFromIframe)%20because%20otherwise%20it%20only%20gets%20called%20if%20streamTextFromIframe%20gets%20called%20again,%20which%20it%20*might%20not*%5Cn%20%20%20%20%20%20%7D)();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20gotFirstChunk%20=%20false;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20stop()%20%7B%5Cn%20%20%20%20%20%20%20%20if(finishedGenerating)%20return;%5Cn%20%20%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(!gotFirstChunk%20&&%20placeholderEl)%20placeholderEl.innerHTML%20=%20%5C%22%5C%22;%20//%20clear%20the%20svg%20'loading'%20dots%5Cn%5Cn%20%20%20%20%20%20%20%20let%20finishData%20=%20%7Btext:chunks.join(%5C%22%5C%22),%20generatedText:generatedChunks.join(%5C%22%5C%22),%20stopReason:%5C%22user%5C%22%7D;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(inputData.onFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20try%20%7B%20inputData.onFinish(finishData);%20%7D%20catch(e)%20%7B%20console.error(%5C%22error%20in%20onFinish:%5C%22,%20e);%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20textStreamController.close();%5Cn%20%20%20%20%20%20%20%20onFinishPromiseResolver(finishData);%5Cn%20%20%20%20%20%20%20%20generatedText%20=%20generatedChunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20streamTextFromIframe(function(data)%20%7B%5Cn%20%20%20%20%20%20%20%20if(userStoppedGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stop();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!document.querySelector(%60#$%7BcompletionId%7D%60))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stop();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(inputData.outputTo%20&&%20(!document.body.contains(inputData.outputTo)%20%7C%7C%20inputData.outputTo.dataset.aiTextCompletionId%20!==%20completionId))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(!finishedGenerating)%20stop();%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(finishedGenerating)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22We%20received%20a%20chunk%20of%20text%20even%20though%20we've%20already%20finishedGenerating?%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20add%20the%20startWith%20chunk%20before%20the%20first%20'real'%20chunk:%5Cn%20%20%20%20%20%20%20%20if(data.isFirstChunk%20&&%20concreteInputs.startWith)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20chunks.push(concreteInputs.startWith);%5Cn%20%20%20%20%20%20%20%20%20%20textStreamController.enqueue(concreteInputs.startWith);%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.onChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputData.onChunk(%7BfullTextSoFar:chunks.join(%5C%22%5C%22),%20textChunk:concreteInputs.startWith,%20isFromStartWith:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(data.error)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20allChunksJoined%20=%20chunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20concreteInputs.startWith%20=%20allChunksJoined;%5Cn%20%20%20%20%20%20%20%20%20%20renderResponseTextIntoContainer(allChunksJoined,%20%7BaddEndButtons:true,%20isFinalRender:true%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20let%20finishData%20=%20%7Btext:allChunksJoined,%20generatedText:generatedChunks.join(%5C%22%5C%22),%20stopReason:%5C%22error%5C%22%7D;%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.onFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputData.onFinish(finishData);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20textStreamController.close();%5Cn%20%20%20%20%20%20%20%20%20%20onFinishPromiseResolver(finishData);%5Cn%20%20%20%20%20%20%20%20%20%20generatedText%20=%20generatedChunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20generationLastKnownToBeWorkingAt%20=%20Date.now();%5Cn%20%20%20%20%20%20%20%20%20%20if(data.isFirstChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20gotFirstChunk%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(placeholderEl)%20placeholderEl.innerHTML%20=%20%5C%22%5C%22;%20//%20clear%20the%20svg%20'loading'%20dots%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(inputData.beforeFirstChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputData.beforeFirstChunk(%7B%7D);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20generatedChunks.push(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20chunks.push(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20textStreamController.enqueue(data.text);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20if(inputData.onChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20inputData.onChunk(%7BfullTextSoFar:chunks.join(%5C%22%5C%22),%20textChunk:data.text%7D);%20//%20%60data.text%60%20is%20the%20full%20text%20so%20far%20(like%20in%20onFinish,%20render,%20etc.),%20and%20%60data.chunk%60%20is%20the%20most%20recent%20chunk%20(the%20one%20that%20triggered%20this%20call%20to%20onChunk)%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20renderResponseTextIntoContainer(chunks.join(%5C%22%5C%22),%20%7BaddEndButtons:!!data.isLastChunk,%20isFinalRender:!!data.isLastChunk%7D);%5Cn%20%20%20%20%20%20%20%20%20%20if(data.isLastChunk)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22FINISHED%20STREAMING.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20finishedGeneratingSuccessfully%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20concreteInputs.startWith%20=%20chunks.join(%5C%22%5C%22);%20//%20update%20the%20startWith%20for%20'continue'%20and%20'edit'%20button%20use%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20finishData%20=%20%7Btext:chunks.join(%5C%22%5C%22),%20generatedText:generatedChunks.join(%5C%22%5C%22),%20stopReason:data.stopReason%7D;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(inputData.onFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20inputData.onFinish(finishData);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20textStreamController.close();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20onFinishPromiseResolver(finishData);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20generatedText%20=%20generatedChunks.join(%5C%22%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%20%20%20%20%5Cn%5Cn%20%20%20%20%7D%20catch(e)%20%7B%5Cn%20%20%20%20%20%20thereWasAnErrorDuringGeneration%20=%20true;%5Cn%20%20%20%20%20%20finishedGenerating%20=%20true;%5Cn%20%20%20%20%20%20onFinishPromiseRejecter();%5Cn%20%20%20%20%20%20console.error(e);%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%201000));%5Cn%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22verifyUser%5C%22%7D,%20serverOrigin);%20//%20probably%20not%20necessary,%20but%20just%20in%20case%20(it'll%20only%20re-verify%20if%20it's%20actually%20needed%20anyway)%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20function%20onVisible(element,%20callback)%20%7B%5Cn%20%20%20%20new%20IntersectionObserver((entries,%20observer)%20=%3E%20%7B%5Cn%20%20%20%20%20%20entries.forEach(entry%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(entry.intersectionRatio%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20callback(element);%5Cn%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%7D).observe(element);%5Cn%20%20%20%20if(!callback)%20return%20new%20Promise(r%20=%3E%20callback=r);%5Cn%20%20%7D%5Cn%20%20%20%20%5Cn%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20//%20give%20placeholderEl%20a%20chance%20to%20be%20put%20into%20the%20DOM%5Cn%20%20%20%20placeholderEl%20=%20document.querySelector(%60#$%7BcompletionId%7D%60);%20//%20this%20will%20be%20null%20if%20they're%20using%20outputTo%20or%20are%20just%20doing%20things%20fully%20manually%20onFinishPromise/onChunk/etc.%5Cn%20%20%20%20if(placeholderEl)%20placeholderElDidInitiallyExist%20=%20true;%5Cn%20%20%20%20//%20wait%20for%20placeholderEl%20to%20become%20visible:%5Cn%20%20%20%20if(placeholderElDidInitiallyExist%20&&%20!inputData.outputTo)%20%7B%5Cn%20%20%20%20%20%20await%20onVisible(placeholderEl);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(inputData.onStart)%20%7B%5Cn%20%20%20%20%20%20inputData.onStart(syncOutputObj);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20startStreamingResponse();%20%5Cn%20%20%7D,%20100);%5Cn%20%20%5Cn%20%20let%20beforeLoaderHtml%20=%20%5C%22%5C%22;%5Cn%20%20if(!inputData.outputTo%20&&%20!hideStartWith)%20%7B%5Cn%20%20%20%20beforeLoaderHtml%20=%20inputData.render%20?%20inputData.render(%7Btext:concreteInputs.startWith,%20isPartial:true%7D)%20:%20concreteInputs.startWith;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(inputData.outputTo)%20%7B%5Cn%20%20%20%20inputData.outputTo.dataset.aiTextCompletionId%20=%20completionId;%20//%20this%20is%20used%20for%20keepalive%20stuff%20-%20if%20a%20queued%20request%20is%20going%20to%20output%20to%20an%20outputTo%20element,%20but%20that%20element%20no%20longer%20has%20the%20correct%20%60dataset.aiTextCompletionId%60%20then%20we%20drop%20it%20from%20the%20queue%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20syncOutputObj%20=%20%7B%5Cn%20%20%20%20inputs:%20originalConcreteInputs,%5Cn%20%20%20%20textStream,%5Cn%20%20%20%20onFinishPromise,%5Cn%20%20%20%20stop:%20()%20=%3E%20%7B%20//%20note:%20this%20can't%20actually%20stop%20a%20request%20if%20it%20has%20already%20started,%20since%20the%20server%20doesn't%20currently%20support%20that%20-%20it%20just%20drops%20the%20request%20from%20the%20queue%20if%20it%20is%20still%20waiting.%5Cn%20%20%20%20%20%20userStoppedGeneration%20=%20true;%5Cn%20%20%20%20%7D,%5Cn%20%20%20%20id:%20completionId,%5Cn%20%20%20%20loadingIndicatorHtml:%20animatedLoadingSvg,%20//%20%3C--%20just%20a%20littler%20helper%20for%20people%20who%20are%20e.g.%20using%20onFinishPromise/onChunk/etc.%20but%20want%20to%20add%20a%20loading%20indicator%20to%20the%20page%20manually%5Cn%20%20%20%20toString:%20function()%20%7B%20//%20this%20object%20stringifies%20into%20the%20default%20placeholder%20element%5Cn%20%20%20%20%20%20return%20%60%3Cspan%20class=%5C%22ai-text-response-ctn%5C%22%20id=%5C%22$%7BcompletionId%7D%5C%22%20style=%5C%22white-space:pre-wrap;%20$%7BinputData.style%20?%20inputData.style%20:%20%5C%22%5C%22%7D%5C%22%3E$%7BbeforeLoaderHtml%7D$%7BanimatedLoadingSvg%7D%3C/span%3E%60;%5Cn%20%20%20%20%7D,%5Cn%20%20%20%20submitUserRating:%20async%20(%7Bscore,%20reason%7D)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(!finishedGenerating%20%7C%7C%20thereWasAnErrorDuringGeneration)%20%7B%5Cn%20%20%20%20%20%20%20%20console.error(thereWasAnErrorDuringGeneration%20?%20%5C%22cannot%20rate%20because%20there%20was%20an%20error%20during%20generation%5C%22%20:%20%5C%22cannot%20rate%20because%20it%20hasn't%20finished%20generating%20yet%5C%22);%5Cn%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(isNaN(Number(score))%20%7C%7C%20Number(score)%20%3E%201%20%7C%7C%20Number(score)%20%3C%200)%20return%20alert(%60User%20rating%20should%20be%20a%20value%20between%200%20(bad)%20and%201%20(good).%20Like%200.4%20or%200.8,%20for%20example.%60);%5Cn%20%20%20%20%20%20score%20=%20Number(score);%5Cn%20%20%20%20%20%20if(!reason)%20reason%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20iframe.contentWindow.postMessage(%7B%20type:%20%5C%22rateGeneratedText%5C%22,%20instruction,%20startWith,%20generatedText,%20generatorName:window.generatorName,%20score,%20reason%20%7D,%20serverOrigin);%5Cn%20%20%20%20%7D,%5Cn%20%20%7D;%5Cn%20%20return%20syncOutputObj;%5Cn%20%20%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cn%5Cncharacter%5Cn%20%20%7Bmech%7Cdemon%7Ccyberpunk%7D%20%7Bwarrior%7Cminion%7Csamurai%7D%5Cn%5Cnplace%5Cn%20%20a%20retropunk%20distopia%5Cn%20%20a%20small%20village%5Cn%20%20a%20mountainous%20region%5Cn%20%20an%20underwater%20cavern%5Cn%20%20a%20=%2010%5Cn%5Cnseason%5Cn%20%20winter%5Cn%20%20summer%5Cn%20%20%5CnpoemPrompt%5Cn%20%20instruction%20=%20Write%20a%204%20line%20poem%20about%20a%20%5Bcharacter%5D%20in%20%5Bplace%5D%20during%20%5Bseason%5D.%5Cn%5Cn%5Cn%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1713927624019,%22found%22:true%7D,%7B%22name%22:%22comments-plugin%22,%22modelText%22:%22$output(opts)%20=%3E%5Cn%20%20if(!opts)%20opts%20=%20%7B%7D;%5Cn%20%20if(!opts.width)%20opts.width%20=%20%5C%22300px%5C%22;%5Cn%20%20if(!opts.height)%20opts.height%20=%20%5C%22250px%5C%22;%20%5Cn%20%20if(typeof%20opts.width%20===%20%5C%22number%5C%22)%20opts.width%20+=%20%5C%22px%5C%22;%20%20%20%20%5Cn%20%20if(typeof%20opts.height%20===%20%5C%22number%5C%22)%20opts.height%20+=%20%5C%22px%5C%22;%5Cn%20%20let%20containerStyle%20=%20opts.containerStyle%20%7C%7C%20opts.style%20%7C%7C%20%60width:$%7Bopts.width%7D;%20height:$%7Bopts.height%7D;%60;%5Cn%20%20%5Cn%20%20let%20iframeUniqueId%20=%20%5C%22id%5C%22+Math.random().toString().replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22)+%20Math.random().toString().replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20let%20ctx%20=%20%7B%7D;%5Cn%20%20ctx.currentInputElText%20=%20%5C%22%5C%22;%5Cn%20%20ctx.iframeUniqueId%20=%20iframeUniqueId;%5Cn%20%20%5Cn%20%20function%20addMethodsToReturnValue(stringObj)%20%7B%5Cn%20%20%20%20stringObj.submit%20=%20async%20function(optionalText)%20%7B%5Cn%20%20%20%20%20%20//%20Note:%20if%20optionalText%20is%20specified,%20that%20text%20will%20be%20submitted%20instead%20of%20what's%20currently%20in%20the%20text%20box,%20and%20the%20text%20box%20will%20not%20be%20cleared%20after%20submission.%5Cn%20%20%20%20%20%20if(optionalText)%20optionalText%20=%20optionalText.toString();%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20resolver;%5Cn%20%20%20%20%20%20let%20promise%20=%20new%20Promise(r%20=%3E%20resolver=r);%5Cn%20%20%20%20%20%20let%20requestId%20=%20Math.random();%5Cn%20%20%20%20%20%20async%20function%20messageHandler(e)%20%7B%5Cn%20%20%20%20%20%20%20%20if(e.origin%20!==%20%5C%22https://comments-plugin.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20%20%20if(e.source%20!==%20ctx.iframeContentWindow)%20return;%5Cn%20%20%20%20%20%20%20%20if(e.data.requestId%20!==%20requestId)%20return;%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(e.data.type%20===%20%5C%22message_submit_response%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%60parent%20frame%20got%20message_submit_response:%60,%20e.data.success);%5Cn%20%20%20%20%20%20%20%20%20%20resolver(%7Bsuccess:e.data.success%7D);%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.warn(%5C%22Invalid%20event%20type%20for%20this%20requestId?%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20window.removeEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20messageHandler);%5Cn%20%20%20%20%20%20while(!ctx.finishedLoading)%20%7B%20console.log(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20load%20before%20sending%20.submit()%20postMessage%5C%22);%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%20%7D%5Cn%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22trigger_programmatic_submit%5C%22,%20text:optionalText,%20channel:ctx.urlHashData.channel%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20return%20promise;%5Cn%20%20%20%20%7D;%5Cn%20%20%20%20%5Cn%20%20%20%20Object.defineProperty(stringObj,%20'inputText',%20%7B%5Cn%20%20%20%20%20%20get:%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20return%20ctx.currentInputElText;%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%20%20set:%20function(value)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.currentInputElText%20=%20value;%5Cn%20%20%20%20%20%20%20%20ctx.iframeContentWindow.postMessage(%7Btype:%5C%22set_input_el_text%5C%22,%20channel:ctx.urlHashData.channel,%20text:value%7D,%20%5C%22https://comments-plugin.perchance.org%5C%22);%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20Object.defineProperty(stringObj,%20'comments',%20%7B%5Cn%20%20%20%20%20%20get:%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20return%20ctx.allComments.slice(0);%5Cn%20%20%20%20%20%20%7D,%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20TODO:%20add%20a%20getMessages%20function%20which%20gets%20all%20current%20messages%5Cn%20%20%20%20%5Cn%20%20%20%20return%20stringObj;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20queryParams%20=%20%7B%7D;%5Cn%20%20if(opts.adminPasswordHash)%20queryParams.adminPasswordHash%20=%20opts.adminPasswordHash.evaluateItem;%5Cn%20%20%5Cn%20%20let%20urlHashData%20=%20%7B%7D;%5Cn%20%20urlHashData.iframeUniqueId%20=%20iframeUniqueId;%5Cn%20%20if(opts.adminPasswordHash)%20urlHashData.adminPasswordHash%20=%20opts.adminPasswordHash;%5Cn%20%20if(opts.bannedWords)%20%7B%5Cn%20%20%20%20if(typeof%20opts.bannedWords%20===%20%5C%22string%5C%22)%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.trim().split(%5C%22,%5C%22).map(w%20=%3E%20w.trim()).filter(w%20=%3E%20w);%5Cn%20%20%20%20%7D%20else%20if(!opts.bannedWords.getLength%20&&%20opts.getPropertyNames%20&&%20opts.getPropertyNames.includes(%5C%22bannedWords%5C%22))%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.getRawListText.split(%5C%22=%5C%22).slice(1).join(%5C%22=%5C%22).trim().split(%5C%22,%5C%22).map(w%20=%3E%20w.trim()).filter(w%20=%3E%20w);%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20urlHashData.bannedWords%20=%20opts.bannedWords.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22));%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%5Cn%20%20if(opts.commentPlaceholderText)%20urlHashData.commentPlaceholderText%20=%20opts.commentPlaceholderText.evaluateItem;%5Cn%20%20if(opts.submitButtonText)%20urlHashData.submitButtonText%20=%20opts.submitButtonText.evaluateItem;%5Cn%20%20if(opts.submitButtonSuccessText)%20urlHashData.submitButtonSuccessText%20=%20opts.submitButtonSuccessText.evaluateItem;%5Cn%20%20if(opts.hideComments)%20urlHashData.hideComments%20=%20opts.hideComments;%5Cn%20%20if(opts.hideDates)%20urlHashData.hideDates%20=%20opts.hideDates;%5Cn%20%20if(opts.hideCommentsBeforeDate)%20urlHashData.hideCommentsBeforeDate%20=%20opts.hideCommentsBeforeDate;%5Cn%20%20%5Cn%20%20if(opts.hideSettingsButton)%20urlHashData.hideSettingsButton%20=%20opts.hideSettingsButton;%5Cn%20%20if(opts.hideFullscreenButton)%20urlHashData.hideFullscreenButton%20=%20opts.hideFullscreenButton;%5Cn%20%20if(opts.submitButtonStyle)%20urlHashData.submitButtonStyle%20=%20opts.submitButtonStyle.evaluateItem;%5Cn%20%20if(opts.settingsButtonStyle)%20urlHashData.settingsButtonStyle%20=%20opts.settingsButtonStyle.evaluateItem;%5Cn%20%20if(opts.fullscreenButtonStyle)%20urlHashData.fullscreenButtonStyle%20=%20opts.fullscreenButtonStyle.evaluateItem;%5Cn%20%20if(opts.messageBubbleStyle)%20urlHashData.messageBubbleStyle%20=%20opts.messageBubbleStyle.evaluateItem;%5Cn%20%20if(opts.messageFeedStyle)%20urlHashData.messageFeedStyle%20=%20opts.messageFeedStyle.evaluateItem;%5Cn%20%20if(opts.inputAreaStyle)%20urlHashData.inputAreaStyle%20=%20opts.inputAreaStyle.evaluateItem;%5Cn%20%20if(opts.loadFonts)%20urlHashData.loadFonts%20=%20opts.loadFonts.evaluateItem;%5Cn%20%20if(opts.forceColorScheme)%20urlHashData.forceColorScheme%20=%20opts.forceColorScheme.evaluateItem;%5Cn%20%20if(opts.channelLabel)%20urlHashData.channelLabel%20=%20opts.channelLabel.evaluateItem;%5Cn%20%20%5Cn%20%20%5Cn%20%20if(opts.adminFlair)%20urlHashData.adminFlair%20=%20opts.adminFlair.evaluateItem;%5Cn%20%20if(opts.deleteButtonIcon)%20urlHashData.deleteButtonIcon%20=%20opts.deleteButtonIcon.evaluateItem;%5Cn%20%20if(opts.bannedUsers)%20urlHashData.bannedUsers%20=%20opts.bannedUsers.joinItems(%5C%22,%5C%22);%5Cn%20%20if(opts.rateLimits)%20urlHashData.rateLimits%20=%20opts.rateLimits;%5Cn%20%20if(opts.slashCommands)%20urlHashData.slashCommands%20=%20encodeURIComponent(JSON.stringify(opts.slashCommands));%5Cn%20%20if(opts.customEmojiSize)%20urlHashData.customEmojiSize%20=%20opts.customEmojiSize;%5Cn%20%20if(opts.loneCustomEmojiSizeMultiplier)%20urlHashData.loneCustomEmojiSizeMultiplier%20=%20opts.loneCustomEmojiSizeMultiplier;%5Cn%20%20if(opts.customEmojis)%20%7B%5Cn%20%20%20%20if(typeof%20opts.customEmojis%20===%20%5C%22string%5C%22%20&&%20opts.customEmojis.startsWith(%5C%22https://user-uploads.perchance.org%5C%22))%20%7B%5Cn%20%20%20%20%20%20urlHashData.customEmojis%20=%20opts.customEmojis.trim();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20let%20text%20=%20opts.customEmojis.getRawListText;%5Cn%20%20%20%20%20%20text%20=%20text.slice(text.indexOf(%5C%22%5C%5Cn%5C%22)).trim();%20//%20remove%20list%20name%5Cn%20%20%20%20%20%20//%20note:%20no%20need%20to%20remove%20indentation%20-%20parsing%20code%20in%20embed%20does%20that%20performantly%5Cn%20%20%20%20%20%20urlHashData.customEmojis%20=%20text;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20urlHashData.channel%20=%20opts.channel%20?%20opts.channel.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20if(!window.___commentsPluginSlashCommandsByChannel12321)%20window.___commentsPluginSlashCommandsByChannel12321%20=%20%7B%7D;%5Cn%20%20window.___commentsPluginSlashCommandsByChannel12321%5BurlHashData.channel%5D%20=%20opts.slashCommands;%20%20%20%20%5Cn%20%20%5Cn%20%20let%20folderName%20=%20window.generatorName;%20%5Cn%20%20if(opts.channel)%20%7B%5Cn%20%20%20%20let%20channel%20=%20opts.channel.evaluateItem;%5Cn%20%20%20%20if(!/%5E%5Ba-z0-9%5C%5C-%5D+$/.test(channel))%20return%20%60(ERROR:%20You%20gave%20a%20channel%20name%20of%20'$%7Bchannel%7D'%20to%20the%20comments%20plugin,%20but%20channel%20names%20can%20only%20contain%20lower-case%20letters,%20numbers,%20and%20hyphens,%20like%20'my-cool-channel-33'.)%60;%5Cn%20%20%20%20folderName%20+=%20%60+$%7Bchannel%7D%60;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20I've%20deprecated%20%60reverseCommentOrder%60,%20but%20it%20won't%20hurt%20existing%20implementations%20because%20the%20%5C%22reversed%5C%22%20order%20(new%20comments%20at%20bottom)%20is%20now%20default.%5Cn%20%20//%20if(opts.reverseCommentOrder)%20urlHashData.reverseCommentOrder%20=%20opts.reverseCommentOrder;%5Cn%20%20urlHashData.reverseCommentOrder%20=%20true;%5Cn%20%20if(opts.newestCommentsAtTop)%20urlHashData.reverseCommentOrder%20=%20false;%20%5Cn%20%20%5Cn%20%20let%20queryString%20=%20new%20URLSearchParams(queryParams).toString();%5Cn%20%20%5Cn%20%20let%20loadMoreButton%20=%20document.createElement(%5C%22button%5C%22);%5Cn%20%20let%20originalLoadMoreButtonTextContent%20=%20%5C%22load%20more%5C%22;%5Cn%20%20let%20postMessageSource%20=%20null;%5Cn%20%20loadMoreButton.innerHTML%20=%20originalLoadMoreButtonTextContent;%5Cn%20%20loadMoreButton.style.cssText%20=%20%5C%22display:none;%20margin:0.5rem%20auto;%5C%22;%5Cn%20%20loadMoreButton.addEventListener(%5C%22click%5C%22,%20function()%20%7B%5Cn%20%20%20%20originalLoadMoreButtonTextContent%20=%20loadMoreButton.textContent;%5Cn%20%20%20%20loadMoreButton.textContent%20=%20%5C%22loading...%5C%22;%5Cn%20%20%20%20loadMoreButton.disabled%20=%20true;%5Cn%20%20%20%20document.querySelector(%60.$%7BiframeUniqueId%7D%60).contentWindow.postMessage(%7BiframeUniqueId,%20loadMoreButtonClick:true%7D,%20%5C%22*%5C%22);%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20ctx.loadMoreButton%20=%20loadMoreButton;%5Cn%20%20ctx.opts%20=%20opts;%5Cn%20%20ctx.urlHashData%20=%20urlHashData;%5Cn%20%20ctx.allComments%20=%20%5B%5D;%5Cn%20%20ctx.alreadyGotCommentIds%20=%20new%20Set();%5Cn%20%20%5Cn%20%20if(!window.___alreadyAddedCommentsPluginStuff43211234)%20%7B%5Cn%20%20%5Cn%20%20%20%20window.___commentsPluginIframeUniqueIdToContext%20=%20new%20Map();%5Cn%20%20%20%20%5Cn%20%20%20%20//%20the%20iframe%20send%20us%20a%20message%20when%20it%20is%20finished%20loading%20(this%20is%20to%20get%20around%20Glitch's%20uncustomizable%20loading%20screens)%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20async%20function(e)%20%7B%5Cn%20%20%20%20%20%20if(e.origin%20!==%20%5C%22https://comments-plugin.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20if(!e.data.iframeUniqueId)%20return;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20May%20need%20to%20wait%20a%20moment%20for%20the%20replacedDuringUpdate%20iframes%20to%20be%20'tracked'%20since%20my%20current%20code%20hackily%20does%20that%20with%20a%20'polling'%20method.%5Cn%20%20%20%20%20%20while(!window.___commentsPluginIframeUniqueIdToContext.get(e.data.iframeUniqueId))%20%7B%20console.log(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20be%20tracked.%5C%22);%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20ctx%20=%20window.___commentsPluginIframeUniqueIdToContext.get(e.data.iframeUniqueId)%5Cn%20%20%20%20%20%20let%20opts%20=%20ctx.opts%5Cn%20%20%20%20%20%20let%20loadMoreButton%20=%20ctx.loadMoreButton;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20if(e.data.type%20===%20%5C%22perchance_comments_new_message_added%5C%22)%20%7B%5Cn%20%20%20%20%20%20//%20%20%20console.log(%5C%22new%20message:%5C%22,%20e.data.messageData);%5Cn%20%20%20%20%20%20//%20%20%20console.log(%5C%22event:%5C%22,%20e);%5Cn%20%20%20%20%20%20//%20%20%20console.log(%5C%22window.___commentsPluginIframeContentWindowToContext:%5C%22,%20window.___commentsPluginIframeUniqueIdToContext);%5Cn%20%20%20%20%20%20//%20%20%20console.log(%5C%22ctx:%5C%22,%20ctx);%5Cn%20%20%20%20%20%20//%20%20%20console.log(%5C%22opts:%5C%22,%20opts);%5Cn%20%20%20%20%20%20//%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(e.data.type%20===%20%5C%22perchance_comments_new_message_added%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.allComments.push(e.data.messageData);%5Cn%20%20%20%20%20%20%20%20ctx.alreadyGotCommentIds.add(e.data.messageData.id);%5Cn%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(opts.onComment)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20opts.onComment(e.data.messageData);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22input_el_text_change%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%60parent%20frame%20got%20input_el_text_change:%60,%20e.data.text);%5Cn%20%20%20%20%20%20%20%20ctx.currentInputElText%20=%20e.data.text;%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_on_load_data%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.allComments.push(...e.data.onLoadData.comments.filter(c%20=%3E%20!ctx.alreadyGotCommentIds.has(c.id)));%5Cn%20%20%20%20%20%20%20%20e.data.onLoadData.comments.forEach(c%20=%3E%20ctx.alreadyGotCommentIds.add(c.id));%5Cn%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20postMessageSource%20=%20e.source;%5Cn%20%20%20%20%20%20%20%20if(opts.onLoad)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(e.data.onLoadData.comments.length%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22block%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20if(e.data.noMoreCommentsBeforeThis)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20opts.onLoad(e.data.onLoadData.comments,%20%7BloadMoreButton%7D);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_on_load_more%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.allComments.push(...e.data.onLoadMoreData.comments.filter(c%20=%3E%20!ctx.alreadyGotCommentIds.has(c.id)));%5Cn%20%20%20%20%20%20%20%20e.data.onLoadData.comments.forEach(c%20=%3E%20ctx.alreadyGotCommentIds.add(c.id));%5Cn%20%20%20%20%20%20%20%20ctx.allComments.sort((a,b)%20=%3E%20a.time-b.time);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(e.data.onLoadMoreData.comments.length%20%3E%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.disabled%20=%20false;%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.textContent%20=%20originalLoadMoreButtonTextContent;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(e.data.noMoreCommentsBeforeThis)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20if(opts.onLoadMore)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20opts.onLoadMore(e.data.onLoadMoreData.comments);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_load_more_no_more%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20loadMoreButton.style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22perchance_comments_finished_loading%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20ctx.finishedLoading%20=%20true;%5Cn%20%20%20%20%20%20%20%20//%20hide%20the%20loader%20of%20the%20iframe:%5Cn%20%20%20%20%20%20%20%20document.querySelector(%60.$%7Be.data.iframeUniqueId%7D%60).closest(%5C%22.comments-plugin-ctn%5C%22).querySelector(%5C%22.__perchance-comments-loading-facade-12345%5C%22).style.display%20=%20%5C%22none%5C%22;%5Cn%20%20%20%20%20%20%20%20//%20and%20tell%20it%20its%20parent%20origin:%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BparentOrigin:window.origin%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22evaluateText%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20result%20=%20e.data.text.evaluateItem;%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BrequestId:e.data.requestId,%20result%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22slash_command%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20commandName%20=%20e.data.commandName;%5Cn%20%20%20%20%20%20%20%20let%20argText%20=%20e.data.argText;%5Cn%20%20%20%20%20%20%20%20let%20slashCommands%20=%20window.___commentsPluginSlashCommandsByChannel12321%5Be.data.channel%5D;%5Cn%20%20%20%20%20%20%20%20if(slashCommands%5BcommandName%5D%20===%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20alert(%5C%22Please%20refresh%20the%20page%20before%20testing%20newly-added%20commands.%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20slashCommands%5BcommandName%5D.input%20=%20argText;%5Cn%20%20%20%20%20%20%20%20let%20resultText%20=%20slashCommands%5BcommandName%5D.output.evaluateItem;%5Cn%20%20%20%20%20%20%20%20e.source.postMessage(%7BrequestId:e.data.requestId,%20resultText%7D,%20e.origin);%5Cn%20%20%20%20%20%20%7D%20else%20if(e.data.type%20===%20%5C%22toggle_fullscreen%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20iframe%20=%20document.querySelector(%60.$%7Be.data.iframeUniqueId%7D%60);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20//%20If%20iframe%20is%20currently%20fullscreen,%20then%20it's%20not%20in%20a%20%60ctn%60,%20so%20we%20use%20the%20pre-assigned%20data-comments-ctn-id%20to%20find%20the%20iframe's%20ctn%20so%20we%20can%20put%20it%20back%20in:%5Cn%20%20%20%20%20%20%20%20let%20ctn%20=%20iframe.closest(%5C%22.comments-plugin-ctn%5C%22)%20%7C%7C%20document.querySelector(%60%5Bdata-comments-ctn-id=%5C%22$%7Biframe.dataset.commentsCtnId%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20if(ctn.dataset.isFullscreen%20===%20%5C%22no%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20document.body.appendChild(iframe);%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.position%20=%20%5C%22fixed%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.zIndex%20=%20%5C%22999999999%5C%22;%20//%20%3C--%20caution:%20don't%20lower%20this%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.top%20=%20%5C%220%5C%22;%20iframe.style.left%20=%20%5C%220%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22hidden%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22yes%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20//%20link%20the%20iframe%20and%20ctn%20with%20an%20id%20so%20we%20can%20get%20the%20ctn,%20given%20the%20id%20from%20the%20iframe%20that%20sent%20the%20%5C%22toggle_fullscreen%5C%22%20message:%5Cn%20%20%20%20%20%20%20%20%20%20let%20commentsCtnId%20=%20Math.random();%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.commentsCtnId%20=%20commentsCtnId;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.dataset.commentsCtnId%20=%20commentsCtnId;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20ctn.appendChild(iframe);%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.position%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.zIndex%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20iframe.style.top%20=%20%5C%22%5C%22;%20iframe.style.left%20=%20%5C%22%5C%22;%20%5Cn%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22no%5C%22;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20if(ctn.dataset.isFullscreen%20===%20%5C%22no%5C%22)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssHeight%20=%20ctn.style.height;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssWidth%20=%20ctn.style.width;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssPosition%20=%20ctn.style.position;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalCssZIndex%20=%20ctn.style.zIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20//%20we%20need%20to%20change%20the%20ancestor%20z%20indices%20too:%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorEls%20=%20%5B%5D;%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20aEl%20=%20ctn.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20while(aEl%20!==%20document.body)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20ancestorEls.push(aEl);%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20aEl%20=%20aEl.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorZIndices%20=%20ancestorEls.map(el%20=%3E%20el.style.zIndex);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.originalAncestorZIndices%20=%20JSON.stringify(ancestorZIndices);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ancestorEls.forEach(el%20=%3E%20el.style.zIndex=%5C%2263829472%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.height%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.width%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.position%20=%20%5C%22fixed%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.zIndex%20=%20%5C%2263829472%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.top%20=%20%5C%220%5C%22;%20ctn.style.left%20=%20%5C%220%5C%22;%20ctn.style.right%20=%20%5C%220%5C%22;%20ctn.style.bottom%20=%20%5C%220%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22hidden%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22yes%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%7D%20else%20if(ctn.dataset.isFullscreen%20===%20%5C%22yes%5C%22)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.height%20=%20ctn.dataset.originalCssHeight;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.width%20=%20ctn.dataset.originalCssWidth;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.position%20=%20ctn.dataset.originalCssPosition;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.zIndex%20=%20ctn.dataset.originalCssZIndex;%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20ancestorEls%20=%20%5B%5D;%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20aEl%20=%20ctn.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20while(aEl%20!==%20document.body)%20%7B%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20ancestorEls.push(aEl);%5Cn//%20%20%20%20%20%20%20%20%20%20%20%20%20aEl%20=%20aEl.parentElement;%5Cn//%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn//%20%20%20%20%20%20%20%20%20%20%20let%20originalAncestorZIndices%20=%20JSON.parse(ctn.dataset.originalAncestorZIndices);%5Cn//%20%20%20%20%20%20%20%20%20%20%20ancestorEls.forEach((el,%20i)%20=%3E%20el.style.zIndex=originalAncestorZIndices%5Bi%5D);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.style.top%20=%20%5C%22%5C%22;%20ctn.style.left%20=%20%5C%22%5C%22;%20ctn.style.right%20=%20%5C%22%5C%22;%20ctn.style.bottom%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20document.scrollingElement.style.overflow%20=%20%5C%22%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%20%20ctn.dataset.isFullscreen%20=%20%5C%22no%5C%22;%5Cn//%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D,%20false);%5Cn%20%20%5Cn%20%20%20%20let%20cssText%20=%20%60%5Cn%20%20%20%20.comments-plugin-ctn%20%7B%5Cn%20%20%20%20%20%20position:relative;%5Cn%20%20%20%20%20%20display:inline-block;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20.loading-spinner-434142%20%7B%20%5Cn%20%20%20%20%20%20border:%204px%20solid%20#f3f3f3;%5Cn%20%20%20%20%20%20border-top:%204px%20solid%20#5d5d5d;%5Cn%20%20%20%20%20%20border-radius:%2050%25;%5Cn%20%20%20%20%20%20width:%2030px;%5Cn%20%20%20%20%20%20height:%2030px;%5Cn%20%20%20%20%20%20animation:%20spin%200.9s%20linear%20infinite;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20@keyframes%20spin%20%7B%5Cn%20%20%20%20%20%200%25%20%7B%20transform:%20rotate(0deg);%20%7D%5Cn%20%20%20%20%20%20100%25%20%7B%20transform:%20rotate(360deg);%20%7D%5Cn%20%20%20%20%7D%60;%5Cn%20%20%20%20let%20styleEl%20=%20document.createElement('style');%5Cn%20%20%20%20styleEl.appendChild(document.createTextNode(cssText));%5Cn%20%20%20%20document.head.appendChild(styleEl);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20let%20addCommentsPluginInterval%20=%20setInterval(()%20=%3E%20%7B%5Cn%20%20%20%20//%20%20%20document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).forEach(markerEl%20=%3E%20%7B%5Cn%20%20%20%20//%20%20%20%20%20//%20detect%20if%20a%20comments%20section%20has%20been%20injected%20after%20it%20yet%20(edit:%20for%20some%20reason%20it's%20injected%20before%20it?):%5Cn%20%20%20%20//%20%20%20%20%20if((!markerEl.nextElementSibling%20%7C%7C%20markerEl.nextElementSibling.dataset.isCommentsSection%20!==%20%5C%22true%5C%22)%20&&%20(!markerEl.previousElementSibling%20%7C%7C%20markerEl.previousElementSibling.dataset.isCommentsSection%20!==%20%5C%22true%5C%22))%20%7B%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20containerStyle%20=%20markerEl.dataset.containerStyle;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20queryString%20=%20markerEl.dataset.queryString;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20folderName%20=%20markerEl.dataset.folderName;%5Cn%20%20%20%20//%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22position:relative;%20display:inline-block;%20$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:white;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%20%20%3Ciframe%20class=%5C%22___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%5C%22%3E%3C/iframe%3E%5Cn%20%20%20%20//%20%20%20%20%20%20%20%3C/div%3E%60;%5Cn%20%20%20%20//%20%20%20%20%20%20%20let%20iframeContainer%20=%20div.firstElementChild;%5Cn%20%20%20%20//%20%20%20%20%20%20%20//debugger;%5Cn%20%20%20%20//%20%20%20%20%20%20%20markerEl.after(iframeContainer);%5Cn%20%20%20%20//%20%20%20%20%20%20%20clearInterval(addCommentsPluginInterval);%5Cn%20%20%20%20//%20%20%20%20%20%7D%5Cn%20%20%20%20//%20%20%20%7D);%5Cn%20%20%20%20//%20%7D,%20200);%5Cn%20%20%20%20%5Cn%20%20%20%20window.___alreadyAddedCommentsPluginStuff43211234%20=%20true;%5Cn%20%20%7D%5Cn%5Cn%20%20let%20colorScheme%20=%20window.matchMedia%20&&%20window.matchMedia('(prefers-color-scheme:%20dark)').matches%20?%20%5C%22dark%5C%22%20:%20%5C%22light%5C%22;%5Cn%20%20if(opts.forceColorScheme)%20colorScheme%20=%20opts.forceColorScheme.evaluateItem;%5Cn%20%20%5Cn%20%20%5Cn%20%20if(opts.replacedDuringUpdate)%20%7B%5Cn%20%20%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20while(!document.querySelector(%5C%22.%5C%22+iframeUniqueId))%20%7B%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22Waiting%20for%20comments-plugin%20iframe%20to%20appear%20in%20document.%5C%22);%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20ctx.iframeContentWindow%20=%20document.querySelector(%5C%22.%5C%22+iframeUniqueId).contentWindow;%5Cn%20%20%20%20%20%20window.___commentsPluginIframeUniqueIdToContext.set(iframeUniqueId,%20ctx);%5Cn%20%20%20%20%7D,%2010);%5Cn%20%20%20%20return%20addMethodsToReturnValue(new%20String(%60%3Cdiv%20data-is-fullscreen=%5C%22no%5C%22%20data-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:$%7BcolorScheme%20===%20%5C%22light%5C%22%20?%20%5C%22white%5C%22%20:%20%5C%22#131516%5C%22%7D;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20%20%20%3Ciframe%20loading=%5C%22lazy%5C%22%20class=%5C%22$%7BiframeUniqueId%7D%20___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D#$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%5C%22%3E%3C/iframe%3E%5Cn%20%20%20%20%3C/div%3E%60));%5Cn%20%20%7D%5Cn%20%20%20%20%5Cn%20%20if(!document.querySelector(%60%5Bdata-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%5D%60))%20%7B%5Cn%5Cn%20%20%20%20function%20swapMarkerElForRealEl()%20%7B%5Cn%20%20%20%20%20%20let%20markerEl%20=%20document.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20if(!markerEl)%20return;%5Cn%20%20%20%20%20%20let%20containerStyle%20=%20markerEl.dataset.containerStyle;%5Cn%20%20%20%20%20%20let%20queryString%20=%20markerEl.dataset.queryString;%5Cn%20%20%20%20%20%20let%20urlHashDataEncoded%20=%20markerEl.dataset.urlHashDataEncoded;%5Cn%20%20%20%20%20%20//%20let%20folderName%20=%20markerEl.dataset.folderName;%5Cn%5Cn%20%20%20%20%20%20//%20NOTE:%20we%20don't%20use%20replaceWith%20here%20because%20that%20approach%20would%20mean%20that%20this%20would%20get%20updated%20during%20update()%20calls%5Cn%20%20%20%20%20%20markerEl.outerHTML%20=%20%60%3Cdiv%20data-is-fullscreen=%5C%22no%5C%22%20data-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%20class=%5C%22comments-plugin-ctn%5C%22%20data-is-comments-section=%5C%22true%5C%22%20style=%5C%22$%7BcontainerStyle%7D%5C%22%3E%5Cn%20%20%20%20%20%20%20%20%3Cdiv%20class=%5C%22__perchance-comments-loading-facade-12345%5C%22%20style=%5C%22position:absolute;%20top:0;%20left:0;%20right:0;%20bottom:0;%20display:flex;%20align-items:center;%20justify-content:center;%20background:$%7BcolorScheme%20===%20%5C%22light%5C%22%20?%20%5C%22white%5C%22%20:%20%5C%22#131516%5C%22%7D;%20border:1px%20solid%20rgba(0,0,0,0.25);%20border-radius:2px;%5C%22%3E%3Cdiv%20class=%5C%22loading-spinner-434142%5C%22%3E%3C/div%3E%3C/div%3E%5Cn%20%20%20%20%20%20%20%20%3Cspan%20class=%5C%22__perchance-comments-iframe-placeholder-el-12345%5C%22%3E%3C/span%3E%5Cn%20%20%20%20%20%20%3C/div%3E%60;%5Cn%5Cn%20%20%20%20%20%20let%20commentsCtn%20=%20document.querySelector(%60%5Bdata-comments-section-folder-name=%5C%22$%7BfolderName%7D%5C%22%5D:not(.already-added-intersection-observer-to-this-comments-plugin-ctn)%60);%20//%20get%20the%20first%20one%20that%20we%20haven't%20added%20an%20intersection%20observer%20for%20yet%20-%20this%20is%20needed%20because%20they%20could%20have%20multiple%20instances%20of%20the%20same%20channel%20on%20the%20page,%20and%20we%20don't%20want%20to%20add%20all%20the%20intersection%20observers%20to%20the%20first%20one%5Cn%20%20%20%20%20%20commentsCtn.classList.add(%5C%22already-added-intersection-observer-to-this-comments-plugin-ctn%5C%22);%5Cn%5Cn%20%20%20%20%20%20//%20lazyload%20the%20iframe,%20because%20some%20generator%20pages%20have%20literally%20dozens%20of%20different%20channels.%5Cn%20%20%20%20%20%20//%20I'm%20adding%20multiple%20observers%20because%20the%20default%20%60root%60%20is%20the%20browser%20viewport,%20and%20margin%20doesn't%20make%20sense%20for%20that,%20since%20it's%20not%20scrollable,%20but%20we%20still%20want%20it%20in%20case%20of%20the%20comments%20being%20in%20weird%20non-documentElement%20scrollable%20area%20or%20something.%20Note%20really%20sure%20how%20it%20works.%5Cn%20%20%20%20%20%20const%20observerFn%20=%20entries%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(entries%5B0%5D.isIntersecting)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20observer1.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20observer2.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20console.log(%5C%22comments%20ctn:%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20let%20placeholder%20=%20commentsCtn.querySelector(%5C%22.__perchance-comments-iframe-placeholder-el-12345%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20if(placeholder)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20let%20iframeHtml%20=%20%60%3Ciframe%20class=%5C%22$%7BiframeUniqueId%7D%20___perchance-comments-plugin-iframe-12345%5C%22%20src=%5C%22https://comments-plugin.perchance.org/embed/$%7BfolderName%7D?$%7BqueryString%7D#$%7BurlHashDataEncoded%7D%5C%22%20style=%5C%22border:0;%20width:100%25;%20height:100%25;%5C%22%3E%3C/iframe%3E%60;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20placeholder.outerHTML%20=%20iframeHtml;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20ctx.iframeContentWindow%20=%20document.querySelector(%5C%22.%5C%22+iframeUniqueId).contentWindow;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20window.___commentsPluginIframeUniqueIdToContext.set(iframeUniqueId,%20ctx);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20const%20observer1%20=%20new%20IntersectionObserver(observerFn,%20%7B%5Cn%20%20%20%20%20%20%20%20rootMargin:%20%5C%226000px%5C%22,%20//%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer1.observe(commentsCtn);%5Cn%20%20%20%20%20%20const%20observer2%20=%20new%20IntersectionObserver(observerFn,%20%7B%5Cn%20%20%20%20%20%20%20%20root:%20document.documentElement,%5Cn%20%20%20%20%20%20%20%20rootMargin:%20%5C%226000px%5C%22,%20//%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer2.observe(commentsCtn);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20//%20setTimeout(swapMarkerElForRealEl,%2050);%5Cn%5Cn%20%20%20%20//%20the%20above%20commented-out%20setTimeout%20one-liner%20was%20the%20previous%20approach.%20the%20below%20MutationObserver-based%20monstrosity%20is%20a%20bit%20better%20because%20it%20ensures%20the%20swap%20happens%20*the%20moment*%20that%20the%20marker%20is%20added%20to%20the%20page,%20and%20we%20can%20wait%20a%20long%20time%20without%20the%20need%20for%20polling%5Cn%20%20%20%20let%20markerEl%20=%20document.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20if(markerEl)%20%7B%5Cn%20%20%20%20%20%20swapMarkerElForRealEl();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20they%20generated%20the%20comments%20HTML,%20but%20haven't%20put%20it%20in%20the%20page%20yet,%20so%20we%20wait%20for%20it%20using%20a%20mutation%20observer:%5Cn%20%20%20%20%20%20let%20foundElement%20=%20false;%5Cn%20%20%20%20%20%20let%20markerTagValue%20=%20%60temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%60;%5Cn%20%20%20%20%20%20let%20observer%20=%20new%20MutationObserver((mutations)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20mutation%20of%20mutations)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20for(let%20node%20of%20mutation.addedNodes)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(node.dataset%20&&%20node.dataset.markerTag%20===%20markerTagValue)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundElement%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%20else%20if(node.querySelector)%20%7B%20//%20skip%20#text,%20#comment,%20etc.%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%20since%20mutation%20observers%20don't%20trigger%20for%20all%20subnodes%20-%20only%20the%20highest-level%20nodes%20in%20a%20mutation%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20let%20markerEl%20=%20node.querySelector(%60%5Bdata-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%5D%60);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20if(markerEl)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20foundElement%20=%20true;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%20%20if(foundElement)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20swapMarkerElForRealEl();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer.observe(document.body,%20%7B%20childList:%20true,%20subtree:%20true%20%7D);%5Cn%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20if(!foundElement)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20console.error(%5C%22Couldn't%20find%20marker%20element%20for%20comments%20plugin?%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20observer.disconnect();%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D,%2010000);%5Cn%20%20%20%20%7D%5Cn%5Cn%20%20%20%20return%20addMethodsToReturnValue(new%20String(%60%3Cspan%20data-marker-tag=%5C%22temporaryMarkerElForCommentsPlugin84738932-folderName-$%7BfolderName%7D%5C%22%20data-folder-name=%5C%22$%7BfolderName%7D%5C%22%20data-container-style=%5C%22$%7BcontainerStyle%7D%5C%22%20data-query-string=%5C%22$%7BqueryString%7D%5C%22%20data-url-hash-data-encoded=%5C%22$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%3E%3C/span%3E%60));%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%5Cn%5Cn//%20%20%20//%20This%20is%20a%20temporary%20fix%20because%20editing%20the%20text%20next%20to%20where%20the%20plugin%20is%20placed%20(within%20the%20same%20HTML%20%5C%22node%5C%22?)%20will%20cause%20the%5Cn//%20%20%20//%20comments%20section%20to%20disappear%20which%20causes%20users%20to%20think%20that%20they%20can't%20edit%20the%20positioning%20of%20the%20comments.%20So%20we%20tell%20them%20to%5Cn//%20%20%20//%20refresh%20the%20page.%20Ideally%20I'd%20fix%20this%20like%20I%20did%20with%20the%20text-to-image-plugin%20gallery%20-%20I%20just%20return/create%20a%20%5C%22fresh%5C%22%20one%20whenever%5Cn//%20%20%20//%20the%20old%20one%20isn't%20detected%20with%20querySelector.%5Cn//%20%20%20setTimeout(()%20=%3E%20%7B%5Cn//%20%20%20%20%20if(document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).length%20!==%20document.querySelectorAll(%5C%22.comments-plugin-ctn%5C%22).length)%20%7B%5Cn//%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.___perchance-comments-plugin-marker%5C%22).forEach(markerEl%20=%3E%20%7B%5Cn//%20%20%20%20%20%20%20%20%20markerEl.style.cssText%20=%20%60display:inline-block;%20border:1px%20solid%20grey;%20$%7BmarkerEl.dataset.containerStyle%7D%60;%5Cn//%20%20%20%20%20%20%20%20%20markerEl.innerHTML%20=%20%60%3Cdiv%20style=%5C%22height:100%25;%20display:flex;%20align-items:center;%20justify-content:center;%5C%22%3E%3Cspan%20style=%5C%22opacity:0.6;%20padding:1rem;%5C%22%3EPlease%20save%20your%20generator%20and%20refresh%20the%20page%20to%20reload%20the%20comments%20plugin.%3C/span%3E%3C/div%3E%60;%5Cn//%20%20%20%20%20%20%20%7D);%5Cn//%20%20%20%20%20%7D%5Cn//%20%20%20%7D,%20600);%5Cn%5Ct%5Cn//%20%5Ct//%20can't%20just%20inject%20the%20iframe%20directly%20otherwise%20it%20gets%20reloaded%20every%20time%20update()%20is%20called.%20So%20we%20need%20the%20setInterval%20monstrosity%20above.%5Cn//%20%5Ctreturn%20%60%3Cspan%20class=%5C%22___perchance-comments-plugin-marker%5C%22%20data-folder-name=%5C%22$%7BfolderName%7D%5C%22%20data-container-style=%5C%22$%7BcontainerStyle%7D%5C%22%20data-query-string=%5C%22$%7BqueryString%7D%5C%22%3E%3C/span%3E%60;%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%22,%22imports%22:%5B%5D,%22lastEditTime%22:1715066508882,%22found%22:true%7D,%7B%22name%22:%22fullscreen-button-plugin%22,%22modelText%22:%22$output(text,%20exitText,%20style)%20=%3E%20%5Cn%20%20if(!window.addedFullscreenEventListenerForPlugin39492749374)%20%7B%5Cn%20%20%20%20window.addEventListener(%5C%22fullscreenchange%5C%22,%20function(event)%20%7B%5Cn%20%20%20%20%20%20if(document.fullscreenElement)%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20btn%20of%20%5B...document.querySelectorAll(%5C%22.fullscreenButtonPluginButton938479832938%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20btn.innerHTML%20=%20btn.dataset.exitText;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20for(let%20btn%20of%20%5B...document.querySelectorAll(%5C%22.fullscreenButtonPluginButton938479832938%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20btn.innerHTML%20=%20btn.dataset.text;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.addedFullscreenEventListenerForPlugin39492749374%20=%20true;%5Cn%20%20%7D%5Cn%20%20if(!document.documentElement.requestFullscreen)%20document.documentElement.requestFullscreen%20=%20document.documentElement.webkitRequestFullscreen%20%7C%7C%20document.documentElement.mozRequestFullScreen%20%7C%7C%20document.documentElement.msRequestFullscreen;%5Cn%20%20if(!document.exitFullscreen)%20document.exitFullscreen%20=%20document.webkitExitFullscreen%20%7C%7C%20document.mozCancelFullScreen%20%7C%7C%20document.msExitFullscreen;%5Cn%20%20if(!document.documentElement.requestFullscreen)%20%7B%5Cn%20%20%20%20document.documentElement.requestFullscreen%20=%20function()%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22The%20browser/device%20you're%20using%20doesn't%20support%20fullscreen%20mode.%5C%22);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20if(!document.exitFullscreen)%20%7B%5Cn%20%20%20%20document.exitFullscreen%20=%20function()%20%7B%5Cn%20%20%20%20%20%20alert(%5C%22The%20browser/device%20you're%20using%20doesn't%20support%20fullscreen%20mode.%5C%22);%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20return%20%60%3Cbutton%20class=%5C%22fullscreenButtonPluginButton938479832938%5C%22%20data-text=%5C%22$%7Btext%20%7C%7C%20%5C%22Fullscreen%5C%22%7D%5C%22%20data-exit-text=%5C%22$%7BexitText%20%7C%7C%20%5C%22Exit%20Fullscreen%5C%22%7D%5C%22%20onclick=%5C%22(!document.fullscreenElement%20&&%20!document.webkitFullscreenElement%20&&%20!document.mozFullScreenElement%20&&%20!document.msFullscreenElement)%20?%20(document.documentElement.requestFullscreen(),%20this.innerHTML=this.dataset.exitText)%20:%20(document.exitFullscreen(),%20this.innerHTML=this.dataset.text)%5C%22%20style=%5C%22line-height:1.2rem;%20$%7Bstyle%20%7C%7C%20%5C%22%5C%22%7D%5C%22%3E$%7Btext%20%7C%7C%20%5C%22Fullscreen%5C%22%7D%3C/button%3E%60;%5Cn%5Ct%22,%22imports%22:%5B%5D,%22lastEditTime%22:1699845831991,%22found%22:true%7D,%7B%22name%22:%22select-leaf-plugin%22,%22modelText%22:%22//%20This%20is%20the%20JavaScript%20function%20that%20powers%20this%20plugin:%5Cn$output%20(list)%20=%3E%5Cn%20%20if(!list)%20return%20%5C%22(no%20list%20given%20to%20selectLeaf%20plugin)%5C%22;%5Cn%5Ctlet%20leaf%20=%20list;%5Cn%5Ctlet%20i%20=%200;%5Cn%5Ctlet%20result;%5Cn%5Ctwhile(1)%20%7B%5Cn%5Ct%5Cti++;%5Cn%5Ct%5Ctif(i%20%3E%2010000)%20%7B%5Cn%20%20%20%20%20%20return%20%5C%22(error%20in%20select-leaf-plugin:%20infinite%20loop%20encountered?)%5C%22;%5Cn%20%20%20%20%7D%5Cn%5Ct%5Ctresult%20=%20leaf.selectOne;%5Cn%5Ct%5Ctif(typeof%20result%20===%20%5C%22string%5C%22%20%7C%7C%20Object.keys(result).length%20===%200)%20%7B%20//%20typeof%20result%20===%20%5C%22string%5C%22%20is%20for%20case%20where%20input%20list%20was%20actually%20just%20a%20'property'%20like%20foo=%7Ba%7Cb%7Cc%7D%5Cn%5Ct%5Ct%5Ct//if(!result)%20debugger;%5Cn%5Ct%5Ct%5Ctreturn%20result;%5Cn%5Ct%5Ct%7D%5Cn%5Ct%5Ctleaf%20=%20result;%5Cn%5Ct%7D%5Cn%5Ct%5Cn//%20You%20can%20learn%20JavaScript%20here:%5Cn//%20https://www.codecademy.com/learn/javascript%22,%22imports%22:%5B%5D,%22lastEditTime%22:1691554935487,%22found%22:true%7D,%7B%22name%22:%22text-to-image-plugin%22,%22modelText%22:%22%5Cn//%20NOTE%20TO%20SELF:%20If%20you%20add%20more%20properties,%20make%20sure%20you%20add%20to%20the%20regex%20below,%20and%20the%20variable%20declarations%20in%20each%20'branch'%5Cn%5Cn$output(data)%20=%3E%5Cn%20%20if(data%20===%20undefined)%20return%20%5C%22(Error:%20you've%20input%20an%20empty%20value/variable%20into%20the%20text-to-image-plugin)%5C%22;%5Cn%20%20//%20if(options%20===%20undefined)%20options%20=%20%7B%7D;%5Cn%20%20%5Cn%20%20let%20serverOrigin%20=%20%5C%22https://image-generation.perchance.org%5C%22;%5Cn%20%20%5Cn%20%20let%20evaluatedInputs;%5Cn%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20set%20up%20handler%20for%20gallery%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%5Cn%20%20if(!window.___addedTextToImagePluginFirstTimeCode98420274)%20%7B%5Cn%20%20%20%20window.addEventListener(%5C%22message%5C%22,%20function(e)%20%7B%5Cn%20%20%20%20%20%20let%20origin%20=%20e.origin%20%7C%7C%20e.originalEvent.origin;%20//%20For%20Chrome,%20the%20origin%20property%20is%20in%20the%20event.originalEvent%20object.%5Cn%20%20%20%20%20%20if(origin%20!==%20serverOrigin)%20%7B%5Cn%20%20%20%20%20%20%20%20return;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.openGallerySignal)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20ctn%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20let%20subChannelName%20=%20e.data.subChannelName;%5Cn%20%20%20%20%20%20%20%20ctn.innerHTML%20=%20%60%3Cdiv%20onclick=%5C%22this.remove()%5C%22%20style=%5C%22backdrop-filter:brightness(0.3);position:fixed;top:0;left:0;right:0;bottom:0;z-index:999;%5C%22%3E%3Cdiv%20style=%5C%22position:fixed;top:5vh;bottom:5vh;left:5vh;right:5vh;background:white;border-radius:3px;%5C%22%3E%3Ciframe%20src=%5C%22$%7BserverOrigin%7D/gallery?channel=$%7Bwindow.generatorName%7D&subChannel=$%7BencodeURIComponent(subChannelName)%7D&sort=trending&timeRange=1-month&contentFilter=pg13%5C%22%20style=%5C%22border:0;width:100%25;height:100%25;%5C%22%3E%3C/iframe%3E%3C/div%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(ctn.firstElementChild);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.savedImageToGallerySignal)%20%7B%5Cn%20%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.text-to-image-plugin-gallery%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20let%20targetOrigin%20=%20serverOrigin;%5Cn%20%20%20%20%20%20%20%20%20%20el.contentWindow.postMessage(%7BdoRefreshIfSortingByRecent:true%7D,%20targetOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20%5Cn%20%20%20%20%20%20%20%20%20%20//%20the%20code%20below%20is%20commented%20out%20because%20it%20doesn't%20work%20for%20the%20case%20where%20the%20user%20has%20switched%20the%20sort%20to%20recent%20(since,%20counter-intuitively,%20iframe's%20window.location%20can%20change,%20while%20iframe.src%20stays%20as%20the%20original%20value%20-%20I'm%20assuming%20this%20is%20due%20to%20cross-origin%20security%20stuff)%5Cn%20%20%20%20%20%20%20%20%20%20//%20if(el.src.includes(%5C%22sort=recent%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20//%20refresh%20galleries%20that%20are%20sorted%20by%20recent%20if%20the%20user%20makes%20a%20submission%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20let%20url%20=%20new%20URL(el.src);%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20url.searchParams.set(%5C%22cacheBust%5C%22,%20Math.random().toString());%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20el.src%20=%20%5C%22%5C%22;%20//%20we%20do%20this%20instead%20of%20el.src=el.src%20because%20that%20doesn't%20work%20if%20the%20URL%20has%20a%20hash%20in%20it,%20and%20I%20might%20need%20to%20add%20data%20in%20the%20hash%20later%5Cn%20%20%20%20%20%20%20%20%20%20//%20%20%20setTimeout(()%20=%3Eel.src=url.href,%20700);%20//%20we%20need%20to%20wait%20a%20bit%20for%20the%20iframe%20to%20actually%20initiate%20a%20reload/refresh%20before%20setting%20the%20src%20again%5Cn%20%20%20%20%20%20%20%20%20%20//%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(e.data.documentHeightChanged)%20%7B%5Cn%20%20%20%20%20%20%20%20document.querySelectorAll(%5C%22.text-to-image-plugin-gallery%5C%22).forEach(el%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(el.dataset.adaptiveHeight%20===%20%5C%22yes%5C%22)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.style.height%20=%20(e.data.newHeight+1)+%5C%22px%5C%22;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20console.log(%5C%22Updated%20gallery%20height%5C%22,%20e.data.newHeight);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20window.___addedTextToImagePluginFirstTimeCode98420274%20=%20true;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(data.gallery)%20%7B%5Cn%20%20%20%20//%20NOTE:%20this%20is%20a%20somewhat%20'breaking'%20change,%20but%20I'm%20no%20longer%20allowing%20unfiltered%20content%20to%20be%20shown%20by%20default.%5Cn%20%20%20%20//%20The%20user%20must%20specifically%20choose%20to%20switch%20the%20gallery%20to%20unfiltered%20mode.%5Cn%20%20%20%20data.contentFilter%20=%20%5C%22pg13%5C%22;%5Cn%20%20%5Cn%20%20%20%20let%20sort%20=%20data.sort%20?%20data.sort.evaluateItem%20:%20%5C%22recent%5C%22;%5Cn%20%20%20%20if(sort%20===%20%5C%22best%5C%22)%20sort%20=%20%5C%22top%5C%22;%20//%20alias%5Cn%20%20%20%20%5Cn%20%20%20%20let%20contentFilter%20=%20data.contentFilter%20?%20data.contentFilter.evaluateItem.toLowerCase()%20:%20%5C%22pg13%5C%22;%5Cn%20%20%20%20if(contentFilter%20===%20%5C%22pg-13%5C%22)%20contentFilter%20=%20%5C%22pg13%5C%22;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20bannedUsers%20=%20data.bannedUsers%20?%20data.bannedUsers.selectAll.map(item%20=%3E%20item.toString())%20:%20%5B%5D;%5Cn%20%20%20%20let%20bannedPromptPhrases%20=%20data.bannedPromptPhrases%20?%20data.bannedPromptPhrases.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22))%20:%20%5B%5D;%5Cn%20%20%20%20let%20bannedNegativePromptPhrases%20=%20data.bannedNegativePromptPhrases%20?%20data.bannedNegativePromptPhrases.selectAll.map(item%20=%3E%20item.getRawListText.replace(%5C%22/%5C%5C%5C%5C%5E%5C%22,%20%5C%22/%5E%5C%22))%20:%20%5B%5D;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20timeRange%20=%20data.timeRange%20?%20data.timeRange.evaluateItem%20:%20(sort%20===%20%5C%22recent%5C%22%20?%20%5C%22all-time%5C%22%20:%20%5C%221-month%5C%22);%5Cn%20%20%20%20let%20hideIfScoreIsBelow%20=%20data.hideIfScoreIsBelow%20!==%20undefined%20?%20Number(data.hideIfScoreIsBelow.evaluateItem)%20:%20-1000000000;%5Cn%20%20%20%20if(isNaN(hideIfScoreIsBelow))%20hideIfScoreIsBelow%20=%20-1000000000;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20galleryOptions%20=%20%7Bsort,%20timeRange,%20hideIfScoreIsBelow,%20contentFilter,%20subChannel:%5C%22public%5C%22%7D;%20//%20this%20is%20also%20used%20for%20checking%20if%20gallery%20options%20have%20been%20udpated%20(see%20below)%5Cn%20%20%20%20if(data.forceColorScheme)%20galleryOptions.forceColorScheme%20=%20data.forceColorScheme;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20hashData%20=%20%7BbannedUsers,%20bannedPromptPhrases,%20bannedNegativePromptPhrases,%20injectedStyles:%7B%7D%7D;%5Cn%20%20%20%20if(data.style)%20%7B%5Cn%20%20%20%20%20%20let%20style%20=%20data.style.evaluateItem.trim();%5Cn%20%20%20%20%20%20if(style.includes(%5C%22background:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20hashData.injectedStyles.background%20=%20(style.match(/(?:%5E%7C;)%20*background:(.+?)(?:;%7C$)/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20%20%20%7D%20else%20if(style.includes(%5C%22background-color:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20hashData.injectedStyles.background%20=%20(style.match(/(?:%5E%7C;)%20*background-color:(.+?)(?:;%7C$)/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20otherUrlParams%20=%20%7Bchannel:window.generatorName%7D;%5Cn%20%20%20%20let%20iframeUrl%20=%20new%20URL(%60$%7BserverOrigin%7D/gallery%60);%5Cn%20%20%20%20Object.entries(galleryOptions).forEach((%5Bkey,%20value%5D)%20=%3E%20iframeUrl.searchParams.set(key,%20value));%5Cn%20%20%20%20Object.entries(otherUrlParams).forEach((%5Bkey,%20value%5D)%20=%3E%20iframeUrl.searchParams.set(key,%20value));%5Cn%20%20%20%20%5Cn%20%20%20%20%5Cn%20%20%20%20function%20makeGalleryIframeHtml()%20%7B%5Cn%20%20%20%20%20%20return%20%60%3Ciframe%20data-gallery-options=%5C%22$%7BencodeURIComponent(JSON.stringify(galleryOptions))%7D%5C%22%20data-adaptive-height=%5C%22$%7Bdata.adaptiveHeight%20?%20%5C%22yes%5C%22%20:%20%5C%22no%5C%22%7D%5C%22%20style=%5C%22width:100%25;%20height:70vh;%20border:none;%20$%7Bdata.style%20%7C%7C%20%5C%22%5C%22%7D%5C%22%20class=%5C%22text-to-image-plugin-gallery%5C%22%20src=%5C%22$%7BiframeUrl.href%7D#data=$%7BencodeURIComponent(JSON.stringify(hashData))%7D%5C%22%20allow=%5C%22clipboard-write%5C%22%3E%3C/iframe%3E%60;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(!document.querySelector(%5C%22.text-to-image-plugin-gallery%5C%22))%20%7B%5Cn%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20temporaryMarkerElForTextToImageGallery84738932.outerHTML%20=%20makeGalleryIframeHtml()%5Cn%20%20%20%20%20%20%7D,%2050);%5Cn%20%20%20%20%20%20return%20%60%3Cspan%20id=%5C%22temporaryMarkerElForTextToImageGallery84738932%5C%22%3E%3C/span%3E%60;%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20//%20update%20any%20gallery%20parameters%20if%20they%20have%20been%20changed:%5Cn%20%20%20%20%20%20let%20galleryIframe%20=%20document.querySelector(%5C%22.text-to-image-plugin-gallery%5C%22);%5Cn%20%20%20%20%20%20let%20newGalleryOptionsText%20=%20encodeURIComponent(JSON.stringify(galleryOptions));%5Cn%20%20%20%20%20%20if(galleryIframe.dataset.galleryOptions%20!==%20newGalleryOptionsText)%20%7B%5Cn%20%20%20%20%20%20%20%20galleryIframe.outerHTML%20=%20makeGalleryIframeHtml();%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20%5C%22%5C%22;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20///////////////////////////////////////////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20%20%20%20parse%20and%20evaluate%20prompt%20data/options%20from%20input%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20///////////////////////////////////////////////////////////////////////////////////////%5Cn%20%20const%20defaultGuidanceScale%20=%207;%5Cn%20%20%5Cn%20%20let%20d%20=%20%7B%7D;%20%5Cn%20%20//%20let%20dataInputWasNotAnOptionsObject%20=%20false;%5Cn%5Cn%20%20if(!data.prompt)%20%7B%5Cn%20%20%20%20d.prompt%20=%20data.evaluateItem;%20//%20they%20passed%20in%20some%20text%20directly%20like%20%5Bimage(%5C%22a%20carrot%5C%22)%5D%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20d.prompt%20=%20data.prompt.evaluateItem;%5Cn%20%20%7D%5Cn%20%20//%20Apply%20some%20covenience%20fixes%20to%20the%20prompt,%20even%20though%20the%20plugin%20user%20should%20ideally%20fix%20this%20on%20their%20end:%5Cn%20%20d.prompt%20=%20d.prompt.replace(/%3Cspan%20%5B%5E%3E%5D+______tippy-tooltip-%5B%5E%3E%5D+%3E(.+?)%3C%5C%5C/span%3E/,%20%5C%22$1%5C%22);%5Cn%20%20%5Cn%20%20//%20parse%20values%20from%20prompts%20like:%20%60this%20is%20the%20prompt%20text%20(size:::400)%20(resolution:::512x768)%20(guidanceScale:::10)%60%5Cn%20%20if(d.prompt.includes(%5C%22:::%5C%22))%20%7B%5Cn%20%20%20%20let%20matches%20=%20%5B...d.prompt.matchAll(/%5C%5C((seed%7Csize%7Cstyle%7Cresolution%7Cwidth%7Cheight%7CguidanceScale%7CsaveTitle%7CsaveDescription)%5C%5C:%5C%5C:%5C%5C:/g)%5D;%5Cn%20%20%20%20//%20console.log(%5C%22matches:%5C%22,%20matches);%5Cn%20%20%20%20const%20numericProps%20=%20%5B%5C%22seed%5C%22,%20%5C%22width%5C%22,%20%5C%22height%5C%22,%20%5C%22guidanceScale%5C%22,%20%5C%22width%5C%22,%20%5C%22height%5C%22,%20%5C%22size%5C%22%5D;%5Cn%20%20%20%20for(let%20match%20of%20matches)%20%7B%5Cn%20%20%20%20%20%20let%20re%20=%20new%20RegExp(%60%5C%5C%5C%5C($%7Bmatch%5B1%5D%7D%5C%5C%5C%5C:%5C%5C%5C%5C:%5C%5C%5C%5C:(.+?)%5C%5C%5C%5C).*?(?:%5C%5C%5C%5C:%5C%5C%5C%5C:%5C%5C%5C%5C:%7C$)%60);%5Cn%20%20%20%20%20%20let%20value%20=%20(d.prompt.match(re)%20%7C%7C%20%5B%5D)%5B1%5D%5Cn%20%20%20%20%20%20let%20key%20=%20match%5B1%5D;%5Cn%20%20%20%20%20%20if(value%20!==%20undefined)%20%7B%5Cn%20%20%20%20%20%20%20%20d%5Bkey%5D%20=%20numericProps.includes(key)%20?%20Number(value)%20:%20value;%5Cn%20%20%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60($%7Bkey%7D:::$%7Bvalue%7D)%60,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%20%20d.prompt%20=%20d.prompt.trim();%5Cn%20%20%7D%5Cn%20%20if(!window.___t2i__parseNegativePrompt)%20%7B%5Cn%20%20%20%20window.___t2i__parseNegativePrompt%20=%20function(str)%20%7B%5Cn%20%20%20%20%20%20const%20prefix%20=%20'(negativePrompt:::';%5Cn%20%20%20%20%20%20const%20start%20=%20str.indexOf(prefix);%5Cn%20%20%20%20%20%20if%20(start%20===%20-1)%20return%20null;%5Cn%20%20%20%20%20%20let%20depth%20=%200;%5Cn%20%20%20%20%20%20let%20result%20=%20'';%5Cn%20%20%20%20%20%20for(let%20i%20=%20start%20+%20prefix.length;%20i%20%3C%20str.length;%20i++)%20%7B%5Cn%20%20%20%20%20%20%20%20if(str%5Bi%5D%20===%20'(')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20depth++;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20if%20(str%5Bi%5D%20===%20')')%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(depth%20===%200)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20break;%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%20%20depth--;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20result%20+=%20str%5Bi%5D;%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20return%20result;%5Cn%20%20%20%20%7D;%5Cn%20%20%7D%5Cn%20%20if(d.prompt.includes(%5C%22(negativePrompt:::%5C%22))%20%7B%5Cn%20%20%20%20let%20result%20=%20window.___t2i__parseNegativePrompt(d.prompt);%5Cn%20%20%20%20if(result)%20%7B%5Cn%20%20%20%20%20%20d.negativePrompt%20=%20result;%5Cn%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60(negativePrompt:::$%7Bd.negativePrompt%7D)%60,%20%5C%22%5C%22);%5Cn%20%20%20%20%20%20d.prompt%20=%20d.prompt.replace(%60(negativePrompt:::$%7Bd.negativePrompt%7D%60,%20%5C%22%5C%22);%20//%20since%20if%20final%20bracket%20is%20missing,%20then%20all%20following%20text%20is%20considered%20the%20negative%20prompt%5Cn%20%20%20%20%7D%5Cn%20%20%20%20d.prompt%20=%20d.prompt.trim();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(!data.prompt)%20%7B%20//%20they%20passed%20in%20some%20text%20directly%20like%20%5Bimage(%5C%22a%20carrot%5C%22)%5D,%20so%20add%20some%20defaults/fallbacks.%5Cn%20%20%20%20if(d.seed%20===%20undefined)%20d.seed%20=%20-1;%5Cn%20%20%20%20if(d.width%20===%20undefined)%20d.width%20=%20300;%5Cn%20%20%20%20if(d.height%20===%20undefined)%20d.height%20=%20300;%5Cn%20%20%20%20if(d.resolution%20===%20undefined)%20d.resolution%20=%20%5C%22512x512%5C%22;%20%20%20%5Cn%20%20%20%20if(d.guidanceScale%20===%20undefined)%20d.guidanceScale%20=%20defaultGuidanceScale;%5Cn%20%20%20%20if(d.negativePrompt%20===%20undefined)%20d.negativePrompt%20=%20%5C%22%5C%22;%5Cn%20%20%20%20if(d.style%20===%20undefined)%20d.style%20=%20%5C%22%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20//%20EDIT:%20Not%20going%20ahead%20with%20this%20for%20now%20in%20favor%20of%20a%20setting%20a%20global%20variable%20which%20contains%20data%20on%20the%20last-used%20prompt.%5Cn%20%20//%20//%20NOTE:%20Originally%20%60data%60%20was%20the%20only%20param%20and%20it%20could%20be%20the%20prompt,%20or%20a%20promptOptions%20object/list.%5Cn%20%20//%20//%20But%20I%20realised%20that%20it's%20not%20very%20ergonomic%20(see%20e.g.%20reddit.com/r/perchance/comments/yta11r),%20so%20now,%20in%20a%20backwards-compatible%20way,%5Cn%20%20//%20//%20I'm%20allowing%20the%20user%20to%20pass%20the%20options%20as%20the%20second%20parameter%20instead.%20This%20just%20means%20that%20if%20data%20is%20a%20prompt%20(rather%20than%20a%5Cn%20%20//%20//%20promptOptions%20object),%20then%20we%20use%20the%20%60options%60%20parameter%20(which%20defaults%20to%20an%20empty%20object)%20for%20the%20generation%20options:%5Cn%20%20//%20if(dataInputWasNotAnOptionsObject)%20%7B%5Cn%20%20//%20%20%20data%20=%20options;%20//%20this%5Cn%20%20//%20%7D%5Cn%20%20%5Cn%20%20if(!d.seed)%20d.seed%20=%20data.seed%20?%20data.seed.evaluateItem%20:%20-1;%5Cn%20%20if(!d.resolution)%20d.resolution%20=%20data.resolution%20?%20data.resolution.evaluateItem%20:%20%5C%22512x512%5C%22;%5Cn%20%20if(!d.guidanceScale)%20d.guidanceScale%20=%20data.guidanceScale%20?%20data.guidanceScale.evaluateItem%20:%20defaultGuidanceScale;%5Cn%20%20if(!d.negativePrompt)%20d.negativePrompt%20=%20data.negativePrompt%20?%20data.negativePrompt.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.width)%20d.width%20=%20data.width%20?%20data.width.evaluateItem%20:%20undefined;%20%5Cn%20%20if(!d.height)%20d.height%20=%20data.height%20?%20data.height.evaluateItem%20:%20undefined;%20%5Cn%20%20if(!d.style)%20d.style%20=%20data.style%20?%20data.style.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.saveTitle)%20d.saveTitle%20=%20data.saveTitle%20?%20data.saveTitle.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(!d.saveDescription)%20d.saveDescription%20=%20data.saveDescription%20?%20data.saveDescription.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20%5Cn%20%20//%20NOTE:%20This%20stuff%20is%20not%20longer%20needed%20because%20we%20do%20the%20parsing%20above%20regardless%20of%20whether%20they%20passed%20a%20plain%20string%20in,%20or%20a%20promptOptions%20object.%5Cn%20%20//%20//%20if%20seed%20is%20specified%20within%20the%20prompt%20with%20the%20(key:::value)%20format%20-%20i.e.%20they%20used%20promptOptions%20input%20but%20specified%20the%20seed%20within%20promptOptions.prompt,%20and%20so%20long%20as%20promptOptions.seed%20is%20not%20specified,%20then%20we%20set%20the%20seed%20to%20the%20one%20specified%20in%20the%20prompt:%5Cn%20%20//%20if(data.seed%20===%20undefined%20&&%20d.prompt.includes(%5C%22(seed:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20seed%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(seed:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20seed=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(seed)%20%7B%5Cn%20%20//%20%20%20%20%20d.seed%20=%20seed;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20guidanceScale:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(guidanceScale:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20guidanceScale%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(guidanceScale:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20guidanceScale=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(guidanceScale)%20%7B%5Cn%20%20//%20%20%20%20%20d.guidanceScale%20=%20guidanceScale;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20width:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(width:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20width%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(width:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20width=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(width)%20%7B%5Cn%20%20//%20%20%20%20%20d.width%20=%20width;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20height:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(height:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20height%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(height:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20height=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(height)%20%7B%5Cn%20%20//%20%20%20%20%20d.height%20=%20height;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20//%20//%20same%20for%20size:%5Cn%20%20//%20if(data.guidanceScale%20===%20undefined%20&&%20d.prompt.includes(%5C%22(size:::%5C%22))%20%7B%5Cn%20%20//%20%20%20let%20size%20=%20null;%5Cn%20%20//%20%20%20d.prompt%20=%20d.prompt.replace(/%5C%5C(size:::(%5B0-9%5D+)%5C%5C)/g,%20(m,%20p1)%20=%3E%20%7B%20size=Number(p1);%20return%20%5C%22%5C%22;%20%7D);%5Cn%20%20//%20%20%20if(size)%20%7B%5Cn%20%20//%20%20%20%20%20d.size%20=%20size;%5Cn%20%20//%20%20%20%7D%5Cn%20%20//%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20%20%20%20sanity%20checks%20on%20inputs%20%20%20%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20%5Cn%20%20if(d.size%20&&%20d.resolution%20&&%20d.resolution.split(%5C%22x%5C%22)%5B0%5D%20!==%20d.resolution.split(%5C%22x%5C%22)%5B1%5D)%20%7B%5Cn%20%20%20%20return%20%60(text-to-image-plugin:%20%3Cb%3Esize%3C/b%3E%20is%20only%20a%20valid%20parameter%20with%20square%20resolutions.%20use%20%3Cb%3Ewidth%3C/b%3E%20and%20%3Cb%3Eheight%3C/b%3E%20instead)%60;%5Cn%20%20%7D%5Cn%5Cn%20%20if(d.guidanceScale%20%3C%201%20%7C%7C%20Math.round(d.guidanceScale)%20!==%20d.guidanceScale)%20%7B%5Cn%20%20%20%20return%20%60(text-to-image-plugin:%20%3Cb%3EguidanceScale%3C/b%3E%20should%20be%20a%20whole%20number%20between%201%20and%2030,%20inclusive)%60;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(!%5B%5C%22512x512%5C%22,%20%5C%22512x768%5C%22,%20%5C%22768x512%5C%22%5D.includes(d.resolution))%20%7B%5Cn%20%20%20%20return%20%5C%22(text-to-image-plugin:%20Currently,%20the%20only%20valid%20resolutions%20are%20512x512,%20512x768%20and%20768x512)%5C%22;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20//%20%20%20%20%20%20%20%20un-shortcut%20size/width/height%20%20%20%20%20%20%20//%5Cn%20%20////////////////////////////////////////////////%5Cn%20%20let%20resW%20=%20Number(d.resolution.split(%5C%22x%5C%22)%5B0%5D);%5Cn%20%20let%20resH%20=%20Number(d.resolution.split(%5C%22x%5C%22)%5B1%5D);%5Cn%20%20let%20widthHeightCss%20=%20%5C%22%5C%22;%5Cn%20%20if(d.size)%20%7B%5Cn%20%20%20%20let%20size%20=%20d.size.evaluateItem;%5Cn%20%20%20%20if(typeof%20size%20===%20%5C%22number%5C%22)%20size%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20widthHeightCss%20=%20%60width:$%7Bsize%7D%60;%5Cn%20%20%7D%20else%20%7B%5Cn%20%20%20%20if(d.width%20&&%20!d.height)%20%7B%5Cn%20%20%20%20%20%20d.width%20=%20d.width.evaluateItem;%5Cn%20%20%20%20%20%20if(typeof%20d.width%20===%20%5C%22number%5C%22)%20d.width%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7D%60;%5Cn%20%20%20%20%20%20//%20d.height%20=%20d.width%20*%20(resH/resW);%5Cn%20%20%20%20%7D%20else%20if(!d.width%20&&%20d.height)%20%7B%5Cn%20%20%20%20%20%20d.height%20=%20d.height.evaluateItem;%5Cn%20%20%20%20%20%20if(typeof%20d.height%20===%20%5C%22number%5C%22)%20d.height%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60height:$%7Bd.height%7D%60;%5Cn%20%20%20%20%20%20//%20d.width%20=%20d.height%20*%20(resW/resH);%5Cn%20%20%20%20%7D%20else%20if(!d.width%20&&%20!d.height)%20%7B%5Cn%20%20%20%20%20%20//%20make%20the%20smallest%20side%20300px%20by%20default:%5Cn%20%20%20%20%20%20if(resW%20%3E%20resH)%20%7B%5Cn%20%20%20%20%20%20%20%20d.height%20=%20300;%5Cn%20%20%20%20%20%20%20%20widthHeightCss%20=%20%60height:$%7Bd.height%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20//%20d.width%20=%20d.height%20*%20(resW/resH);%5Cn%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20d.width%20=%20300;%5Cn%20%20%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7Dpx%60;%5Cn%20%20%20%20%20%20%20%20//%20d.height%20=%20d.width%20*%20(resH/resW);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%20else%20if(d.width%20&&%20d.height)%20%7B%5Cn%20%20%20%20%20%20if(typeof%20d.width%20===%20%5C%22number%5C%22)%20d.width%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20if(typeof%20d.height%20===%20%5C%22number%5C%22)%20d.height%20+=%20%5C%22px%5C%22;%5Cn%20%20%20%20%20%20widthHeightCss%20=%20%60width:$%7Bd.width%7D;%20height:$%7Bd.height%7D%60;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20if(d.style%20&&%20/%5B;%5C%5Cs%5D?(width%7Cheight):/.test(d.style))%20widthHeightCss%20=%20%5C%22%5C%22;%5Cn%20%20%5Cn%20%20if(!CSS.supports(%5C%22aspect-ratio%5C%22,%20%5C%221/2%5C%22))%20%7B%20//%20hackily%20help%20old%20browsers%20that%20don't%20support%20aspect-ratio%20if%20possible%5Cn%20%20%20%20let%20width%20=%20(widthHeightCss.match(/width:(%5B%5E;%5D+)px;?/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(width%20&&%20!widthHeightCss.includes(%5C%22height%5C%22)%20&&%20!isNaN(Number(width)))%20%7B%5Cn%20%20%20%20%20%20widthHeightCss%20+=%20%60;%20height:$%7BNumber(width)%20*%20(resH/resW)%7Dpx;%60;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20let%20height%20=%20(widthHeightCss.match(/height:(%5B%5E;%5D+)px;?/)%20%7C%7C%20%5B%5D)%5B1%5D;%5Cn%20%20%20%20if(height%20&&%20!widthHeightCss.includes(%5C%22width%5C%22)%20&&%20!isNaN(Number(height)))%20%7B%5Cn%20%20%20%20%20%20widthHeightCss%20+=%20%60;%20width:$%7BNumber(height)%20*%20(resW/resH)%7Dpx;%60;%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20requestId%20=%20Math.random().toString();%5Cn%20%20let%20privateIframeId%20=%20%5C%22id%5C%22%20+%20Math.random().toString().replace(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%5Cn%20%20//%20let%20iframePromiseResolver;%5Cn%20%20//%20let%20iframePromise%20=%20new%20Promise(r%20=%3E%20iframePromiseResolver=r);%5Cn%20%20//%20let%20canvasPromiseResolver;%5Cn%20%20//%20let%20canvasPromise%20=%20new%20Promise(r%20=%3E%20canvasPromiseResolver=r);%5Cn%20%20//%20let%20dataUrlPromiseResolver;%5Cn%20%20//%20let%20dataUrlPromise%20=%20new%20Promise(r%20=%3E%20dataUrlPromiseResolver=r);%5Cn%20%20let%20onFinishPromiseResolver;%5Cn%20%20let%20onFinishPromise%20=%20new%20Promise(r%20=%3E%20onFinishPromiseResolver=r);%5Cn%20%20%5Cn%20%20window.addEventListener('message',%20async%20function(event)%20%7B%5Cn%20%20%20%20if(event.data.type%20===%20'finished'%20&&%20event.data.id%20===%20privateIframeId)%20%7B%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20drawDataURLToCanvas(dataURL)%20%7B%5Cn%20%20%20%20%20%20%20%20return%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20const%20canvas%20=%20document.createElement(%5C%22canvas%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20const%20ctx%20=%20canvas.getContext(%5C%222d%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20const%20img%20=%20new%20Image();%5Cn%20%20%20%20%20%20%20%20%20%20img.onload%20=%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20canvas.width%20=%20img.width;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20canvas.height%20=%20img.height;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20ctx.drawImage(img,%200,%200);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20resolve(canvas);%5Cn%20%20%20%20%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%20%20%20%20%20%20img.src%20=%20dataURL;%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D%5Cn%5Cn%20%20%20%20%20%20let%20canvas%20=%20await%20drawDataURLToCanvas(event.data.dataUrl);%5Cn%20%20%20%20%20%20let%20iframe%20=%20document.querySelector(%60iframe.$%7BprivateIframeId%7D%60);%5Cn%20%20%20%20%20%20let%20dataUrl%20=%20event.data.dataUrl;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20outputData%20=%20%7Bcanvas,%20iframe,%20dataUrl,%20inputs:evaluatedInputs%7D;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20iframe.textToImagePluginOutput%20=%20outputData;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(data.onFinish)%20%7B%5Cn%20%20%20%20%20%20%20%20data.onFinish(outputData);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20onFinishPromiseResolver(outputData);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20//%20dataUrlPromiseResolver(event.data.dataUrl);%5Cn%20%20%20%20%20%20//%20canvasPromiseResolver(canvas);%5Cn%20%20%20%20%20%20//%20iframePromiseResolver(document.querySelector(%60iframe.$%7BprivateIframeId%7D%60));%5Cn%20%20%20%20%7D%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20function%20blobToDataUrl(blob)%20%7B%5Cn%20%20%20%20return%20new%20Promise(r%20=%3E%20%7B%5Cn%20%20%20%20%20%20const%20reader%20=%20new%20FileReader();%5Cn%20%20%20%20%20%20reader.onload%20=%20()%20=%3E%20r(reader.result);%5Cn%20%20%20%20%20%20reader.readAsDataURL(blob);%5Cn%20%20%20%20%7D);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20referenceImage%20=%20null;%5Cn%20%20if(data.referenceImage)%20%7B%5Cn%20%20%20%20referenceImage%20=%20%7B%7D;%5Cn%20%20%20%20//%20url%20can%20actually%20be%20a%20blob%20or%20a%20blob%20URL,%20in%20which%20case%20we%20postMessage%20the%20data%20to%20the%20iframe%5Cn%20%20%20%20let%20isBlobby%20=%20data.referenceImage.url%20instanceof%20Blob;%20//%20blobby%20means%20Blob%20or%20blob%20URL%20string%5Cn%20%20%20%20let%20url,%20blobby;%5Cn%20%20%20%20%5Cn%20%20%20%20if(isBlobby)%20blobby%20=%20data.referenceImage.url;%5Cn%20%20%20%20else%20url%20=%20data.referenceImage.url.evaluateItem;%5Cn%20%20%20%20%5Cn%20%20%20%20if(url.startsWith(%5C%22blob:%5C%22))%20%7B%5Cn%20%20%20%20%20%20isBlobby%20=%20true;%5Cn%20%20%20%20%20%20blobby%20=%20url;%5Cn%20%20%20%20%20%20url%20=%20null;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20if(isBlobby)%20%7B%5Cn%20%20%20%20%20%20referenceImage.url%20=%20%5C%22%3Cdata-via-postmessage%3E%5C%22;%5Cn%20%20%20%20%20%20(async%20()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20let%20blob;%5Cn%20%20%20%20%20%20%20%20if(typeof%20blobby%20===%20%5C%22string%5C%22%20&&%20blobby.startsWith(%5C%22blob:%5C%22))%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20blob%20=%20await%20fetch(blobby).then(r%20=%3E%20r.blob());%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20blob%20=%20blobby;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20let%20dataUrl%20=%20await%20blobToDataUrl(blob);%5Cn%20%20%20%20%20%20%20%20window.addEventListener('message',%20function(event)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20if(event.data.type%20===%20'readyForData'%20&&%20event.data.id%20===%20privateIframeId)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20document.querySelector(%60iframe.$%7BprivateIframeId%7D%60).contentWindow.postMessage(%7Bid:privateIframeId,%20referenceImageDataUrl:dataUrl%7D,%20serverOrigin);%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20%7D)();%5Cn%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20referenceImage.url%20=%20url;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20referenceImage.blur%20=%20data.referenceImage.blur.evaluateItem;%5Cn%20%20%20%20if(referenceImage.url%20%3E%201%20%7C%7C%20referenceImage.url%20%3C%200)%20return%20%60referenceImage.url%20must%20either%20be%20a%20'data%20URL'%20(starting%20with%20'data:')%20or%20a%20https://user-uploads.perchance.org%20URL%20-%20i.e.%20an%20image%20that%20has%20been%20uploaded%20to%20https://perchance.org/upload%20-%20the%20URL%20you've%20used%20is:%20'$%7BreferenceImage.url%20&&%20typeof%20referenceImage.url%20===%20%5C%22string%5C%22%20&&%20referenceImage.url.length%20%3E%2030%20?%20referenceImage.url.slice(0,%2030)+%5C%22...%5C%22%20:%20referenceImage.url%7D'.%60;%5Cn%20%20%20%20if(referenceImage.blur%20%3E%201%20%7C%7C%20referenceImage.blur%20%3C%200)%20return%20%60referenceImage.blur%20must%20be%20between%200%20and%201,%20but%20is%20instead%20'$%7BreferenceImage.blur%20%3E%201%7D'.%60%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20urlHashData%20=%20%7B%5Cn%20%20%20%20saveChannel:%20window.generatorName,%5Cn%20%20%20%20saveTitle:%20d.saveTitle,%5Cn%20%20%20%20saveDescription:%20d.saveDescription,%5Cn%20%20%20%20prompt:%20d.prompt,%5Cn%20%20%20%20seed:%20d.seed,%5Cn%20%20%20%20resolution:%20d.resolution,%5Cn%20%20%20%20guidanceScale:%20d.guidanceScale,%5Cn%20%20%20%20defaultGuidanceScale,%5Cn%20%20%20%20negativePrompt:%20d.negativePrompt,%5Cn%20%20%20%20requestId:%20requestId,%5Cn%20%20%20%20forceColorScheme:%20data.forceColorScheme,%5Cn%20%20%20%20verifyOnly:%20data.verifyOnly,%5Cn%20%20%20%20iframeId:%20privateIframeId,%5Cn%20%20%20%20referenceImage,%5Cn%20%20%7D;%5Cn%20%20%5Cn%20%20//%20clone%20input%20for%20onFinish%20data:%5Cn%20%20evaluatedInputs%20=%20JSON.parse(JSON.stringify(d));%5Cn%20%20%5Cn%20%20let%20iframeId%20=%20data.id%20?%20data.id.evaluateItem%20:%20%5C%22%5C%22;%5Cn%20%20if(iframeId)%20%7B%5Cn%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20document.querySelector(%5C%22#%5C%22+iframeId).reload%20=%20function()%20%7B%5Cn%20%20%20%20%20%20%20%20let%20src%20=%20this.src;%5Cn%20%20%20%20%20%20%20%20this.src%20=%20%5C%22%5C%22;%5Cn%20%20%20%20%20%20%20%20setTimeout(()%20=%3Ethis.src=src,%20700);%5Cn%20%20%20%20%20%20%7D;%5Cn%20%20%20%20%7D,%20500);%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20window.lastTextToImagePrompt%20=%20d.prompt;%5Cn%20%20if(data.prompt)%20%7B%20//%20%3C--%20i.e.%20if%20they%20passed%20a%20promptOptions%20object%5Cn%20%20%20%20data.lastUsedPrompt%20=%20d.prompt;%5Cn%20%20%20%20data.lastUsedNegativePrompt%20=%20d.negativePrompt;%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20//%20VERY%20lazily%20load%20the%20iframe%20(only%20when%20screen%20actually%20intersects)%20because%20some%20people%20add%20a%20lot%20of%20images%20in%20subsections%20and%20in%20several%20different%20tabs%20of%20tabs-plugin,%20etc.%5Cn%20%20//%20This%20ensures%20they%20don't%20spam%20the%20server,%20and%20the%20visible%20ones%20get%20generated%20first.%5Cn%20%20setTimeout(async%20()%20=%3E%20%7B%5Cn%20%20%20%20//%20the%20dev%20may%20have%20generated%20the%20HTML,%20but%20not%20actually%20added%20it%20to%20the%20DOM%20for%20a%20while,%20so%20we%20wait%20up%20to%205%20mins%20for%20it%5Cn%20%20%20%20let%20waitedSeconds%20=%200;%5Cn%20%20%20%20while(%5B...document.querySelectorAll(%5C%22.text-to-image-plugin-image-iframe%5C%22)%5D.filter(el%20=%3E%20el.dataset.alreadyAddedIntersectionObserver%20===%20%5C%22no%5C%22).length%20===%200)%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20waitedSeconds%20+=%200.5;%5Cn%20%20%20%20%20%20if(waitedSeconds%20%3E%2060*5)%20return;%5Cn%20%20%20%20%7D%5Cn%20%20%20%20for(let%20el%20of%20%5B...document.querySelectorAll(%5C%22.text-to-image-plugin-image-iframe%5C%22)%5D)%20%7B%5Cn%20%20%20%20%20%20if(el.dataset.alreadyAddedIntersectionObserver%20===%20%5C%22yes%5C%22)%20continue;%5Cn%20%20%20%20%20%20el.dataset.alreadyAddedIntersectionObserver%20=%20%5C%22yes%5C%22;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20observer1,%20observer2;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20rootMarginSize%20=%20Math.min(1000,%20(window.innerHeight*2));%5Cn%20%20%20%20%20%20if(window.innerWidth%20%3C%20600)%20%7B%5Cn%20%20%20%20%20%20%20%20rootMarginSize%20=%20Math.min(1500,%20(window.innerHeight*3));%20//%20larger%20on%20mobile%20because%20e.g.%20images%20that%20might%20otherwise%20be%20displayed%20side%20by%20side%20are%20instead%20displayed%20vertically%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20function%20handler(entries)%20%7B%5Cn%20%20%20%20%20%20%20%20if(entries%5B0%5D.isIntersecting)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20console.log(%5C%22t2i%20iframe:%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20if(!el.src)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.removeAttribute(%5C%22srcdoc%5C%22);%5Cn%20%20%20%20%20%20%20%20%20%20%20%20el.src%20=%20el.dataset.src;%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer1.disconnect();%5Cn%20%20%20%20%20%20%20%20%20%20%20%20observer2.disconnect();%20%5Cn%20%20%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20//%20console.log(%5C%22t2i%20iframe:%20NOT%20Visible%5C%22);%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20observer1%20=%20new%20IntersectionObserver(handler,%20%7B%5Cn%20%20%20%20%20%20%20%20root:%20document.documentElement,%20//%20otherwise%20I%20think%20it%20uses%20the%20top-level%20viewport?%20either%20way,%20it%20doesn't%20seem%20to%20work%20without%20specifying%20this.%5Cn%20%20%20%20%20%20%20%20rootMargin:%20rootMarginSize+%5C%22px%5C%22,%20//%20it's%20important%20that%20this%20is%20quite%20big%20-%20so%20that%20e.g.%20mobile%20users%20don't%20have%20to%20scroll%20down%20to%20trigger%20stuff.%20we%20basically%20want%20to%20trigger%20~all%20visible%20elements%20anyway%20-%20just%20not%20stuff%20hidden%20within%20e.g.%20tabs%20plugin%20or%20whatever.%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer1.observe(el);%5Cn%20%20%20%20%20%20//%20for%20some%20reason,%20in%20some%20situations,%20the%20above%20intersection%20observer%20was%20reporting%20the%20%60root%60%20and%20%60el%60%20bounding%20rects%20as%200x0x0x0.%20Adding%20a%20second%20observer%20using%20the%20viewport%20root%20fixes%20this:%5Cn%20%20%20%20%20%20observer2%20=%20new%20IntersectionObserver(handler,%20%7B%5Cn%20%20%20%20%20%20%20%20rootMargin:%20rootMarginSize+%5C%22px%5C%22,%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%20%20observer2.observe(el);%5Cn%20%20%20%20%7D%5Cn%20%20%7D,%20100);%20//%20CAUTION:%20do%20not%20remove/lower%20this%20delay.%20Some%20generators%20may%20create%20a%20large%20%5C%22feed%5C%22%20of%20images,%20and%20expect%20them%20to%20be%20lazy-loaded%20when%20scrolled%20to%20(e.g.%20AI%20chat%20feeds),%20so%20if%20you%20add%20the%20intersection%20observers%20~synchronously,%20they%20could%20be%20triggered%20during%20the%20process%20of%20actually%20generating%20the%20feed,%20which%20would%20cause%20them%20to%20all%20start%20generating%20during%20page%20load.%5Cn%20%20%5Cn%20%20let%20outputString%20=%20new%20String(%60%3Ciframe%20$%7BiframeId%20?%20%60id=%5C%22$%7BiframeId%7D%5C%22%60%20:%20%5C%22%5C%22%7D%20class=%5C%22text-to-image-plugin-image-iframe%20$%7BprivateIframeId%7D%5C%22%20data-already-added-intersection-observer=%5C%22no%5C%22%20data-src=%5C%22$%7BserverOrigin%7D/embed#$%7BencodeURIComponent(JSON.stringify(urlHashData))%7D%5C%22%20style=%5C%22border:0;%20background:transparent;%20$%7BwidthHeightCss%7D;%20aspect-ratio:$%7BresW%7D/$%7BresH%7D;%20$%7Bd.style%7D%5C%22%3E%3C/iframe%3E%60);%5Cn%20%20%5Cn%20%20//%20leaving%20these%20out%20for%20now%20in%20favor%20of%20'onFinish'%20in%20prompt%20options%5Cn%20%20//%20outputString.dataUrl%20=%20dataUrlPromise;%5Cn%20%20//%20outputString.canvas%20=%20canvasPromise;%5Cn%20%20outputString.onFinishPromise%20=%20onFinishPromise;%5Cn%20%20outputString.iframeHtml%20=%20outputString;%5Cn%20%20%5Cn%20%20return%20outputString;%5Cn%5Cn%5Cncharacter%5Cn%20%20a%20%7Bmech%7Cdemon%7Ccyberpunk%7D%20%7Bwarrior%7Cminion%7Csamurai%7D%5Cn%5Cnplace%5Cn%20%20soviet%20russia%5Cn%20%20a%20small%20village%5Cn%20%20a%20mountainous%20region%5Cn%20%20an%20underwater%20cavern%5Cn%5Cnseason%5Cn%20%20winter%5Cn%20%20summer%5Cn%20%20%5Cnprompt%5Cn%20%20detailed%20painting%20of%20%5Bcharacter%5D%20in%20%5Bplace%5D,%20%5Bseason%5D%5Cn%20%20%5Cn%20%20%5Cn%20%20%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1713770554129,%22found%22:true%7D,%7B%22name%22:%22upload-plugin%22,%22modelText%22:%22$output(data)%20=%3E%5Cn%20%20//%20if(typeof%20data%20!==%20%5C%22string%5C%22)%20return%20alert(%5C%22error:%20only%20text/strings%20are%20supported%20by%20the%20upload%20plugin%20for%20now.%20please%20request%20other%20types%20on%20the%20forum.%5C%22);%5Cn%20%20%5Cn%20%20if(!window.__alreadyLoadedUploadPluginStuff0435342908)%20%7B%5Cn%20%20%20%20window.__alreadyLoadedUploadPluginStuff0435342908%20=%20true;%5Cn%20%20%20%20%5Cn%20%20%20%20let%20iframe%20=%20document.createElement('iframe');%5Cn%20%20%20%20window.__uploadPluginIframe0435342908%20=%20iframe;%20%5Cn%20%20%20%20%5Cn%20%20%20%20window.addEventListener('message',%20(event)%20=%3E%20%7B%5Cn%20%20%20%20%20%20if(event.source%20!==%20iframe.contentWindow)%20return;%5Cn%20%20%20%20%20%20if(event.origin%20!==%20%5C%22https://upload.perchance.org%5C%22)%20return;%5Cn%20%20%20%20%20%20console.log(%5C%22upload%20plugin%20got%20message:%5C%22,%20event);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(event.data.type%20===%20%5C%22uploadEmbedIsReady%5C%22)%20%7B%20%20%20%5Cn%20%20%20%20%20%20%20%20window.__uploadPluginEmbedIsReady%20=%20true;%5Cn%20%20%20%20%20%20%20%20console.log(%5C%22upload%20plugin%20embedIsReady%5C%22);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20email==false%20implies%20anon%20upload%5Cn%20%20%20%20iframe.src%20=%20%60https://upload.perchance.org/embed#$%7BJSON.stringify(%7Bemail:false,%20sessionToken:false%7D)%7D%60;%5Cn%20%20%20%20iframe.style.cssText%20=%20'width:1px;%20height:1px;%20border:none;%20top:-100px;%20left:-100px;%20position:fixed;';%5Cn%20%20%20%20document.body.appendChild(iframe);%5Cn%20%20%20%20%5Cn%20%20%20%20//%20ping%20embed%20until%20it%20is%20ready%20(hacky%20way%20to%20wait%20for%20it%20to%20load)%5Cn%20%20%20%20(async%20function()%20%7B%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20500));%5Cn%20%20%20%20%20%20while(!window.__uploadPluginEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20200));%5Cn%20%20%20%20%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22init%5C%22%7D,%20'https://upload.perchance.org');%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D)();%5Cn%20%20%7D%5Cn%20%20%5Cn%20%20let%20iframe%20=%20window.__uploadPluginIframe0435342908;%5Cn%20%20%5Cn%20%20let%20requestId%20=%20%5C%22id%5C%22+(Math.random().toString()+Math.random().toString()).replaceAll(%5C%22.%5C%22,%20%5C%22%5C%22);%5Cn%20%20%5Cn%20%20let%20promiseResolver,%20promiseRejecter;%5Cn%20%20let%20promise%20=%20new%20Promise((resolve,%20reject)%20=%3E%20%7B%5Cn%20%20%20%20promiseResolver%20=%20resolve;%5Cn%20%20%20%20promiseRejecter%20=%20reject;%20//%20unused.%5Cn%20%20%7D);%5Cn%20%20%5Cn%20%20function%20messageHandler(event)%20%7B%5Cn%20%20%20%20if(event.source%20!==%20iframe.contentWindow)%20return;%5Cn%20%20%20%20if(event.origin%20!==%20%5C%22https://upload.perchance.org%5C%22)%20return;%5Cn%5Cn%20%20%20%20if(event.data.type%20===%20%5C%22anonUploadResponse%5C%22%20&&%20event.data.requestId%20===%20requestId)%20%7B%5Cn%20%20%20%20%20%20let%20url%20=%20event.data.result.url;%5Cn%20%20%20%20%20%20let%20error%20=%20event.data.result.error;%5Cn%20%20%20%20%20%20let%20size%20=%20event.data.result.size;%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20if(!error)%20error%20=%20null;%20//%20just%20make%20sure%20it's%20null%20rather%20than%20'undefined',%20since%20that's%20part%20of%20the%20specified%20behavior%5Cn%20%20%20%20%20%20promiseResolver(%7Burl,%20error,%20size%7D);%20//%20always%20'resolve'%20(i.e.%20we%20don't%20%60reject%60%20on%20error).%20easier%20for%20people%20to%20handle%20errors%20without%20knowing%20about%20try/catch%20stuff%20-%20they%20just%20check%20if%20%60error%60%20is%20null%5Cn%20%20%20%20%20%20window.removeEventListener('message',%20messageHandler);%5Cn%20%20%20%20%20%20%5Cn%20%20%20%20%20%20let%20el%20=%20document.querySelector(%60#$%7BrequestId%7D%60);%5Cn%20%20%20%20%20%20if(el)%20%7B%5Cn%20%20%20%20%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20error;%5Cn%20%20%20%20%20%20%20%20%7D%20else%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20el.innerHTML%20=%20%60%3Ca%20href=%5C%22$%7Burl%7D%5C%22%20target=%5C%22_blank%5C%22%3E$%7Burl%7D%3C/a%3E%60;%5Cn%20%20%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%20%20if(error)%20%7B%5Cn%20%20%20%20%20%20%20%20let%20div%20=%20document.createElement(%5C%22div%5C%22);%5Cn%20%20%20%20%20%20%20%20div.innerHTML%20=%20%60%3Cdiv%20style=%5C%22z-index:1000;%20position:%20fixed;%20bottom:%201rem;%20width:%20100%25;%20pointer-events:none;%5C%22%3E%3Cspan%20style=%5C%22%20padding:%200.5rem;%20background:%20#ac2c2c;%20border-radius:%203px;%20color:%20white;%20pointer-events:auto;%5C%22%3Eupload%20error:%20$%7Berror.replaceAll(%5C%22_%5C%22,%20%5C%22%20%5C%22)%7D%3C/span%3E%3C/div%3E%60;%5Cn%20%20%20%20%20%20%20%20div%20=%20div.firstElementChild;%5Cn%20%20%20%20%20%20%20%20document.body.appendChild(div);%5Cn%20%20%20%20%20%20%20%20setTimeout(()%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20%20%20div.remove();%5Cn%20%20%20%20%20%20%20%20%7D,%201000*5);%5Cn%20%20%20%20%20%20%7D%5Cn%20%20%20%20%7D%5Cn%20%20%7D%5Cn%20%20window.addEventListener('message',%20messageHandler);%5Cn%20%20%5Cn%20%20(async%20function()%20%7B%5Cn%20%20%20%20while(!window.__uploadPluginEmbedIsReady)%20%7B%5Cn%20%20%20%20%20%20console.log(%5C%22waiting%20for%20upload%20iframe%20embed%20to%20be%20ready%5C%22);%5Cn%20%20%20%20%20%20await%20new%20Promise(r%20=%3E%20setTimeout(r,%20100));%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20function%20blobToDataUrl(blob)%20%7B%5Cn%20%20%20%20%20%20return%20new%20Promise((resolve,%20_)%20=%3E%20%7B%5Cn%20%20%20%20%20%20%20%20const%20reader%20=%20new%20FileReader();%5Cn%20%20%20%20%20%20%20%20reader.onloadend%20=%20()%20=%3E%20resolve(reader.result);%5Cn%20%20%20%20%20%20%20%20reader.readAsDataURL(blob);%5Cn%20%20%20%20%20%20%7D);%5Cn%20%20%20%20%7D%5Cn%20%20%20%20%5Cn%20%20%20%20let%20dataUrl;%5Cn%20%20%20%20if(typeof%20data%20===%20%5C%22string%5C%22)%20dataUrl%20=%20%60data:text/plain;charset=utf-8,$%7BencodeURIComponent(data)%7D%60;%5Cn%20%20%20%20if(data%20instanceof%20Blob)%20dataUrl%20=%20await%20blobToDataUrl(data);%5Cn%20%20%20%20%5Cn%20%20%20%20iframe.contentWindow.postMessage(%7Btype:%5C%22anonUploadRequest%5C%22,%20requestId,%20dataUrl,%20generatorName:window.generatorName%7D,%20'https://upload.perchance.org');%5Cn%20%20%7D)();%5Cn%20%20%5Cn%20%20promise.toString%20=%20function()%20%7B%5Cn%20%20%20%20return%20%60%3Cspan%20id=%5C%22$%7BrequestId%7D%5C%22%3Euploading...%3C/span%3E%60;%5Cn%20%20%7D;%5Cn%20%20return%20promise;%5Cn%5Cn%5Cn%5Cn%22,%22imports%22:%5B%5D,%22lastEditTime%22:1710850009628,%22found%22:true%7D%5D</script>
        <script id="imported-generator-names" type="notjs">%5B%22animal%22,%22huge-emoji-list%22,%22t2i-framework-plugin-v2%22,%22t2i-styles%22,%22simple-gen-footer%22,%22ai-text-plugin%22,%22comments-plugin%22,%22fullscreen-button-plugin%22,%22select-leaf-plugin%22,%22text-to-image-plugin%22,%22upload-plugin%22%5D</script>
        <script id="this-html-server-render-time" type="notjs">1715103909692</script>
        
        
        <script>window.generatorPublicId = "cd282495464c4f81bf84e2ef3974e6f6";</script>
        <script>window.generatorLastSaveTime = Number(`1714869040127`);</script>


        <script>
          window.generatorData = window.js0nparse( decodeURI( document.querySelector("#preloaded-generator-data").innerText ) );
          window.generatorCanLinkWithRelFollow = generatorData.canLink; // make it global so the iframe-based description update has access to it.

          // For crawlers that don't have es6 support and thus can't execute the iframe:
          if(!window.canExecuteModernJavascript) {
            window.addEventListener("DOMContentLoaded", function() {
              var data = window.generatorData;

              window.document.querySelector("#generator-description").innerHTML = DOMPurify.sanitize(data.outputTemplate, {ALLOWED_TAGS: ['h1', 'h2', 'h3', 'h4', 'p', 'div', 'pre', 'button', 'i', 'b', 'a', 'ul', 'li', 'br', 'ol', 'hr', 'span'], ALLOWED_ATTR: ['href']});
              var pre = document.createElement('pre');
              pre.innerText = data.modelText.slice(0, 10000);
              window.document.querySelector("#generator-description").appendChild(pre);
              
              window.document.querySelector("#generator-description").style.cssText = "";

              var h1 = window.document.querySelector("#generator-description h1");
              if(!h1) h1 = window.document.querySelector("#generator-description h2");
              if(h1) {
                var h1Text = h1.textContent;
                if(h1Text !== "Your Generator's Title" && h1Text !== "Minimal Example" && h1Text.indexOf("[") === -1 && h1Text.indexOf("]") === -1) {
                  document.title = h1Text+" ― Perchance" + (h1Text.toLowerCase().includes("gener") ? "" : " Generator");
                }
              } else {
                let title = window.location.pathname.slice(1).split("-").filter(function(a){return a;}).map(function(word){return word[0].toUpperCase()+word.slice(1); }).join(" ");
                document.title = title+" ― Perchance" + (title.toLowerCase().includes("gener") ? "" : " Generator");
              }

              if(!window.generatorCanLinkWithRelFollow) {
                var links = window.document.querySelectorAll("#generator-description a");
                for(var i = 0; i < links.length; i++) {
                  links[i].rel = "nofollow";
                }
              }
            });
          }
        </script>

        <script data-src="/tags/all-tags-compiled-BUNDLE.js?v=s2jd424f337390d9dd43333333e9463d42h38331749438hf" type="riot/tag"></script>

        <!-- CODEMIRROR (stylesheets MUST come before javascript init) -->
        <!-- <link rel="stylesheet" href="/lib/codemirror/codemirror.css?v=3452338345">
        <link rel="stylesheet" href="/lib/codemirror/foldgutter.css?v=3453423554">
        <script src="/lib/codemirror/js/codemirror-5.51.0-BUNDLE.js?v=44s8534s53d4936"></script> -->

        <link rel="stylesheet" href="../../perchance.org/lib/codemirror/5.65.15/css/codemirror-with-addons-bundle_v%3D2d.css">
        <script src="../../perchance.org/lib/codemirror/5.65.15/js/codemirror-with-addons-bundle.min_v%3D2dd.js"></script>

        <script src="../../perchance.org/lib/perchance/codeMirrorHighlighter_v%3Dd24d34ddsdss7d49.js"></script>

        <!-- LIBS -->
        <script src="../../perchance.org/lib/splitjs/split.min.js"></script>
        <script src="../../perchance.org/lib/axios-0.15.3.min.js"></script>
        <script src="../../perchance.org/lib/Store.js"></script>
        <script src="../../perchance.org/lib/purify.min.js"></script>
        <script async="" src="../../perchance.org/lib/diff_match_patch.js"></script>
        <!-- <script src="lib/diff.min.js"></script> -->


        <!-- CSS LOADING SPINNER -->
        <style>
          .ldspmzjfhueifssge-ring {
            display: inline-block;
            position: relative;
            width: 64px;
            height: 64px;
          }
          .ldspmzjfhueifssge-ring div {
            box-sizing: border-box;
            display: block;
            position: absolute;
            width: 51px;
            height: 51px;
            margin: 6px;
            border: 6px solid #444;
            border-radius: 50%;
            animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
            border-color: #444 transparent transparent transparent;
          }
          .ldspmzjfhueifssge-ring div:nth-child(1) {
            animation-delay: -0.45s;
          }
          .ldspmzjfhueifssge-ring div:nth-child(2) {
            animation-delay: -0.3s;
          }
          .ldspmzjfhueifssge-ring div:nth-child(3) {
            animation-delay: -0.15s;
          }
          @keyframes lds-ring {
            0% {
              transform: rotate(0deg);
            }
            100% {
              transform: rotate(360deg);
            }
          }
          @media (prefers-color-scheme: dark) {
            #outputLoadSpinner {
              filter: invert(1);
            }
          }
        </style>

        <script>
          let thisIsNotAnOldCachedPageResolver;
          window.thisIsNotAnOldCachedPagePromise = new Promise(r => thisIsNotAnOldCachedPageResolver=r);
          // CloudFlare sometimes has cache purging delays, and these can really mess things up (e.g. make it look like you've lost hours of work).
          // We check the `age` header of this document, and if it's older than the last save time of this generator, then we load a cache-busted URL
          // and then remove the added cacheBust string with history.replaceState
          (async function() {
            if(navigator.webdriver) return; // just in case this is what's confusing the Google crawler - RE the title bug
            if(window.location.href.includes("__cacheBust")) {
              thisIsNotAnOldCachedPageResolver(true);
              return; // no need to run this check if cache is already busted
            }

            let imports = window.js0nparse(decodeURI(document.querySelector("#imported-generator-names").textContent));
            let clientHtmlServerRenderTime = Number(document.querySelector("#this-html-server-render-time").textContent);
            
            let transferSize = 1;
            try { transferSize = performance.getEntriesByType("navigation")[0].transferSize; } catch(e) {}
            if(isNaN(transferSize)) transferSize = 1;
            // transferSize will be zero if it was loaded from browser cache, assuming the user's browser supports the API

            let weHaveAnOldVersionOfThisGen = await fetch(`https://perchance.org/api/clearCacheIfGeneratorOrImportsHaveBeenUpdated?generatorName=${window.location.pathname.slice(1)}&importedGeneratorNames=${imports.join(",")}&clientHtmlServerRenderTime=${clientHtmlServerRenderTime}&transferSize=${transferSize}&__cacheBust=${Math.random()}`).then(r => r.json()).catch(e => { console.error(e); return true; });
            if(weHaveAnOldVersionOfThisGen) {
              console.log("This is an old version of this generator. Doing cache bust reload now...");
              let url = new URL(window.location.href);
              url.searchParams.set("__cacheBust", Math.random());
              window.location.href = url.href;
            } else {
              thisIsNotAnOldCachedPageResolver(true);
            }
          })();
          if(location.href.includes("__cacheBust")) {
            window.needToBustCacheOfIframeOnInitialLoad = true;
            let url = new URL(window.location.href);
            url.searchParams.delete("__cacheBust");
            let newPath = url.href.replace(/^https:\/\/perchance\.org/, "");
            history.replaceState({}, "", newPath);
          }
        </script>

        <app></app>

        <!-- <script src="/lib/riotjs/riot-3.0.5.min.js"></script> -->
        <script src="../../perchance.org/lib/riotjs/riot%2Bcompiler-3.0.5.min.js" onerror="setTimeout(window.location.reload, 3000)"></script>
        <script></script>
        <!--<script src="lib/riotjs/riot+compiler-3.13.2.min.js"></script>-->
        <script>window.remoteResourcesLoaded = true;</script>
        <script>
          window.empty883974329 = "";
          window.modalFn1Name = "alert";
          window.rlFn1Name = `relo${window.empty883974329}ad`;
          window.ftcFn1Name = "fetch";
          window.ap1pend1ChildFn2Name = "appendChild";
          window.doc34828272947 = "document";

          try { // adding try/catch here in case of future instances of this: https://lemmy.world/post/4913660
            window.generatorDependenciesData = window.js0nparse( decodeURI( document.querySelector("#imported-generators").innerText ) );
          } catch(e) {
            if(!location.href.includes("__generatorDependenciesCacheBust")) { // try a cache bust if we haven't already.
              let url = new URL(window.location.href);
              url.searchParams.set("__generatorDependenciesCacheBust", Math.random());
              window.location.href = url.href; 
              throw new Error("exiting script tag for dependency cache bust"); // since we can't `return` at top level
            } else { // if we've already tried bust, don't do it again, else it'll be a refresh loop
              window.generatorDependenciesData = [];
              let errorCode = 1;
              if(document.querySelector("#imported-generators").innerText === "") {
                errorCode = 2;
              } else {
                errorCode = 3;
                try {
                  decodeURI(document.querySelector("#imported-generators").innerText);
                } catch(e) {
                  errorCode = 4;
                }
              }
              alert(`There was some sort of bug parsing the imports of this generator. Buggy ad blockers can sometimes cause this. Please report this at https://lemmy.world/c/perchance and mention this error code: ${errorCode}`);
            }
          }

          if(location.href.includes("__generatorDependenciesCacheBust")) {
            let url = new URL(window.location.href);
            url.searchParams.delete("__generatorDependenciesCacheBust");
            let newPath = url.href.replace(/^https:\/\/perchance\.org/, "");
            history.replaceState({}, "", newPath);
          }

          window.iudu843975 = "bbb";
          if(iudu843975.includes("a")) {
            uruf8ufd.jfurwe8j;
          }
          if(iudu843975.includes("a")) {
            uruf8ufd.jfurwe8j;
          }
          if
          (`bbb`.includes("a")) {
            throw new Error("sus");
            uruf8ufd.jfurwe8j;
          }

          if(String.prototype.includes.toString().indexOf("return true") !== -1) {
            uruf8ufd.jfurwe8j;
          }
          
          if(window.generatorDependenciesData.filter(d => d.name === "ai-text-to-image-plugin" || d.name === "ai-text-plugin").length > 0 && !(window[`local${window.empty883974329}Storage`]["app-storage"] || "").includes("sessionToken")) {
            setTimeout(() => {
              `script> (function() { window.ad1sAreShowing = async () => let adEl window[window.doc34828272947].querySelector(".ad-providers-ctn-el"); if(adEl && adEl.innerHTML.length > 5 adEl.offsetParent !== null adEl.offsetHeight 20) return true; // 20 adEl.querySelector("iframe")) false; }; already1AddedAd3vertIfNeeded window.addEventListener("message", function(e) origin e.origin || e.originalEvent.origin; For Chrome, the property is in event.originalEvent object. if(origin "https://null.perchance.org" https://{window.generatorPublicId}.perchance.org) return; } if(e.data.type === (usingAdPowered+Plugin) window.location.pathname '/text-to-image-plugin' '/ai-text-plugin') ad2dAdvert(); }); setTimeout(() if(window.generatorData.imports.includes("ai-text-to-image-plugin") window.generatorData.imports.includes("ai-text-plugin")) }, 10); function ad2dAdvert() if(already1AddedAd3vertIfNeeded) if(window.location.hash "#edit") window[window.ftcFn1Name]("/api/count?key=uaine"); if((window[local+Storage]["app-storage"] window[local+Storage]["app-storage"].includes("sessionToken")) navigator.webdriver) not for logged-in users and screenshot bot window[window.ftcFn1Name]("/api/count?key=uaineala"); adCtn createAdCtn(); while(!window[window.doc34828272947].querySelector("#main")) await new Promise(r setTimeout(r, 200)); ResizeObserver(function() window[window.doc34828272947].querySelector("#main").style.bottom (adCtn.offsetHeight + 8*2)+"px"; }).observe(adCtn); ad1Provider6Name "freestar"; if(window.location.hash.startsWith("#ad1Provider6Name=")) window.location.hash.slice("#ad1Provider6Name=".length); if(ad1Provider6Name sni{("")+("") (window._a3d8 ? "d*li-_?s" : "")}gel "freestar" "sovrn") console.log("ad:", ad1Provider6Name); "")}gel; if(window.location.pathname "/fqruxwnngk") try to avoid multiple CMP popups, we choose one ad provider remember it: validad1Provider6Names ["freestar", "")}gel]; ad1Provider6NameSetTime window[local+Storage].ad1Provider6NameSetTime !isNaN(Number(window[local+Storage].ad1Provider6NameSetTime))? Number(window[local+Storage].ad1Provider6NameSetTime) daysBetweenRandomize 60; if(!window[local+Storage].ad1Provider6Name !validad1Provider6Names.includes(window[local+Storage].ad1Provider6Name) (ad1Provider6NameSetTime Date.now()-ad1Provider6NameSetTime 1000*60*60*24*daysBetweenRandomize)) window[local+Storage].ad1Provider6Name Math.random()  0.5 Date.now(); window[local+Storage].ad1Provider6Name; catch(e) console.error(e); "freestar") checkConsent() __tcfapi("getTCData", 2, (tcData, success) if(success) a tcData.purpose.consents[1]; b tcData.purpose.consents[10]; c tcData.purpose.legitimateInterests[10]; d tcData.eventStatus if((!a !b !c) & "cmpuishown") window.__tcfapi("displayConsentUi", {}); else window.userGaveAdConsent (async che1ckTCF() 100)); if(window.__tcfapi == undefined) setTimeout(che1ckTCF, 1000); checkConsent(); })(); adCtn.innerHTML div class="ad-providers-ctn-el" align="center" data-freestar-ad="__320x100 __970x90" id="perchanceorg_footer">/div>; window.freestar {}; window.freestar.queue []; window.freestar.config window.freestar.config.enabled_slots window.freestar.initCallback (window.freestar.config.enabled_slots.length 0) window.freestar.initCallbackCalled false window.freestar[newAd{ ""}Slots](window.freestar.config.enabled_slots) if(window.location.hash.includes("testCMP")) (inmobi choice): script window[window.doc34828272947].createElement("script"); script.src https://user-upload{ ""}s.perchance.org/file/63c85ff7ce3ecc0323e0bbd555078fad.js; window[window.doc34828272947].head[window.ap1pend1ChildFn2Name](script); while(!window.cmpScriptHasExecuted) 50)); script.dataset.cfasync "false"; script.async "https://a.pub.network/perchance-org/pubfig.min.js"; if(window.location.hash.includes("testAntiAdBlock")) anti -adblock: ""}s.perchance.org/file/01cea1291c0dbb7b775dc89a385d1d4a.js; window.freestar.config.enabled_slots.push({ placementName: "perchanceorg_footer", slotId: "perchanceorg_footer" "")}gel) this code needed ensure that load immediately after accepting cmp 'reconsider' window.addEventListener('adnginLoaderReady', function() __tcfapi('addEventListener', function(tcData, if(success (tcData.eventStatus 'tcloaded' 'useractioncomplete')) if(tcData.gdprApplies) __tcfapi('getVendorList', function(gvl, 'useractioncomplete') adngin.queue.push(function() adngin.cmd.startAuction(["responsive_banner"]); 'tcloaded') if(Object.keys(tcData.vendor.consents).length Object.keys(gvl.vendors).length Object.keys(tcData.purpose.consents).length Object.keys(gvl.purposes).length) id="adngin-responsive_banner-0">/div>; https://cdn.sni{("")+("") "")}gelweb.com/adengine/perchance.org/loader.js; setTimeout(async if(await window.ad1sAreShowing()) script.nonce "SEahoBjLmnC565bNlPFeWA"; "https://fundingchoicesmessages.google.com/i/pub-9885689965057708?ers=1"; {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) (window[window.doc34828272947].body) {const iframe window[window.doc34828272947].createElement('iframe'); iframe.style 'width: 0; height: border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display 'none'; iframe.name 'googlefcPresent'; window[window.doc34828272947].body [window.ap1pend1ChildFn2Name](iframe);} {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})(); 30000); window.b8473892 if(window[local+Storage]["app-storage"] (already done above - just defend against future edit mistakes) window[window.ftcFn1Name]("/api/count?key=abt"); if(!(await window.ad1sAreShowing())) window[window.ftcFn1Name]("/api/count?key=abpr" ); if(window[local+Storage].abpr "1") window[window.ftcFn1Name]("/api/count?key=abpr2"); window[local+Storage].abpr "1"; scri12pts ifra2mes coo1kies clasi window[window.ftcFn1Name](https://cdn.sni{("")+("") "")}gelweb.com/adengine/perchance.org/loader.js).then(r r.text()).then(t t.includes(dou{ ""}bleclick) t.includes("adengine") t.includes("adconsent") t.includes("GDPR")).catch(e false)) window[window.ftcFn1Name]("/api/count?key=abprbclas"); if([...window[window.doc34828272947].querySelectorAll("iframe")].filter(el el.src).map(el URL(el.src).hostname).find(n n[ends{ ""}With](dou{ ""}bleclick.net) ""}With]("onetag-sys.com") ""}With]("openx.net") ""}With](".google.com") ""}With](amazon-ad{''}system.com) ""}With]("rubiconproject.com") ""}With]("criteo.com") ""}With]("3lift.com") ""}With]("googlesyndication.com") ""}With]("connectad.io"))) window[window.ftcFn1Name]("/api/count?key=abprbclasi"); if(window.userGaveAdConsent window.gdprDoesNotApply) if(window.js0nparse(window[local+Storage].id5id_privacy "{}").id5_consent true) if(clasi coo1kies) window[window.ftcFn1Name]("/api/count?key=abprbclasiadgc"); if(scri12pts maybe auction failed or whatever !coo1kies) window[window.modalFn1Name](Your browser seems be blocking cookies, which preventing ad{ "s"} from being shown. You may need add an exception 'perchance.org' your cookie blocker 'incognito browsing' feature. Sometimes VPN antivirus software has as bonus feature.\n\nWhy are necessary? Well, Perchance free doesn't have by default, but creator of generator imported ad-powered plugin (e.g. text-to-image plugin). Plugins use expensive server resources can only exist thanks "s"}. This page will auto-refresh 60 seconds (apologies).); generally "s"}, "s"}.\n\nPlease help keep it turning off blocker. (apologies).\n\n(NOTE: If still aren't loading you even blocker, then also turn 'cookie' perchance.org on built-in cookie-blocking antivirus/incognito/VPN/etc if feature).); start1WarnProcess(); window[window.ftcFn1Name]("/api/count?key=utoab"); 60000); 50); img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtgAAABaAQMAAAC4+rO8AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAANQTFRFXrP/I7IslgAAAB9JREFUeJztwYEAAAAAw6D5U1/gCFUBAAAAAAAAAHwDIFgAAVR0zeEAAAAASUVORK5CYII="/>; if(window.innerWidth 1400) div window[window.doc34828272947].createElement("div"); div.style.cssText position: absolute; right: font-family: sans-serif; background: #dedede; padding: 0.2rem 0.25rem; border-radius: 3px; cursor: pointer; color: #676767;; div.onclick window[window.modalFn1Name]('The funded via advertisements.'); div.id whyAd{ "s"}Button1El; div.innerHTML why "s"}?; adCtn[window.ap1pend1ChildFn2Name](div); 2000); window[window.doc34828272947].body [window.ap1pend1ChildFn2Name](adCtn); window.adCtn adCtn; abp|cookie|browser|async|ads|alert|ad{ ""}s; window.e7827462 100); /script> createAdCtn() maxHeight window.innerWidth 600 50 90; maxHeight; minHeight; 700) desktop minHeight mobile 100; 50; adCtn.style.cssText position:var(--does-not1-exist-98437593, fixed); bottom:8px; right:8px; left:8px; min-height:{minHeight}px; height:{maxHeight}px; overflow:hidden; text-align:center; display:flex; align-items:center; justify-content:center;; start1WarnProcess() warnEl helperNotice ""; 800) div>a href="https://user-upload{ "s"}.perchance.org/file/06b63cbc807acaf79bc25f114bb0dda1.webp" target="_blank">click here/a> it's working don't understand/div>; warnEl.innerHTML += style="max-width:700px; margin:0 auto;">span style="font-weight:bold; color:#f60000;">the author plugin. pls ad/cookie free. 😳/span> {helperNotice "try Chrome Firefox working."}/div>; if(!window.adCtn) window[window.doc34828272947].body [window.ap1pend1ChildFn2Name](window.adCtn); window.adCtn[window.ap1pend1ChildFn2Name](warnEl); if(window[window.doc34828272947].querySelector(#whyAd{ ""}sButton1El)) window[window.doc34828272947].querySelector(#whyAd{ ""}sButton1El).style.display "none"; warnEl.remove(); window.ad1sAreShowing() !window.e7827462 !window.b8473892)) window.onbeforeunload undefined; window.location[rlFn1Name](); handler() if(!window.e7827462 !window.b8473892) deps window.generatorDependenciesData.map(d d.name); if(!deps.includes("ai-text-to-image-plugin") !deps.includes("ai-text-plugin")) setTimeout(handler, 10001);`;
              document.elementFromPoint;
              document.body.innerHTML;
              window[window.doc34828272947];
              window.alert;
              window.document;
              window.location;
              window["location"];
              "window[`onbefor${''}eunload`] = undefined;";
              'window[`onbefor${""}eunload`] = undefined;';
              "window[`onbefor${window.empty883974329}eunload`] = undefined;";
              "window[`loca${window.empty883974329}tion`][rlFn1Name]();";
              let a32 = window.alert;
              window.alert = function(...args) {
                a32.bind(window)(...args);
              };
              if(!window.alert.toString().includes("a32")) {
                throw new Error("hmm");
                uruf8ufd.jfurwe8j;
              }
              globalThis.da_Zz3qe33sEsZ1 = true;

              function aaa534535() {
                function createAdCtn() {
                  let adCtn = window[doc34828272947].createElement("div");
                  // let maxHeight = window.innerWidth < 600 ? 50 : 90;
                  let maxHeight;
                  let minHeight;
                  if(window.innerWidth > 700) { // desktop
                    minHeight = 90;
                    maxHeight = 90;
                  } else { // mobile
                    maxHeight = 100;
                    minHeight = 50;
                  }
                  adCtn.style.cssText = `position:var(--does-not1-exist-98437593, fixed); bottom:8px; right:8px; left:8px; min-height:${minHeight}px; height:${maxHeight}px; overflow:hidden; text-align:center; display:flex; align-items:center; justify-content:center;`;
                  return adCtn;
                }

                globalThis.hu_8urej4 = true;
                function start1WarnProcess() {
                  let warnEl = window[doc34828272947].createElement("div");
                  let helperNotice = "";
                  if(window.innerWidth > 800) helperNotice = `<div><a href="https://user-uploa${window.empty883974329}ds.perchance.org/file/06b63cbc807acaf79bc25f114bb0dda1.webp" target="_blank">click here</a> if it's still not working or if you don't understand</div>`;
                  warnEl.innerHTML += `<div style="max-width:700px; margin:0 auto;"><span style="font-weight:bold; color:#f60000;">the author of this generator has imported an ad-powered plugin. pls turn off your ad/cookie blocker to keep this free. this page will auto-refresh in 60 seconds 😳</span> ${helperNotice || "try Chrome or Firefox if it's not working."}</div>`;
                  if(!window.adCtn) {
                    window.adCtn = createAdCtn();
                    window[doc34828272947].body [window.ap1pend1ChildFn2Name](window.adCtn);
                  } else {
                    window.adCtn.innerHTML = "";
                  }
                  window.adCtn[window.ap1pend1ChildFn2Name](warnEl);
                  if(window[doc34828272947].querySelector(`#whyA${window.empty883974329}dsButton1El`)) {
                    window[doc34828272947].querySelector(`#whyA${window.empty883974329}dsButton1El`).style.display = "none";
                  }

                  setTimeout(async () => {
                    warnEl.remove();
                    if(!window.ad1sAreShowing || !(await window.ad1sAreShowing() || !window.e7827462 || !window.b8473892)) {
                      window[`onbefor${window.empty883974329}eunload`] = undefined;
                      if(window.userGaveAdConsent === false && window.gdprDoesNotApply === false) {
                        localStorage.clear();
                      }
                      window[`loca${window.empty883974329}tion`][rlFn1Name]();
                    }
                  }, 60001);
                  window.freestar?.analytics?.track?.toString().includes("track(")
                }

                {
                  async function handler() {
                    window.u8398201 = true;
                    if(!window.e7827462 || !window.b8473892) {
                      let deps = window.generatorDependenciesData.map(d => d.name);
                      if(!deps.includes("ai-text-to-image-plugin") && !deps.includes("ai-text-plugin")) return;
                      if(window[`local${window.empty883974329}Storage`]["app-storage"] && window[`local${window.empty883974329}Storage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`local${window.empty883974329}Storage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return;

                      start1WarnProcess();

                      await new Promise(r => setTimeout(r, 1000*40));
                      if(!window.adCtn || getCElement(window.adCtn).src?.includes?.("perchance.org")) {
                        let ms1g = "AI-powered generators on Perchance are entirely funded by ads. Please disable your ad blocker and reload the page. This page will auto-reload in 60 seconds." .replace(/_/g, "");
                        try { alert(ms1g); } catch(e) { window[doc34828272947].body.innerHTML = ms1g; };
                        setTimeout(() => {
                          window[`onbefor${window.empty883974329}eunload`] = undefined;
                          window[`loca${window.empty883974329}tion`][rlFn1Name]();
                        }, 60001);
                      }
                    }
                  }
                  setTimeout(handler, 30001);
                }
                function getCElement(el) {
                  const rect = el.getBoundingClientRect();
                  return document.elementFromPoint(rect.left + rect.width / 2, rect.top + rect.height / 2);
                }
              }
              
              riot.mount('app', {
                generator: window.generatorData,
                dependencies: window.generatorDependenciesData,
              });
              window.successfulPageLoad = true;
            }, 0);
          } else {
            globalThis.da_Zz3qe33sEsZ1 = true;

            riot.mount('app', {
              generator: window.generatorData,
              dependencies: window.generatorDependenciesData,
            });
            window.successfulPageLoad = true;
          }
        </script>
        
        <link rel="stylesheet" href="../../perchance.org/lib/normalize.css">
        <link rel="stylesheet" href="../../perchance.org/index_v%3D9es3eddsd.css">
        <link href="https://fonts.googleapis.com/css?family=Cousine&amp;display=swap" rel="stylesheet">
        
        <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-YJWJRNESS5"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-YJWJRNESS5');
          
          try {
            setTimeout( function() { // wait for riotjs to render everything (we're not in any hurry)
              document.querySelector("#verify-account-button").addEventListener('click', function() {
                gtag("event", "signup", {});
              });
            }, 20*1000);
          } catch(e) { console.error(e); }
        </script>


        <script>
        window.downloadTextFile = (text, name) => {
          const a = document.createElement('a');
          const type = name.split(".").pop();
          a.href = URL.createObjectURL( new Blob([text], { type:`text/${type === "txt" ? "plain" : type}` }) );
          a.download = name;
          a.click();
        }
        (async function() {
          while(!window.diff_match_patch) {
            await new Promise(r => setTimeout(r, 500));
          }
          var dmp = new diff_match_patch();
          window.diffStuff = {}; //patches, modelTextPatches and outputTemplatePatches get added to this object in revisions-modal.tag. It's hacky, but it'll do for now.
          window.diffStuff.openNewTabWithRevision = function(revisionNumber, generatorName) {
            let modelText = this._patchesToRevision(this.modelTextPatches, revisionNumber);
            let outputTemplate = this._patchesToRevision(this.outputTemplatePatches, revisionNumber);

            // we used encodeURI to fix emojis problem with https://github.com/google/diff-match-patch, so we need to decode:
            modelText = decodeURI(modelText);
            outputTemplate = decodeURI(outputTemplate);

            let intro = "<<<<< this file contains your perchance lists first, and your HTML code underneath it >>>>>\n\n\n\n";
            window.downloadTextFile(intro+modelText+("\n".repeat(20))+outputTemplate+("\n".repeat(20)), `${generatorName}-revision-${revisionNumber}.txt`);
          };
          window.diffStuff._patchesToRevision = (patches, revisionNumber) => {
            if(revisionNumber > patches.length-1 || revisionNumber < 0) throw new Error(`revisionNumber ${revisionNumber} doesn't exist. max index of patches array = ${patches.length-1}`);
            let text = patches[0];
            if(revisionNumber === 0) return text;
            for(let n = 1; n < patches.length; n++) {
              //text = JsDiff.applyPatch(text, patches[n]);
              text = dmp.patch_apply(dmp.patch_fromText(patches[n]), text)[0];
              if(text === false) throw new Error("JsDiff says that the patches aren't correct. some sort of corruption or incorrect formatting or mismatch");
              if(n === revisionNumber) return text;
            }
          }
        })();
        </script>


        <script>
          // a temporary hack to make sure search engines see links on generators page:
          if(document.location.pathname === "/generators") {
            var req = new XMLHttpRequest();
            req.overrideMimeType("application/json");
            req.open('GET', "/api/getGeneratorList", true);
            req.onload  = function() {
              var result = window.js0nparse(req.responseText);
              var div = document.createElement('div');
              if(window.canExecuteModernJavascript) {
                div.style.height = "0px";
                div.style.overflow = "hidden";
                div.style.position = "fixed";
              }
              div.innerHTML = "Here are the latest generators: "+result.generators.map(function(g){ return "<a href='/"+g.name+"'>"+g.name+"</a>"; }).join(", ")+".";
              document.body.appendChild(div);
            };
            req.send(null);
          }
        </script>
        
        <script>
          if(!navigator["\u0077\u0065\u0062\u0064\u0072\u0069\u0076\u0065\u0072"]) {
            fetch(`https://perchance.org/api/cv?generatorName=${location.pathname.slice(1)}&isFromEmbed=0&__cacheBust=${Math.random()}`);
            document.addEventListener("visibilitychange", () => {
              if(document.visibilityState === "visible") {
                fetch(`https://perchance.org/api/cv?generatorName=${location.pathname.slice(1)}&isFromEmbed=0&__cacheBust=${Math.random()}`);
              }
            });
          }
        </script>
        
        <script>
          (async function() {
            if(window.location.hash !== "#edit" && window.innerWidth > 1100) {
              while(!document.querySelector("div.menu-item.new")) await new Promise(r => setTimeout(r, 20));
              let btnHtml = document.querySelector("div.menu-item.new").outerHTML;
              btnHtml = btnHtml.replace(/\/minimal#edit/g, "/ai-chat"); // "https://discord.gg/43qAQEVV9a"
              btnHtml = btnHtml.replace(/>new</g, ">ai chat<");
              btnHtml = btnHtml.replace(/menu-item new/g, "menu-item promo");
              btnHtml = btnHtml.replace(/⊕︎/g, "🆕");
              let ctn = document.createElement("div");
              ctn.innerHTML = btnHtml;
              let btn = ctn.firstElementChild;
              let systemIsInDarkMode = !!(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches);
              if(systemIsInDarkMode) {
                btn.style.backgroundColor = "rgb(110 53 11)";
              } else {
                btn.style.backgroundColor = "#ffd4a4";
              }
              document.querySelector("div.menu-item.new").after(btn);
            }
          })();
        </script>

        <script></script>

        <script></script>

        <script>
          (async function() {

            async function sha256Text(text) {
              const msgUint8 = new TextEncoder().encode(text);                          
              const hashBuffer = await crypto.subtle.digest('SHA-256', msgUint8);          
              const hashArray = Array.from(new Uint8Array(hashBuffer));                    
              const hashHex = hashArray.map((b) => b.toString(16).padStart(2, '0')).join('');
              return hashHex;
            }

            async function sendNotification(data) {
              // safety code to prevent duplicate notifications (shouldn't be needed, but just in case):
              let hash = await sha256Text(JSON.stringify(data));
              if(!localStorage.alreadyRecentlySentNotificationHashes) localStorage.alreadyRecentlySentNotificationHashes = "";
              if(localStorage.alreadyRecentlySentNotificationHashes.includes(hash)) return;
              localStorage.alreadyRecentlySentNotificationHashes += ","+hash;
              if(localStorage.alreadyRecentlySentNotificationHashes.length > 2000) localStorage.alreadyRecentlySentNotificationHashes = localStorage.alreadyRecentlySentNotificationHashes.slice(-1000);
              
              let notification;
              if(Notification.permission === "granted") {
                notification = new Notification(data.title, {body:data.body});
              } else if(Notification.permission !== "denied") {
                const permission = await Notification.requestPermission();
                if(permission === "granted") {
                  notification = new Notification(title, options);
                }
              }
              return notification;
            }

            window.addEventListener("message", async function(e) {
              let origin = e.origin || e.originalEvent.origin; // For Chrome, the origin property is in the event.originalEvent object.
              if(origin !== "https://comments-plugin.perchance.org") {
                return;
              }
              if(e.data.type === "ensure-notification-permission") {
                if(Notification.permission !== "granted" && Notification.permission !== "denied") {
                  const permission = await Notification.requestPermission();
                  if(permission === "granted") {
                    console.log("notification permission granted");
                  } else {
                    console.log("notification permission denied");
                  }
                }
              } else if(e.data.type === "notification-request") {
                if(Notification.permission !== "denied") {
                  if(e.data.folderName.split("+")[0] === window.location.pathname.slice(1)) {
                    let notification = await sendNotification(e.data).catch(e => console.error(e));
                    if(notification) notification.onclick = function() { window.focus(); this.close(); };
                  } else {
                    console.log("Pending notification:", e.data.title, e.data.body, e.data.folderName);
                    // we ideally want this notification to be triggered in an already-open tab of the relevant generator (because then the notification.onclick can focus that tab, rather than opening a duplicate of that tab), so we put the notification data in localStorage and wait a few seconds for the relevant tab to take it out, and if not, then we trigger it from this tab, and set onclick to open a new tab
                    if(!localStorage.pendingNotifications) localStorage.pendingNotifications = "[]";
                    let pendingNotifications;
                    try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                    pendingNotifications.push(e.data);
                    localStorage.pendingNotifications = JSON.stringify(pendingNotifications);

                    // try to wake the target tab with a BroadcastChannel message (no idea if this helps, but can't hurt):
                    let broadcastChannel;
                    if(window.BroadcastChannel) {
                      broadcastChannel = new BroadcastChannel("generatorName:"+window.location.pathname.slice(1));
                      broadcastChannel.postMessage({type:"wake-up"});
                    }
                    
                    setTimeout(async function() {
                      if(broadcastChannel) broadcastChannel.close();
                      let pendingNotifications;
                      try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                      let notificationData = pendingNotifications.find(d => d.time === e.data.time && d.folderName === e.data.folderName && d.title === e.data.title && d.body === e.data.body);
                      if(notificationData) {
                        let notification = await sendNotification(notificationData).catch(e => console.error(e));
                        if(notification) notification.onclick = function() { window.open(`/${notificationData.folderName.split("+")[0]}`, "_blank"); this.close(); };
                        pendingNotifications = pendingNotifications.filter(d => d !== notificationData);
                        localStorage.pendingNotifications = JSON.stringify(pendingNotifications);
                      }
                    }, 1000*7); // <-- 'pending notification' timeout length (before we give up and just sent the `Notification` from this tab)
                  }
                }
              }
            });

            (async function() {

              if(window.BroadcastChannel) {
                let channel = new BroadcastChannel("generatorName:"+window.location.pathname.slice(1));
                channel.onmessage = (event) => {
                  if(event.data.type === "wake-up") {
                    console.log("received wake-up message at:", new Date().toString());
                  }
                };
              }

              while(1) {
                let generatorName = window.location.pathname.slice(1);
                try {
                  await new Promise(r => setTimeout(r, 1000*2)); // this wait time must be lower than the 'pending notification' timeout length above
                  // parse localStorage.pendingNotifications and trigger notification if generatorName matches folderName
                  if(!localStorage.pendingNotifications) localStorage.pendingNotifications = "[]";
                  let pendingNotifications;
                  try { pendingNotifications = window.js0nparse(localStorage.pendingNotifications); } catch(e) { console.error("failed to parse pending notifications", e); pendingNotifications = []; }
                  
                  let pendingNotificationsForThisGeneratorName = pendingNotifications.filter(n => n.folderName.split("+")[0] === generatorName);
                  for(let notificationData of pendingNotificationsForThisGeneratorName) {
                    let notification = await sendNotification(notificationData).catch(e => console.error(e));
                    if(notification) notification.onclick = function() { window.focus(); this.close(); };
                    pendingNotifications = pendingNotifications.filter(n => n !== notificationData);
                  }
                  localStorage.pendingNotifications = JSON.stringify(pendingNotifications);
                } catch(e) { console.error(e) }
              }
            })();

          })();
        </script>
        
        <script>
          (function() {

            function chec3kRes1Load(url, type) {
              return new Promise(resolve => {
                let el = document.createElement(type);
                el.src = url;
                el.onload = function() { resolve(true); };
                el.onerror = function() { resolve(false); };
                document['head'].appendChild(el);
              });
            }

            async function has7Variab4les() {
              return true; //window.freestar?.analytics?.track?.toString().includes("track(") && window.quantserve && window.quantserve.toString().includes("events") && window.google_image_requests && !("instanceof Image").endsWith("Object") && (window.google_image_requests[0] instanceof Image) && !window.gaData.toString().includes(":1711068134989}") && window.gaData && JSON.stringify(window.gaData).toString().includes("hitcount") && !JSON.stringify(window.gaData).toString().includes("1709839111827") && window.__tcfapi && (window.Criteo?.PubTag || window.__halo_loaded__) && (await chec3kRes1Load("https://static.criteo.net/images/pixel.gif?ch=1", "img"));
            }

            window.ad1sAreShowing = async () =>  {   
              let adEl = document.querySelector(".ad-providers-ctn-el");
              if(!adEl) return false;
              let hasI3fr9ame = adEl.querySelector("iframe");
              let has3Analy0tics = await has7Variab4les() && (await chec3kRes1Load(`https://secure.qua${""}ntserve.com/qu${""}ant.js`, `script`));
              if(adEl && adEl.innerHTML.length > 5 && adEl.offsetParent !== null && adEl.offsetHeight > 20 && (hasI3fr9ame || has3Analy0tics)) return true;
              // if(adEl && adEl.innerHTML.length > 5 && adEl.offsetParent !== null && adEl.offsetHeight > 20 && adEl.querySelector("iframe")) return true;
              return false;
            };

            let already1AddedAd3vertIfNeeded = false;
            window.addEventListener("message", function(e) {
              let origin = e.origin || e.originalEvent.origin; // For Chrome, the origin property is in the event.originalEvent object.
              if(origin !== "https://null.perchance.org" && origin !== `https://${window.generatorPublicId}.perchance.org`) {
                return;
              }
              
              if(e.data.type ==(`usingAdPowere${window.empty883974329}dPlugin`) && window.location.pathname !== '/text-to-image-plugin' && window.location.pathname !== '/ai-text-plugin') {
                ad2dAdvert();
              }
            });

            setTimeout(() => {
              if(window.generatorData.imports.includes("ai-text-to-image-plugin") || window.generatorData.imports.includes("ai-text-plugin")) {
                ad2dAdvert();
              }
            }, 10);

            let ad2dAdvert = async function() {
              if(already1AddedAd3vertIfNeeded) return;
              already1AddedAd3vertIfNeeded = true;

              if(window.location.hash !== "#edit") window[window.ftcFn1Name]("/api/count?key=uaine");

              if((window[`local${window.empty883974329}Storage`]["app-storage"] && window[`local${window.empty883974329}Storage`]["app-storage"].includes("sessionToken")) || navigator.webdriver) {
                return; // not for logged-in users and screenshot bot
              }

              if(window.location.hash !== "#edit") window[window.ftcFn1Name]("/api/count?key=uaineala");

              let adCtn = createAdCtn();
              
              while(!document['querySelector']("#main")) await new Promise(r => setTimeout(r, 200));

              let rObs = new ResizeObserver(function() {
                document['querySelector']("#main").style.bottom = (adCtn.offsetHeight + 8*2)+"px";
              }).observe(adCtn);
              
              let ad1Provider6Name = "freestar";
              if(window.location.hash.startsWith("#adProvid"+"erName=")) ad1Provider6Name = window.location.hash.slice("#adProvi"+"derName=".length);
              if(ad1Provider6Name !== `sni${window.empty883974329}gel` && ad1Provider6Name !== "freestar" && ad1Provider6Name !== "sovrn") ad1Provider6Name = "freestar";
              console.log("ad:", ad1Provider6Name);
              // let ad1Provider6Name = `sni${window.empty883974329}gel`;
              // if(window.location.pathname === "/fqruxwnngk") ad1Provider6Name = "freestar";

              if(!window.___alreadyInitializedAdRefreshFocusBugStuff) {
                window.___alreadyInitializedAdRefreshFocusBugStuff = true;
                let lastUserCausedFocusActionTime = 0;
                window.addEventListener("pointerdown", function() {
                  lastUserCausedFocusActionTime = Date.now();
                });
                document.addEventListener("visibilitychange", () => {
                  if(document.visibilityState === "visible") {
                    lastUserCausedFocusActionTime = Date.now();
                  }
                });
                window.addEventListener("focus", async function() {
                  await new Promise(r => setTimeout(r, 1));
                  if(Date.now()-lastUserCausedFocusActionTime > 1000) {
                    console.warn("top-level frame got focus, but there was no pointerdown/pageshow event to have caused it, so returning focus to iframe. (possibly caused by ad refresh thing)");
                    const iframe = document.querySelector("#output iframe");
                    iframe.focus();
                    iframe.contentWindow.focus();
                  }
                });

                if(window.location.href.includes("ad-focus-bug-test")) {
                  setInterval(async () => {
                    window.focus();  
                    console.log("top hasFocus1", document.hasFocus(), document.activeElement);
                    await new Promise(r => setTimeout(r, 100));
                    console.log("top hasFocus2", document.hasFocus(), document.activeElement);
                  }, 7000);
                }
              }

              
              if(ad1Provider6Name === "freestar") {

                function checkConsent() {
                  __tcfapi("getTCData", 2, (tcData, success) => {
                    if(success) {
                      if(tcData.gdprApplies === false) {
                        window.gdprDoesNotApply = true;
                      } else {
                        let a = tcData.purpose.consents[1];
                        let b = tcData.purpose.consents[10];
                        let c = tcData.purpose.legitimateInterests[10];
                        let d = tcData.eventStatus

                        if((!a || !b || !c) & d !== "cmpuishown") {
                          window.__tcfapi("displayConsentUi", 2, function () {});
                        } else {
                          window.userGaveAdConsent = true;
                        }
                      }
                    }
                  });
                }
                (async function che1ckTCF() {
                  await new Promise(r => setTimeout(r, 100));
                  if(window.__tcfapi == undefined) setTimeout(che1ckTCF, 1000);
                  else checkConsent();
                })();

                adCtn.innerHTML = `<div class="ad-providers-ctn-el" align="center" data-freestar-ad="__320x100 __970x90" id="perchanceorg_footer"></div>`;
                
                window.freestar = window.freestar || {};
                window.freestar.queue = window.freestar.queue || [];
                window.freestar['config'] = window.freestar.config || {};
                window.freestar.config.enabled_slots = [];
                window.freestar.initCallback = function () { (window.freestar.config.enabled_slots.length === 0) ? window.freestar.initCallbackCalled = false : window.freestar[`newA${window.empty883974329}dSlots`](window.freestar.config.enabled_slots) }

                // CMP (inmobi choice):
                let script = document.createElement("script");
                script.src = `https://user-uploa${window.empty883974329}ds.perchance.org/file/63c85ff7ce3ecc0323e0bbd555078fad.js`;
                document.head[window.ap1pend1ChildFn2Name](script);
                while(!window.cmpScriptHasExecuted) await new Promise(r => setTimeout(r, 50));

                {
                  let script = document.createElement("script");
                  script.dataset.cfasync = "false";
                  script.async = true;
                  script.src = "https://a.pub.network/perchance-org/pubfig.min.js";
                  document.head[window.ap1pend1ChildFn2Name](script);
                }
                
                if(window.location.hash.includes("testAntiAdBlock")) {
                  // anti -ad block:
                  let script = document.createElement("script");
                  script.async = true;
                  script.src = `https://user-uploa${window.empty883974329}ds.perchance.org/file/01cea1291c0dbb7b775dc89a385d1d4a.js`;
                  document.head[window.ap1pend1ChildFn2Name](script);
                }
                
                window.freestar.config.enabled_slots.push({ placementName: "perchanceorg_footer", slotId: "perchanceorg_footer" });
                
              } else if(ad1Provider6Name == `sni${window.empty883974329}gel`) {
                // this code is needed to ensure that ad load immediately after accepting cmp 'reconsider'
                window.addEventListener('adnginLoaderReady', function() {
                  // __tcfapi('addEventListener', 2, function(tcData, success) {
                  //   if(success && (tcData.eventStatus === 'tcloaded' || tcData.eventStatus === 'useractioncomplete')) {
                  //     if(tcData.gdprApplies) {
                  //       __tcfapi('getVendorList', 2, function(gvl, success) {
                  //         if(success && tcData.eventStatus === 'useractioncomplete') {
                  // 1;adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
                  //         } else if(success && tcData.eventStatus === 'tcloaded') {
                  //           if(Object.keys(tcData.vendor.consents).length == Object.keys(gvl.vendors).length && Object.keys(tcData.purpose.consents).length == Object.keys(gvl.purposes).length) {
                  // 1;adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
                  //           }
                  //         }
                  //       });
                  //     } else {
                  // 1;adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
                  //     }
                  //   }
                  // });
                  
                  /**/adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
                });
                adCtn.innerHTML = `<div class="ad-providers-ctn-el" id="adngin-responsive_banner-0"></div>`;
                let script = document.createElement("script");
                script.dataset.cfasync = "false";
                script.async = true;
                script.src = `https://cdn.snig${""}elweb.com/adengine/perchance.org/loader.js`;
                document.head[window.ap1pend1ChildFn2Name](script);

                setTimeout(async () => {
                  if(await window.ad1sAreShowing()) return;

                  let script = document.createElement("script");
                  script.dataset.cfasync = "false";
                  script.async = true;
                  script.nonce = "SEahoBjLmnC565bNlPFeWA";
                  script.src = "https://fundingchoicesmessages.google.com/i/pub-9885689965057708?ers=1";
                  document.head[window.ap1pend1ChildFn2Name](script);

                  (function() {function signalGooglefcPresent() {if (!window.frames['googlefcPresent']) {if (document.body) {const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body [window.ap1pend1ChildFn2Name](iframe);} else {setTimeout(signalGooglefcPresent, 0);}}}signalGooglefcPresent();})();
                }, 30000);
              }

              setTimeout(() => {
                window.b8473892 = true;

                setTimeout(async () => {
                  if(window[`local${window.empty883974329}Storage`]["app-storage"] && window.js0nparse(window[`local${window.empty883974329}Storage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return; // not for logged-in users (already done above - just to defend against future edit mistakes)
                  window[window.ftcFn1Name]( "/api/count?key=abt");
                  let aidjr3 = await window.ad1sAreShowing();
                  if(!aidjr3) {
                    window[window.ftcFn1Name](`/api/count?key=${""}abpr` + "");
                    if(window[`local${window.empty883974329}Storage`].abpr === "1") {
                      window[window.ftcFn1Name](`/api/count?key=abpr2`);
                    }
                    window[`local${window.empty883974329}Storage`].abpr = ("1");

                    let scri12pts = false;
                    let ifra2mes = false;
                    let coo1kies = false;

                    let clasi = false;
                    try {
                      if(await window[window.ftcFn1Name](`https://cdn.snige${""}lweb.com/adengine/perchance.org/loader.js`).then(r => r.text()).then(t => t.includes(`dou${window.empty883974329}bleclick`) || t.includes("adengine") || t.includes("adconsent") || t.includes("GDPR")).catch(e => false) && await has7Variab4les() && await chec3kRes1Load(`https://secure.qua${""}ntserve.com/qu${""}ant.js`, "script")) {
                        window[window.ftcFn1Name]("/api/count?key=abprbclas");
                        scri12pts  = true;
                      }
                      if([...document.querySelectorAll("iframe")].filter(el => el.src).map(el => new URL(el.src).hostname).find(n => n[`ends${window.empty883974329}With`](`dou${window.empty883974329}bleclick.net`) || n[`ends${window.empty883974329}With`]("onetag-sys.com") || n[`ends${window.empty883974329}With`]("openx.net") || n[`ends${window.empty883974329}With`](".google.com") || n[`ends${window.empty883974329}With`](`amazon-a${window.empty883974329}dsystem.com`) || n[`ends${window.empty883974329}With`]("rubiconproject.com") || n[`ends${window.empty883974329}With`]("criteo.com") || n[`ends${window.empty883974329}With`]("3lift.com") || n[`ends${window.empty883974329}With`]("googlesyndication.com") || n[`ends${window.empty883974329}With`]("connectad.io"))) {
                        window[window.ftcFn1Name]("/api/count?key=abprbclasi");
                        clasi = true;
                        ifra2mes  = true;
                      }
                    } catch(e) {
                      console.error(e);
                    }

                    if(window.userGaveAdConsent || window.gdprDoesNotApply) {
                      coo1kies  = true;
                    }

                    try {
                      if(window.js0nparse(window[`local${window.empty883974329}Storage`].id5id_privacy || "{}").id5_consent === true) {
                        coo1kies  = true;
                      }
                    } catch(e) {
                      console.error(e);
                    }

                    if(clasi && coo1kies) {
                      window[window.ftcFn1Name]("/api/count?key=abprbclasiadgc");
                    }

                    if(scri12pts && ifra2mes && coo1kies) {
                      return; // maybe auction failed or whatever
                    }

                    try {
                      if(scri12pts && ifra2mes && !coo1kies) {
                        window[window.modalFn1Name](`Your browser seems to be blocking cookies, which is preventing a${window.empty883974329}ds from being shown. You may need to add an exception for 'perchance.org' to your cookie blocker or 'incognito browsing' feature. Sometimes VPN and antivirus software has cookie blocking as a bonus feature.\n\nWhy are a${window.empty883974329}ds necessary? Well, Perchance is free and doesn't have a${window.empty883974329}ds by default, but the creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources can only exist thanks to a${window.empty883974329}ds. This page will auto-refresh in 60 seconds (apologies).`);
                      } else {
                        window[window.modalFn1Name](`Your browser seems to be blocking a${window.empty883974329}ds. Perchance is free and generally doesn't have a${window.empty883974329}ds, but the creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources can only exist thanks to a${window.empty883974329}ds.\n\nPlease help keep it free by turning off your ad blocker. This page will auto-refresh in 60 seconds (apologies).\n\n(NOTE: If a${window.empty883974329}ds still aren't loading for you even after turning off your ad blocker, then you may also need to turn off your 'cookie' blocker, and maybe add an exception for perchance.org on the built-in cookie-blocking of your antivirus/incognito/VPN/etc if it has that feature).`);
                      }
                    } catch(e) {

                    } 

                    start1WarnProcess();
                  } else {
                    if(window[`local${window.empty883974329}Storage`].abpr === "1") {
                      window[window.ftcFn1Name]("/api/count?key=utoab");
                    }
                  }
                }, 60001);
              }, 50);

              // setTimeout(async () => {
              //   if(!(await window.ad1sAreShowing())) {
              //     if(ad1Provider6Name == `sni${window.empty883974329}gel`) adngin.queue.push(function() { adngin.cmd.startAuction(["responsive_banner"]); });
              //   }
              // }, 30000);
              
              // adCtn.innerHTML = `<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtgAAABaAQMAAAC4+rO8AAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAANQTFRFXrP/I7IslgAAAB9JREFUeJztwYEAAAAAw6D5U1/gCFUBAAAAAAAAAHwDIFgAAVR0zeEAAAAASUVORK5CYII="/>`;
              
              if(window.innerWidth > 1400) {
                setTimeout(() => {
                  let div = document.createElement("div");
                  div.style.cssText = `position: absolute; right: 0; top: 0; font-family: sans-serif; background: #dedede; padding: 0.2rem 0.25rem; border-radius: 3px; cursor: pointer; color: #676767;`;
                  div.onclick = function() { window[window.modalFn1Name]('The creator of this generator has imported an ad-powered plugin (e.g. the text-to-image plugin). Plugins that use expensive server resources are funded via advertisements.'); };
                  div.id = `whyA${window.empty883974329}dsButton1El`;
                  div.innerHTML = `why a${window.empty883974329}ds?`;
                  adCtn[window.ap1pend1ChildFn2Name](div);
                }, 2000);
              }

              document.body [window.ap1pend1ChildFn2Name](adCtn);
              window.adCtn = adCtn;
            }

          })();

          (async function() { 
            while(true) {
              try {
                let i = 0;
                while(true) {
                  await new Promise(r => setTimeout(r, 10000));
                  let deps = window.generatorDependenciesData.map(d => d.name);
                  if((window.adCtn && !getCElement(window.adCtn).src?.includes?.("perchance.org")) || window.js0nparse(window.localStorage["app-storage"] || "{}")?.user?.[`sess${``}ionToken`] || window.sdfh929if738ths) {
                    // 1;adngin.cmd.startAuction(["responsive_banner"]);
                    fetch("/api/count?key=abpsgp").catch(console.error);
                    break;
                  }
                  i++;
                  if(i > 10) {
                    break;
                  }
                }
              } catch(e) {
                console.error(e);
              }
              await new Promise(r => setTimeout(r, 20*60*1000));
            }
          })();

          setTimeout(() => {
            `abp|cookie|browser|async|ads|alert|a${window.empty883974329}ds`;
            window.e7827462 = true;
          }, 100);
        </script>
        <script>
          function createAdCtn() {
            let adCtn = window[doc34828272947].createElement("div");
            // let maxHeight = window.innerWidth < 600 ? 50 : 90;
            let maxHeight;
            let minHeight;
            if(window.innerWidth > 700) { // desktop
              minHeight = 90;
              maxHeight = 90;
            } else { // mobile
              maxHeight = 100;
              minHeight = 50;
            }
            adCtn.style.cssText = `position:var(--does-not1-exist-98437593, fixed); bottom:8px; right:8px; left:8px; min-height:${minHeight}px; height:${maxHeight}px; overflow:hidden; text-align:center; display:flex; align-items:center; justify-content:center;`;
            return adCtn;
          }

          globalThis.hu_8urej4 = true;
          function start1WarnProcess() {
            let warnEl = window[doc34828272947].createElement("div");
            let helperNotice = "";
            if(window.innerWidth > 800) helperNotice = `<div><a href="https://user-uploa${window.empty883974329}ds.perchance.org/file/06b63cbc807acaf79bc25f114bb0dda1.webp" target="_blank">click here</a> if it's still not working or if you don't understand</div>`;
            warnEl.innerHTML += `<div style="max-width:700px; margin:0 auto;"><span style="font-weight:bold; color:#f60000;">the author of this generator has imported an ad-powered plugin. pls turn off your ad/cookie blocker to keep this free. this page will auto-refresh in 60 seconds 😳</span> ${helperNotice || "try Chrome or Firefox if it's not working."}</div>`;
            if(!window.adCtn) {
              window.adCtn = createAdCtn();
              window[doc34828272947].body [window.ap1pend1ChildFn2Name](window.adCtn);
            } else {
              window.adCtn.innerHTML = "";
            }
            window.adCtn[window.ap1pend1ChildFn2Name](warnEl);
            if(window[doc34828272947].querySelector(`#whyA${window.empty883974329}dsButton1El`)) {
              window[doc34828272947].querySelector(`#whyA${window.empty883974329}dsButton1El`).style.display = "none";
            }

            setTimeout(async () => {
              warnEl.remove();
              let aidjr3 = await window.ad1sAreShowing();
              if(!aidjr3 || !window.e7827462 || !window.b8473892) {
                window[`onbefor${window.empty883974329}eunload`] = undefined;
                if(window.userGaveAdConsent === false && window.gdprDoesNotApply === false) {
                  localStorage.clear();
                }
                window[`loca${window.empty883974329}tion`][rlFn1Name]();
              }
            }, 60001);
          }
        </script>
        <script>
          {
            async function handler() {
              window.u8398201 = true;
              if(!window.e7827462 || !window.b8473892) {
                let deps = window.generatorDependenciesData.map(d => d.name);
                if(!deps.includes("ai-text-to-image-plugin") && !deps.includes("ai-text-plugin")) return;
                if(window[`local${window.empty883974329}Storage`]["app-storage"] && window[`local${window.empty883974329}Storage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`local${window.empty883974329}Storage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return;

                start1WarnProcess();

                await new Promise(r => setTimeout(r, 1000*40));
                if(!window.adCtn || getCElement(window.adCtn).src?.includes?.("perchance.org")) {
                  let ms1g = "AI-powered generators on Perchance are entirely funded by ads. Please disable your ad blocker and reload the page. This page will auto-reload in 60 seconds." .replace(/_/g, "");
                  try { alert(ms1g); } catch(e) { window[doc34828272947].body.innerHTML = ms1g; };
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     window    [false ? '' : `z${window.empty883974329}8${window.empty883974329}4${window.empty883974329}7${window.empty883974329}3${window.empty883974329}9${window.empty883974329}2${window.empty883974329}7`] = true;
                  setTimeout(() => {
                    window[`onbefor${window.empty883974329}eunload`] = undefined;
                    window[`loca${window.empty883974329}tion`][rlFn1Name]();
                  }, 60001);
                }
              }
            }
            setTimeout(handler, 30001);
          }
          function getCElement(el) {
            const rect = el.getBoundingClientRect();
            return document.elementFromPoint(rect.left + rect.width / 2, rect.top + rect.height / 2);
          }
        </script>
        <script>
          let cachedAccessCodeForAdPoweredStuff = null;
          setInterval(() => {
            cachedAccessCodeForAdPoweredStuff = null;
          }, 10*60*1000);

          window.addEventListener("message", async function(e) {
            let origin = e.origin || e.originalEvent.origin
            if(origin !== "https://text-generation.perchance.org" && origin !== `https://image-generation.perchance.org`) {
              return;
            }
            
            if(e.data.type == `plsGibAccessCodeForAdPoweredStuff`) {
              let code;
              if(cachedAccessCodeForAdPoweredStuff) {
                code = cachedAccessCodeForAdPoweredStuff;
              } else {
                code = await fetch(`/api/getAccessCodeForAdPoweredStuff?__cacheBust=${Math.round(Date.now()/(1000*60*10))}`).then(r => r.text());
                cachedAccessCodeForAdPoweredStuff = code;
              }

              let deps = window.generatorDependenciesData.map(d => d.name);
              if(!deps.includes("ai-text-to-image-plugin") && !deps.includes("ai-text-plugin")) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
              if(window.adCtn && await window.ad1sAreShowing() && window.adCtn && !getCElement(window.adCtn).src?.includes?.("perchance.org")) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
              if(window[`local${window.empty883974329}Storage`]["app-storage"] && window[`local${window.empty883974329}Storage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`local${window.empty883974329}Storage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) {
                e.source.postMessage({type:"okayYouMayHaveCodeForAdPoweredStuff♡", code}, origin); 
                return;
              }
            }
          });
        </script>

        <style>
          /* .ad-providers-ctn-el .__fs-ancillary {
            display: none !important;
          } */
        </style>

        <script>
          (async function() {
            if(window[`local${window.empty883974329}Storage`]["app-storage"] && window[`local${window.empty883974329}Storage`]["app-storage"].includes("sessionToken") && window.js0nparse(window[`local${window.empty883974329}Storage`]["app-storage"]).user[`sess${``}ionToken`] || window.sdfh929if738ths) return; // not for logged-in users

            window.userGaveAdConsent = null;
            window.gdprDoesNotApply = null;
            let i = 0;
            while(!window.__tcfapi) {
              await new Promise(r => setTimeout(r, 1000));
              i++;
              if(i > 20) return;
            }
            window.__tcfapi('addEventListener', 2, function(tcData, success) {
              if(success && (tcData.eventStatus === 'tcloaded' || tcData.eventStatus === 'useractioncomplete')) {
                if(tcData.gdprApplies) {
                  __tcfapi('getVendorList', 2, function(gvl, success) {
                    if(success) {
                      if(Object.values(tcData.vendor.consents).filter(v => v).length > Object.keys(gvl.vendors).length/2 && Object.values(tcData.purpose.consents).filter(v => v).length === Object.keys(gvl.purposes).length) {
                        window.userGaveAdConsent = true;
                      } else if(Object.values(tcData.vendor.consents).filter(v => v).length == 0 && Object.values(tcData.purpose.consents).filter(v => v).length === 0) {
                        window.userGaveAdConsent = false; // reject
                      } else {
                        window.userGaveAdConsent = false; // partial
                      }
                    }
                  });
                } else {
                  window.gdprDoesNotApply = true;
                }
              } else {
                console.log("User consent not available yet", tcData);
                if(tcData.gdprApplies === true) {
                  window.gdprDoesNotApply = false;
                }
                if(tcData.eventStatus === 'cmpuishown') {
                  window.gdprDoesNotApply = false;
                }
              }
            });
          })();
        </script>

        <style>
          @media (prefers-color-scheme: dark) {
            #whyAdsButton1El {
              background-color: #333537 !important;
              color: #a79f94 !important;
            }
          }
        </style>

        <script>
          setTimeout(function() {
            // Make the screen "cleaner" for the screenshot bot:
            if(navigator.webdriver) {
              document.querySelectorAll("menu-bar .menu-item").forEach(el => el.style.opacity=0);
              document.querySelector("editor #main").style.top = "8px";
            }
          }, 100);
        </script>
        
        <script>
          window.addEventListener('pageshow', (event) => {
            if (event.persisted) {
              // bfcache doesn't persist edits in the text editor for some reason (doesn't store JS state?), so we need to reload:
              // window.location.reload(); // edit: for some reason this doesn't seem to be needed anymore - seems to be persisting properly? Maybe due to adding this event handler???
              // console.log('@@@ This page was restored from the bfcache.');
            } else {
              // console.log('@@@ This page was loaded normally.');
            }
          });
        </script>

        <script>
          (async function() {
            let checkCount = 0;
            let interval;
            interval = setInterval(() => {
              let a = `s(uc)[],ce,s[s,f(u,lP,a,g,e],Lo),[ad`.replace(/[ ,\]()\[]/g, "");
              let plsp = `in i(ti al,Pa[g eLo adSpi n)ne, r`.replace(/[ ,\]()\[]/g, "");
              if(window.remoteResourcesLoaded && !window[a]) {
                let div = document.createElement("div");
                let isAdPoweredPage = false;
                div.innerHTML = `<p>TL;DR: <b>Try turning off your ad blocker</b>.</p>

                <p>If you see this message, this page failed to load properly. One potential cause is that (as of writing) some ad blockers break <a href="https://github.com/uBlockOrigin/uAssets/blob/9effb98d0ab3be8bc320909144758a326e575ad8/filters/quick-fixes.txt#L160" target="_blank" ref="nofollow">basic</a><sup>1</sup> functionality of Perchance pages. This <b>includes pages that don't have any ads</b> - i.e. even "normal" (non-AI-powered) generators.</p>

                <p>Try turning off your browser's ad blocker for this page, and if that doesn't work then please report this problem at <a href="https://lemmy.world/c/perchance" target="_blank">lemmy.world/c/perchance</a>, since there may be some other cause.</p>

                <p style="opacity:0.55;">Note: Perchance only has ads on generators which require GPU resources - a tiny fraction of all pages on Perchance. Perchance has always been <u>completely</u> free, and I've been paying for server resources out of my own pocket since I built Perchance in 2017, but I can't do that for the newly-added AI plugins because they require many GPU servers and they're way too expensive. As of writing (Jan 20th 2023) ads still aren't enough to cover the GPU costs, but they help a lot.</p>

                <p style="opacity:0.55;"><sup>1 </sup><span style="font-size:85%;">The linked code makes your ad blocker extension override some code on this page such that when I (or Perchance generator authors) want to check if some text contains a word (a very basic/common programming operation), it'll always say that the text <i>does</i> contain the word, even when it doesn't. That makes it hard to write code that works correctly, and to make changes to existing code without breaking things.</span></p>`;
                div.style.cssText = "padding:1rem; font-size:120%; z-index:100000000;";
                try { document.querySelector("#" + plsp).remove(); } catch(e) {}
                document.body.appendChild(div);

                clearInterval(interval);
              }
              checkCount++;
              if(checkCount > 20) clearInterval(interval);
            }, 1000*2);
          })();
        </script>
        
        
        <!-- use invisible `touch-action:none` divs to prevent accidental "drag down to refresh" behavior when scrolling up iframe (dragging finger down) but finger lands on the edge (outside frame) -->
        <div style="width: 19px;height: 100%;position: fixed;right: -10px;top: 35px;bottom: 0px;/* background: blue; */touch-action: none; z-index:9999999;"></div>
        <div style="width: 19px;height: 100%;position: fixed;left: -10px;top: 35px;bottom: 0px;/* background: blue; */touch-action: none; z-index:9999999;"></div>

        <a href="/cursed-ai" target="_blank" style="position:absolute;top:-200px;">Cursed AI Image Generator</a>

    

</body></html>